<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="xinyu, xinnyu" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="成就感和尊严使你快乐">
<meta property="og:type" content="website">
<meta property="og:title" content="XINNYU">
<meta property="og:url" content="https://xinnyu.github.io/index.html">
<meta property="og:site_name" content="XINNYU">
<meta property="og:description" content="成就感和尊严使你快乐">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="XINNYU">
<meta name="twitter:description" content="成就感和尊严使你快乐">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://xinnyu.github.io/"/>





  <title> XINNYU </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">XINNYU</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2017/04/27/iOS小Tips/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/27/iOS小Tips/" itemprop="url">
                  iOS小Tips
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-27T18:27:56+08:00">
                2017-04-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/04/27/iOS小Tips/" class="leancloud_visitors" data-flag-title="iOS小Tips">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="1，打印View所有子视图"><a href="#1，打印View所有子视图" class="headerlink" title="1，打印View所有子视图"></a>1，打印View所有子视图</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">po [[<span class="keyword">self</span> view]recursiveDescription]</div></pre></td></tr></table></figure>
<h4 id="2，layoutSubviews调用的调用时机"><a href="#2，layoutSubviews调用的调用时机" class="headerlink" title="2，layoutSubviews调用的调用时机"></a>2，layoutSubviews调用的调用时机</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line">* 当视图第一次显示的时候会被调用。</div><div class="line">* 添加子视图也会调用这个方法。</div><div class="line">* 当本视图的大小发生改变的时候是会调用的。</div><div class="line">* 当子视图的frame发生改变的时候是会调用的。</div><div class="line">* 当删除子视图的时候是会调用的.</div></pre></td></tr></table></figure>
<h4 id="3，NSString过滤特殊字符"><a href="#3，NSString过滤特殊字符" class="headerlink" title="3，NSString过滤特殊字符"></a>3，NSString过滤特殊字符</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">// 定义一个特殊字符的集合</span></div><div class="line"><span class="built_in">NSCharacterSet</span> *set = [<span class="built_in">NSCharacterSet</span> characterSetWithCharactersInString:</div><div class="line"><span class="string">@"@／：；（）¥「」＂、[]&#123;&#125;#%-*+=_\\|~＜＞$€^•'@#$%^&amp;*()_+'\""</span>];</div><div class="line"><span class="comment">// 过滤字符串的特殊字符</span></div><div class="line"><span class="built_in">NSString</span> *newString = [trimString stringByTrimmingCharactersInSet:set];</div></pre></td></tr></table></figure>
<h4 id="4，TransForm属性"><a href="#4，TransForm属性" class="headerlink" title="4，TransForm属性"></a>4，TransForm属性</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">//平移按钮</span></div><div class="line"><span class="built_in">CGAffineTransform</span> transForm = <span class="keyword">self</span>.buttonView.transform;</div><div class="line"><span class="keyword">self</span>.buttonView.transform = <span class="built_in">CGAffineTransformTranslate</span>(transForm, <span class="number">10</span>, <span class="number">0</span>);</div><div class="line"></div><div class="line"><span class="comment">//旋转按钮</span></div><div class="line"><span class="built_in">CGAffineTransform</span> transForm = <span class="keyword">self</span>.buttonView.transform;</div><div class="line"><span class="keyword">self</span>.buttonView.transform = <span class="built_in">CGAffineTransformRotate</span>(transForm, M_PI_4);</div><div class="line"></div><div class="line"><span class="comment">//缩放按钮</span></div><div class="line"><span class="keyword">self</span>.buttonView.transform = <span class="built_in">CGAffineTransformScale</span>(transForm, <span class="number">1.2</span>, <span class="number">1.2</span>);</div><div class="line"></div><div class="line"><span class="comment">//初始化复位</span></div><div class="line"><span class="keyword">self</span>.buttonView.transform = <span class="built_in">CGAffineTransformIdentity</span>;</div></pre></td></tr></table></figure>
<h4 id="5，去掉分割线多余15像素"><a href="#5，去掉分割线多余15像素" class="headerlink" title="5，去掉分割线多余15像素"></a>5，去掉分割线多余15像素</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">//首先在viewDidLoad方法加入以下代码：</span></div><div class="line"><span class="keyword">if</span> ([<span class="keyword">self</span>.tableView respondsToSelector:<span class="keyword">@selector</span>(setSeparatorInset:)]) &#123;</div><div class="line">        [<span class="keyword">self</span>.tableView setSeparatorInset:<span class="built_in">UIEdgeInsetsZero</span>];    </div><div class="line">&#125;   </div><div class="line"><span class="keyword">if</span> ([<span class="keyword">self</span>.tableView respondsToSelector:<span class="keyword">@selector</span>(setLayoutMargins:)]) &#123;        </div><div class="line">[<span class="keyword">self</span>.tableView setLayoutMargins:<span class="built_in">UIEdgeInsetsZero</span>];</div><div class="line">&#125;</div><div class="line"><span class="comment">//然后在重写willDisplayCell方法</span></div><div class="line">- (<span class="keyword">void</span>)tableView:(<span class="built_in">UITableView</span> *)tableView willDisplayCell:(<span class="built_in">UITableViewCell</span> *)cell </div><div class="line">forRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath&#123;   </div><div class="line"><span class="keyword">if</span> ([cell respondsToSelector:<span class="keyword">@selector</span>(setSeparatorInset:)]) &#123;       </div><div class="line">[cell setSeparatorInset:<span class="built_in">UIEdgeInsetsZero</span>];    </div><div class="line">&#125;    </div><div class="line"><span class="keyword">if</span> ([cell respondsToSelector:<span class="keyword">@selector</span>(setLayoutMargins:)]) &#123;        </div><div class="line">[cell setLayoutMargins:<span class="built_in">UIEdgeInsetsZero</span>];    </div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="6，计算方法耗时时间间隔"><a href="#6，计算方法耗时时间间隔" class="headerlink" title="6，计算方法耗时时间间隔"></a>6，计算方法耗时时间间隔</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">// 获取时间间隔</span></div><div class="line"><span class="meta">#define TICK   CFAbsoluteTime start = CFAbsoluteTimeGetCurrent();</span></div><div class="line"><span class="meta">#define TOCK   NSLog(@<span class="meta-string">"Time: %f"</span>, CFAbsoluteTimeGetCurrent() - start)</span></div></pre></td></tr></table></figure>
<h4 id="7，Color颜色宏定义"><a href="#7，Color颜色宏定义" class="headerlink" title="7，Color颜色宏定义"></a>7，Color颜色宏定义</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">// 随机颜色</span></div><div class="line"><span class="meta">#define RANDOM_COLOR [UIColor colorWithRed:arc4random_uniform(256) / 255.0 green:arc4random_uniform(256) / 255.0 blue:arc4random_uniform(256) / 255.0 alpha:1]</span></div><div class="line"><span class="comment">// 颜色(RGB)</span></div><div class="line"><span class="meta">#define RGBCOLOR(r, g, b) [UIColor colorWithRed:(r)/255.0f green:(g)/255.0f blue:(b)/255.0f alpha:1]</span></div><div class="line"><span class="comment">// 利用这种方法设置颜色和透明值，可不影响子视图背景色</span></div><div class="line"><span class="meta">#define RGBACOLOR(r, g, b, a) [UIColor colorWithRed:(r)/255.0f green:(g)/255.0f blue:(b)/255.0f alpha:(a)]</span></div></pre></td></tr></table></figure>
<h4 id="8，让-iOS-应用直接退出"><a href="#8，让-iOS-应用直接退出" class="headerlink" title="8，让 iOS 应用直接退出"></a>8，让 iOS 应用直接退出</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)exitApplication &#123;</div><div class="line">    AppDelegate *app = [<span class="built_in">UIApplication</span> sharedApplication].delegate;</div><div class="line">    <span class="built_in">UIWindow</span> *window = app.window;</div><div class="line"></div><div class="line">    [<span class="built_in">UIView</span> animateWithDuration:<span class="number">1.0</span>f animations:^&#123;</div><div class="line">        window.alpha = <span class="number">0</span>;</div><div class="line">    &#125; completion:^(<span class="built_in">BOOL</span> finished) &#123;</div><div class="line">        exit(<span class="number">0</span>);</div><div class="line">    &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="9，修改Label中不同文字颜色"><a href="#9，修改Label中不同文字颜色" class="headerlink" title="9，修改Label中不同文字颜色"></a>9，修改Label中不同文字颜色</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)touchesEnded:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches withEvent:(<span class="built_in">UIEvent</span> *)event</div><div class="line">&#123;</div><div class="line">    [<span class="keyword">self</span> editStringColor:<span class="keyword">self</span>.label.text editStr:<span class="string">@"好"</span> color:[<span class="built_in">UIColor</span> blueColor]];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)editStringColor:(<span class="built_in">NSString</span> *)string editStr:(<span class="built_in">NSString</span> *)editStr color:(<span class="built_in">UIColor</span> *)color &#123;</div><div class="line">    <span class="comment">// string为整体字符串, editStr为需要修改的字符串</span></div><div class="line">    <span class="built_in">NSRange</span> range = [string rangeOfString:editStr];</div><div class="line"></div><div class="line">    <span class="built_in">NSMutableAttributedString</span> *attribute = [[<span class="built_in">NSMutableAttributedString</span> alloc] initWithString:string];</div><div class="line"></div><div class="line">    <span class="comment">// 设置属性修改字体颜色UIColor与大小UIFont</span></div><div class="line">    [attribute addAttributes:@&#123;<span class="built_in">NSForegroundColorAttributeName</span>:color&#125; range:range];</div><div class="line"></div><div class="line">    <span class="keyword">self</span>.label.attributedText = attribute;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="10，播放声音"><a href="#10，播放声音" class="headerlink" title="10，播放声音"></a>10，播放声音</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="meta">#import<span class="meta-string">&lt;AVFoundation/AVFoundation.h&gt;</span></span></div><div class="line"><span class="comment">//  1.获取音效资源的路径</span></div><div class="line">   <span class="built_in">NSString</span> *path = [[<span class="built_in">NSBundle</span> mainBundle]pathForResource:<span class="string">@"pour_milk"</span> ofType:<span class="string">@"wav"</span>];</div><div class="line"><span class="comment">//  2.将路劲转化为url</span></div><div class="line">   <span class="built_in">NSURL</span> *tempUrl = [<span class="built_in">NSURL</span> fileURLWithPath:path];</div><div class="line"><span class="comment">//  3.用转化成的url创建一个播放器</span></div><div class="line">   <span class="built_in">NSError</span> *error = <span class="literal">nil</span>;</div><div class="line">   <span class="built_in">AVAudioPlayer</span> *play = [[<span class="built_in">AVAudioPlayer</span> alloc]initWithContentsOfURL:tempUrl error:&amp;error];</div><div class="line">   <span class="keyword">self</span>.player = play;</div><div class="line"><span class="comment">//  4.播放</span></div><div class="line">[play play];</div></pre></td></tr></table></figure>
<h4 id="11，修改Tabbar-Item的属性"><a href="#11，修改Tabbar-Item的属性" class="headerlink" title="11，修改Tabbar Item的属性"></a>11，修改Tabbar Item的属性</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">// 修改标题位置</span></div><div class="line"><span class="keyword">self</span>.tabBarItem.titlePositionAdjustment = <span class="built_in">UIOffsetMake</span>(<span class="number">0</span>, <span class="number">-10</span>);</div><div class="line"><span class="comment">// 修改图片位置</span></div><div class="line"><span class="keyword">self</span>.tabBarItem.imageInsets = <span class="built_in">UIEdgeInsetsMake</span>(<span class="number">-3</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>);</div><div class="line"></div><div class="line"><span class="comment">// 批量修改属性</span></div><div class="line"><span class="keyword">for</span> (<span class="built_in">UIBarItem</span> *item <span class="keyword">in</span> <span class="keyword">self</span>.tabBarController.tabBar.items) &#123;</div><div class="line">    [item setTitleTextAttributes:[<span class="built_in">NSDictionary</span> dictionaryWithObjectsAndKeys:</div><div class="line">             [<span class="built_in">UIFont</span> fontWithName:<span class="string">@"Helvetica"</span> size:<span class="number">19.0</span>], <span class="built_in">NSFontAttributeName</span>, <span class="literal">nil</span>]</div><div class="line">                        forState:<span class="built_in">UIControlStateNormal</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 设置选中和未选中字体颜色</span></div><div class="line">[[<span class="built_in">UITabBar</span> appearance] setShadowImage:[[<span class="built_in">UIImage</span> alloc] init]];</div><div class="line"></div><div class="line"><span class="comment">//未选中字体颜色</span></div><div class="line">[[<span class="built_in">UITabBarItem</span> appearance] setTitleTextAttributes:@&#123;<span class="built_in">NSForegroundColorAttributeName</span>:[<span class="built_in">UIColor</span> greenColor]&#125; forState:<span class="built_in">UIControlStateNormal</span>];</div><div class="line"></div><div class="line"><span class="comment">//选中字体颜色</span></div><div class="line">[[<span class="built_in">UITabBarItem</span> appearance] setTitleTextAttributes:@&#123;<span class="built_in">NSForegroundColorAttributeName</span>:[<span class="built_in">UIColor</span> cyanColor]&#125; forState:<span class="built_in">UIControlStateSelected</span>];</div><div class="line"></div><div class="line"><span class="comment">//去掉BackBarButtonItem的文字</span></div><div class="line">[[<span class="built_in">UIBarButtonItem</span> appearance] setBackButtonTitlePositionAdjustment:<span class="built_in">UIOffsetMake</span>(<span class="number">0</span>, <span class="number">-60</span>)</div><div class="line">                                                         forBarMetrics:<span class="built_in">UIBarMetricsDefault</span>];</div></pre></td></tr></table></figure>
<h4 id="12，NULL-nil-Nil-NSNULL的区别"><a href="#12，NULL-nil-Nil-NSNULL的区别" class="headerlink" title="12，NULL - nil - Nil - NSNULL的区别"></a>12，NULL - nil - Nil - NSNULL的区别</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">* <span class="literal">nil</span>是OC的，空对象，地址指向空（<span class="number">0</span>）的对象。对象的字面零值</div><div class="line"></div><div class="line">* Nil是Objective-C类的字面零值</div><div class="line"></div><div class="line">* <span class="literal">NULL</span>是C的，空地址，地址的数值是<span class="number">0</span>，是个长整数</div><div class="line"></div><div class="line">* <span class="built_in">NSNull</span>用于解决向<span class="built_in">NSArray</span>和<span class="built_in">NSDictionary</span>等集合中添加空值的问题</div></pre></td></tr></table></figure>
<h4 id="13，修改UITextField中Placeholder的文字颜色"><a href="#13，修改UITextField中Placeholder的文字颜色" class="headerlink" title="13，修改UITextField中Placeholder的文字颜色"></a>13，修改UITextField中Placeholder的文字颜色</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">[text setValue:[<span class="built_in">UIColor</span> redColor] forKeyPath:<span class="string">@"_placeholderLabel.textColor"</span>];</div></pre></td></tr></table></figure>
<h4 id="14，生命周期"><a href="#14，生命周期" class="headerlink" title="14，生命周期"></a>14，生命周期</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="number">1</span>、 alloc 创建对象，分配空间</div><div class="line"><span class="number">2</span>、 init (initWithNibName) 初始化对象，初始化数据</div><div class="line"><span class="number">3</span>、 loadView 从nib载入视图 ，除非你没有使用xib文件创建视图</div><div class="line"><span class="number">4</span>、 viewDidLoad 载入完成，可以进行自定义数据以及动态创建其他控件</div><div class="line"><span class="number">5</span>、 viewWillAppear视图将出现在屏幕之前，马上这个视图就会被展现在屏幕上了</div><div class="line"><span class="number">6</span>、 viewDidAppear 视图已在屏幕上渲染完成</div><div class="line"></div><div class="line"><span class="number">1</span>、viewWillDisappear 视图将被从屏幕上移除之前执行</div><div class="line"><span class="number">2</span>、viewDidDisappear 视图已经被从屏幕上移除，用户看不到这个视图了</div><div class="line"><span class="number">3</span>、dealloc 视图被销毁，此处需要对你在init和viewDidLoad中创建的对象进行释放.</div><div class="line"></div><div class="line">viewVillUnload－ 当内存过低，即将释放时调用；</div><div class="line">viewDidUnload－当内存过低，释放一些不需要的视图时调用。</div><div class="line"></div><div class="line">*应用程序的生命周期:</div><div class="line"></div><div class="line"><span class="number">1</span>，启动但还没进入状态保存 ：</div><div class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application willFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions </div><div class="line"></div><div class="line"><span class="number">2</span>，基本完成程序准备开始运行：</div><div class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions</div><div class="line"> </div><div class="line"><span class="number">3</span>，当应用程序将要入非活动状态执行，应用程序不接收消息或事件，比如来电话了：</div><div class="line">- (<span class="keyword">void</span>)applicationWillResignActive:(<span class="built_in">UIApplication</span> *)application </div><div class="line"></div><div class="line"><span class="number">4</span>，当应用程序入活动状态执行，这个刚好跟上面那个方法相反：</div><div class="line">- (<span class="keyword">void</span>)applicationDidBecomeActive:(<span class="built_in">UIApplication</span> *)application   </div><div class="line"></div><div class="line"><span class="number">5</span>，当程序被推送到后台的时候调用。所以要设置后台继续运行，则在这个函数里面设置即可：</div><div class="line">- (<span class="keyword">void</span>)applicationDidEnterBackground:(<span class="built_in">UIApplication</span> *)application  </div><div class="line"></div><div class="line"><span class="number">6</span>，当程序从后台将要重新回到前台时候调用，这个刚好跟上面的那个方法相反：</div><div class="line">- (<span class="keyword">void</span>)applicationWillEnterForeground:(<span class="built_in">UIApplication</span> *)application  </div><div class="line"></div><div class="line"><span class="number">7</span>，当程序将要退出是被调用，通常是用来保存数据和一些退出前的清理工作：</div><div class="line">- (<span class="keyword">void</span>)applicationWillTerminate:(<span class="built_in">UIApplication</span> *)application</div></pre></td></tr></table></figure>
<h4 id="15，判断view是不是指定视图的子视图"><a href="#15，判断view是不是指定视图的子视图" class="headerlink" title="15，判断view是不是指定视图的子视图"></a>15，判断view是不是指定视图的子视图</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="built_in">BOOL</span> isView =  [textView isDescendantOfView:<span class="keyword">self</span>.view];</div></pre></td></tr></table></figure>
<h4 id="16，判断对象是否遵循了某协议"><a href="#16，判断对象是否遵循了某协议" class="headerlink" title="16，判断对象是否遵循了某协议"></a>16，判断对象是否遵循了某协议</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="keyword">if</span> ([<span class="keyword">self</span>.selectedController conformsToProtocol:<span class="class"><span class="keyword">@protocol</span>(<span class="title">RefreshPtotocol</span>)]) </span>&#123;</div><div class="line">    [<span class="keyword">self</span>.selectedController performSelector:<span class="keyword">@selector</span>(onTriggerRefresh)];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="17，页面强制横屏"><a href="#17，页面强制横屏" class="headerlink" title="17，页面强制横屏"></a>17，页面强制横屏</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="meta">#pragma mark - 强制横屏代码</span></div><div class="line">- (<span class="built_in">BOOL</span>)shouldAutorotate&#123;    </div><div class="line"><span class="comment">//是否支持转屏       </span></div><div class="line"><span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">&#125;</div><div class="line">- (<span class="built_in">UIInterfaceOrientationMask</span>)supportedInterfaceOrientations&#123;    </div><div class="line"><span class="comment">//支持哪些转屏方向    </span></div><div class="line"><span class="keyword">return</span> <span class="built_in">UIInterfaceOrientationMaskLandscape</span>;</div><div class="line">&#125;</div><div class="line">- (<span class="built_in">UIInterfaceOrientation</span>)preferredInterfaceOrientationForPresentation&#123;               </div><div class="line"><span class="keyword">return</span> <span class="built_in">UIInterfaceOrientationLandscapeRight</span>;</div><div class="line">&#125;</div><div class="line">- (<span class="built_in">BOOL</span>)prefersStatusBarHidden&#123;   </div><div class="line"><span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="18，系统键盘通知消息"><a href="#18，系统键盘通知消息" class="headerlink" title="18，系统键盘通知消息"></a>18，系统键盘通知消息</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="number">1</span>、<span class="built_in">UIKeyboardWillShowNotification</span>-将要弹出键盘</div><div class="line"><span class="number">2</span>、<span class="built_in">UIKeyboardDidShowNotification</span>-显示键盘</div><div class="line"><span class="number">3</span>、<span class="built_in">UIKeyboardWillHideNotification</span>-将要隐藏键盘</div><div class="line"><span class="number">4</span>、<span class="built_in">UIKeyboardDidHideNotification</span>-键盘已经隐藏</div><div class="line"><span class="number">5</span>、<span class="built_in">UIKeyboardWillChangeFrameNotification</span>-键盘将要改变frame</div><div class="line"><span class="number">6</span>、<span class="built_in">UIKeyboardDidChangeFrameNotification</span>-键盘已经改变frame</div></pre></td></tr></table></figure>
<h4 id="19，关闭navigationController的滑动返回手势"><a href="#19，关闭navigationController的滑动返回手势" class="headerlink" title="19，关闭navigationController的滑动返回手势"></a>19，关闭navigationController的滑动返回手势</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="keyword">self</span>.navigationController.interactivePopGestureRecognizer.enabled = <span class="literal">NO</span>;</div></pre></td></tr></table></figure>
<h4 id="20，设置状态栏背景为任意的颜色"><a href="#20，设置状态栏背景为任意的颜色" class="headerlink" title="20，设置状态栏背景为任意的颜色"></a>20，设置状态栏背景为任意的颜色</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)setStatusColor</div><div class="line">&#123;</div><div class="line">    <span class="built_in">UIView</span> *statusBarView = [[<span class="built_in">UIView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>,[<span class="built_in">UIScreen</span> mainScreen].bounds.size.width, <span class="number">20</span>)];</div><div class="line">    statusBarView.backgroundColor = [<span class="built_in">UIColor</span> orangeColor];</div><div class="line">    [<span class="keyword">self</span>.view addSubview:statusBarView];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="21，让Xcode的控制台支持LLDB类型的打印"><a href="#21，让Xcode的控制台支持LLDB类型的打印" class="headerlink" title="21，让Xcode的控制台支持LLDB类型的打印"></a>21，让Xcode的控制台支持LLDB类型的打印</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">打开终端输入三条命令:</div><div class="line">touch ~/.lldbinit</div><div class="line">echo display <span class="keyword">@import</span> <span class="built_in">UIKit</span> &gt;&gt; ~/.lldbinit</div><div class="line">echo target stop-hook add -o \<span class="string">"target stop-hook disable\" &gt;&gt; ~/.lldbinit</span></div></pre></td></tr></table></figure>
<h4 id="22，Label行间距"><a href="#22，Label行间距" class="headerlink" title="22，Label行间距"></a>22，Label行间距</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">-（<span class="keyword">void</span>）test&#123;</div><div class="line">    <span class="built_in">NSMutableAttributedString</span> *attributedString =    </div><div class="line">    [[<span class="built_in">NSMutableAttributedString</span> alloc] initWithString:<span class="keyword">self</span>.contentLabel.text];</div><div class="line">    <span class="built_in">NSMutableParagraphStyle</span> *paragraphStyle =  [[<span class="built_in">NSMutableParagraphStyle</span> alloc] init];  </div><div class="line">    [paragraphStyle setLineSpacing:<span class="number">3</span>];</div><div class="line"></div><div class="line">    <span class="comment">//调整行间距       </span></div><div class="line">    [attributedString addAttribute:<span class="built_in">NSParagraphStyleAttributeName</span> </div><div class="line">                                    value:paragraphStyle </div><div class="line">                                    range:<span class="built_in">NSMakeRange</span>(<span class="number">0</span>, [<span class="keyword">self</span>.contentLabel.text length])];</div><div class="line">    <span class="keyword">self</span>.contentLabel.attributedText = attributedString;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="23，UIImageView填充模式"><a href="#23，UIImageView填充模式" class="headerlink" title="23，UIImageView填充模式"></a>23，UIImageView填充模式</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="string">@"UIViewContentModeScaleToFill"</span>,      <span class="comment">// 拉伸自适应填满整个视图  </span></div><div class="line"><span class="string">@"UIViewContentModeScaleAspectFit"</span>,   <span class="comment">// 自适应比例大小显示  </span></div><div class="line"><span class="string">@"UIViewContentModeScaleAspectFill"</span>,  <span class="comment">// 原始大小显示  </span></div><div class="line"><span class="string">@"UIViewContentModeRedraw"</span>,           <span class="comment">// 尺寸改变时重绘  </span></div><div class="line"><span class="string">@"UIViewContentModeCenter"</span>,           <span class="comment">// 中间  </span></div><div class="line"><span class="string">@"UIViewContentModeTop"</span>,              <span class="comment">// 顶部  </span></div><div class="line"><span class="string">@"UIViewContentModeBottom"</span>,           <span class="comment">// 底部  </span></div><div class="line"><span class="string">@"UIViewContentModeLeft"</span>,             <span class="comment">// 中间贴左  </span></div><div class="line"><span class="string">@"UIViewContentModeRight"</span>,            <span class="comment">// 中间贴右  </span></div><div class="line"><span class="string">@"UIViewContentModeTopLeft"</span>,          <span class="comment">// 贴左上  </span></div><div class="line"><span class="string">@"UIViewContentModeTopRight"</span>,         <span class="comment">// 贴右上  </span></div><div class="line"><span class="string">@"UIViewContentModeBottomLeft"</span>,       <span class="comment">// 贴左下  </span></div><div class="line"><span class="string">@"UIViewContentModeBottomRight"</span>,      <span class="comment">// 贴右下</span></div></pre></td></tr></table></figure>
<h4 id="24，宏定义检测block是否可用"><a href="#24，宏定义检测block是否可用" class="headerlink" title="24，宏定义检测block是否可用"></a>24，宏定义检测block是否可用</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="meta">#define BLOCK_EXEC(block, ...) if (block) &#123; block(__VA_ARGS__); &#125;;   </span></div><div class="line"><span class="comment">// 宏定义之前的用法</span></div><div class="line"> <span class="keyword">if</span> (completionBlock)   &#123;   </div><div class="line">    completionBlock(arg1, arg2); </div><div class="line"> &#125;    </div><div class="line"><span class="comment">// 宏定义之后的用法</span></div><div class="line">BLOCK_EXEC(completionBlock, arg1, arg2);</div></pre></td></tr></table></figure>
<h4 id="25，设置状态栏文字样式颜色"><a href="#25，设置状态栏文字样式颜色" class="headerlink" title="25，设置状态栏文字样式颜色"></a>25，设置状态栏文字样式颜色</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">[[<span class="built_in">UIApplication</span> sharedApplication] setStatusBarHidden:<span class="literal">NO</span>];</div><div class="line">[[<span class="built_in">UIApplication</span> sharedApplication] setStatusBarStyle:<span class="built_in">UIStatusBarStyleLightContent</span>];</div></pre></td></tr></table></figure>
<h4 id="26，iOS中的一些手势"><a href="#26，iOS中的一些手势" class="headerlink" title="*26，iOS中的一些手势"></a>*26，iOS中的一些手势</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">轻击手势（TapGestureRecognizer）</div><div class="line">轻扫手势（SwipeGestureRecognizer）</div><div class="line">长按手势（LongPressGestureRecognizer）</div><div class="line">拖动手势（PanGestureRecognizer）</div><div class="line">捏合手势（PinchGestureRecognizer）</div><div class="line">旋转手势（RotationGestureRecognizer）</div></pre></td></tr></table></figure>
<h4 id="27，iOS-开发中一些相关的路径"><a href="#27，iOS-开发中一些相关的路径" class="headerlink" title="27，iOS 开发中一些相关的路径"></a>27，iOS 开发中一些相关的路径</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">模拟器的位置:</div><div class="line">/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs </div><div class="line"></div><div class="line">文档安装位置:</div><div class="line">/Applications/Xcode.app/Contents/Developer/Documentation/DocSets</div><div class="line"></div><div class="line">插件保存路径:</div><div class="line">~/Library/ApplicationSupport/Developer/Shared/Xcode/Plug-ins</div><div class="line"></div><div class="line">自定义代码段的保存路径:</div><div class="line">~/Library/Developer/Xcode/UserData/CodeSnippets/ </div><div class="line">如果找不到CodeSnippets文件夹，可以自己新建一个CodeSnippets文件夹。</div><div class="line"></div><div class="line">证书路径</div><div class="line">~/Library/MobileDevice/Provisioning Profiles</div></pre></td></tr></table></figure>
<h4 id="28，获取-iOS-路径的方法"><a href="#28，获取-iOS-路径的方法" class="headerlink" title="28，获取 iOS 路径的方法"></a>28，获取 iOS 路径的方法</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">获取用户目录路径的函数</div><div class="line"><span class="built_in">NSString</span> *homeDir = <span class="built_in">NSHomeDirectory</span>();</div><div class="line"></div><div class="line">获取Documents目录路径的方法</div><div class="line"><span class="built_in">NSArray</span> *paths = <span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSDocumentDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>);</div><div class="line"><span class="built_in">NSString</span> *docDir = [paths objectAtIndex:<span class="number">0</span>];</div><div class="line"></div><div class="line">获取Cache目录路径的方法</div><div class="line"><span class="built_in">NSArray</span> *paths = <span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSCachesDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>);</div><div class="line"><span class="built_in">NSString</span> *cachesDir = [paths objectAtIndex:<span class="number">0</span>];</div><div class="line"></div><div class="line">获取tmp目录路径的方法：</div><div class="line"><span class="built_in">NSString</span> *tmpDir = <span class="built_in">NSTemporaryDirectory</span>();</div></pre></td></tr></table></figure>
<h4 id="29，字符串相关操作"><a href="#29，字符串相关操作" class="headerlink" title="29，字符串相关操作"></a>29，字符串相关操作</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">去除所有的空格</div><div class="line">[str stringByReplacingOccurrencesOfString:<span class="string">@" "</span> withString:<span class="string">@""</span>]</div><div class="line"></div><div class="line">去除首尾的空格</div><div class="line">[str stringByTrimmingCharactersInSet:[<span class="built_in">NSCharacterSet</span> whitespaceCharacterSet]];</div><div class="line"></div><div class="line">- (<span class="built_in">NSString</span> *)uppercaseString; 全部字符转为大写字母</div><div class="line">- (<span class="built_in">NSString</span> *)lowercaseString 全部字符转为小写字母</div></pre></td></tr></table></figure>
<h4 id="30，-CocoaPods-pod-install-pod-update更新慢的问题"><a href="#30，-CocoaPods-pod-install-pod-update更新慢的问题" class="headerlink" title="30， CocoaPods pod install/pod update更新慢的问题"></a>30， CocoaPods pod install/pod update更新慢的问题</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">pod install --verbose --no-repo-update </div><div class="line">pod update --verbose --no-repo-update</div><div class="line">如果不加后面的参数，默认会升级CocoaPods的spec仓库，加一个参数可以省略这一步，然后速度就会提升不少。</div></pre></td></tr></table></figure>
<h4 id="31，MRC和ARC混编设置方式"><a href="#31，MRC和ARC混编设置方式" class="headerlink" title="31，MRC和ARC混编设置方式"></a>31，MRC和ARC混编设置方式</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">在<span class="built_in">XCode</span>中targets的build phases选项下Compile Sources下选择 不需要arc编译的文件</div><div class="line">双击输入 -fno-objc-arc 即可</div><div class="line"></div><div class="line">MRC工程中也可以使用ARC的类，方法如下：</div><div class="line">在<span class="built_in">XCode</span>中targets的build phases选项下Compile Sources下选择要使用arc编译的文件</div><div class="line">双击输入 -fobjc-arc 即可</div></pre></td></tr></table></figure>
<h4 id="32，把tableview里cell的小对勾的颜色改成别的颜色"><a href="#32，把tableview里cell的小对勾的颜色改成别的颜色" class="headerlink" title="32，把tableview里cell的小对勾的颜色改成别的颜色"></a>32，把tableview里cell的小对勾的颜色改成别的颜色</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">_mTableView.tintColor = [<span class="built_in">UIColor</span> redColor];</div></pre></td></tr></table></figure>
<h4 id="33，调整tableview的separaLine线的位置"><a href="#33，调整tableview的separaLine线的位置" class="headerlink" title="33，调整tableview的separaLine线的位置"></a>33，调整tableview的separaLine线的位置</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">tableView.separatorInset = <span class="built_in">UIEdgeInsetsMake</span>(<span class="number">0</span>, <span class="number">100</span>, <span class="number">0</span>, <span class="number">0</span>);</div></pre></td></tr></table></figure>
<h4 id="34，设置滑动的时候隐藏navigationbar"><a href="#34，设置滑动的时候隐藏navigationbar" class="headerlink" title="34，设置滑动的时候隐藏navigationbar"></a>34，设置滑动的时候隐藏navigationbar</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">navigationController.hidesBarsOnSwipe = Yes</div></pre></td></tr></table></figure>
<h4 id="35，自动处理键盘事件，实现输入框防遮挡的插件"><a href="#35，自动处理键盘事件，实现输入框防遮挡的插件" class="headerlink" title="35，自动处理键盘事件，实现输入框防遮挡的插件**"></a>35，自动处理键盘事件，实现输入框防遮挡的插件**</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">IQKeyboardManager</div><div class="line">https:<span class="comment">//github.com/hackiftekhar/IQKeyboardManager</span></div></pre></td></tr></table></figure>
<h4 id="36，Quartz2D相关"><a href="#36，Quartz2D相关" class="headerlink" title="36，Quartz2D相关"></a>36，Quartz2D相关</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">图形上下文是一个<span class="built_in">CGContextRef</span>类型的数据。</div><div class="line">图形上下文包含：</div><div class="line"><span class="number">1</span>，绘图路径（各种各样图形）</div><div class="line"><span class="number">2</span>，绘图状态（颜色，线宽，样式，旋转，缩放，平移）</div><div class="line"><span class="number">3</span>，输出目标（绘制到什么地方去？<span class="built_in">UIView</span>、图片）</div><div class="line"></div><div class="line"><span class="number">1</span>，获取当前图形上下文</div><div class="line"><span class="built_in">CGContextRef</span> ctx = <span class="built_in">UIGraphicsGetCurrentContext</span>();</div><div class="line"><span class="number">2</span>，添加线条</div><div class="line"><span class="built_in">CGContextMoveToPoint</span>(ctx, <span class="number">20</span>, <span class="number">20</span>);</div><div class="line"><span class="number">3</span>，渲染</div><div class="line"><span class="built_in">CGContextStrokePath</span>(ctx);</div><div class="line"><span class="built_in">CGContextFillPath</span>(ctx);</div><div class="line"><span class="number">4</span>，关闭路径</div><div class="line"><span class="built_in">CGContextClosePath</span>(ctx);</div><div class="line"><span class="number">5</span>，画矩形</div><div class="line"><span class="built_in">CGContextAddRect</span>(ctx, <span class="built_in">CGRectMake</span>(<span class="number">20</span>, <span class="number">20</span>, <span class="number">100</span>, <span class="number">120</span>));</div><div class="line"><span class="number">6</span>，设置线条颜色</div><div class="line">[[<span class="built_in">UIColor</span> redColor] setStroke];</div><div class="line"><span class="number">7</span>， 设置线条宽度</div><div class="line"><span class="built_in">CGContextSetLineWidth</span>(ctx, <span class="number">20</span>);</div><div class="line"><span class="number">8</span>，设置头尾样式</div><div class="line"><span class="built_in">CGContextSetLineCap</span>(ctx, kCGLineCapSquare);</div><div class="line"><span class="number">9</span>，设置转折点样式</div><div class="line"><span class="built_in">CGContextSetLineJoin</span>(ctx, kCGLineJoinBevel);</div><div class="line"><span class="number">10</span>，画圆</div><div class="line"><span class="built_in">CGContextAddEllipseInRect</span>(ctx, <span class="built_in">CGRectMake</span>(<span class="number">30</span>, <span class="number">50</span>, <span class="number">100</span>, <span class="number">100</span>));</div><div class="line"><span class="number">11</span>，指定圆心</div><div class="line"><span class="built_in">CGContextAddArc</span>(ctx, <span class="number">100</span>, <span class="number">100</span>, <span class="number">50</span>, <span class="number">0</span>, M_PI * <span class="number">2</span>, <span class="number">1</span>);</div><div class="line"><span class="number">12</span>，获取图片上下文</div><div class="line"><span class="built_in">UIGraphicsGetImageFromCurrentImageContext</span>();</div><div class="line"><span class="number">13</span>，保存图形上下文</div><div class="line"><span class="built_in">CGContextSaveGState</span>(ctx)</div><div class="line"><span class="number">14</span>，恢复图形上下文</div><div class="line"><span class="built_in">CGContextRestoreGState</span>(ctx)</div></pre></td></tr></table></figure>
<h4 id="37，屏幕截图"><a href="#37，屏幕截图" class="headerlink" title="37，屏幕截图"></a>37，屏幕截图</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">// 1. 开启一个与图片相关的图形上下文</span></div><div class="line"><span class="built_in">UIGraphicsBeginImageContextWithOptions</span>(<span class="keyword">self</span>.view.bounds.size,<span class="literal">NO</span>,<span class="number">0.0</span>);</div><div class="line"></div><div class="line"><span class="comment">// 2. 获取当前图形上下文</span></div><div class="line"><span class="built_in">CGContextRef</span> ctx = <span class="built_in">UIGraphicsGetCurrentContext</span>();</div><div class="line"></div><div class="line"><span class="comment">// 3. 获取需要截取的view的layer</span></div><div class="line">[<span class="keyword">self</span>.view.layer renderInContext:ctx];</div><div class="line"></div><div class="line"><span class="comment">// 4. 从当前上下文中获取图片</span></div><div class="line"><span class="built_in">UIImage</span> *image = <span class="built_in">UIGraphicsGetImageFromCurrentImageContext</span>();</div><div class="line"></div><div class="line"><span class="comment">// 5. 关闭图形上下文</span></div><div class="line"><span class="built_in">UIGraphicsEndImageContext</span>();</div><div class="line"></div><div class="line"><span class="comment">// 6. 把图片保存到相册</span></div><div class="line"><span class="built_in">UIImageWriteToSavedPhotosAlbum</span>(image, <span class="literal">nil</span>, <span class="literal">nil</span>, <span class="literal">nil</span>);</div></pre></td></tr></table></figure>
<h4 id="37，左右抖动动画"><a href="#37，左右抖动动画" class="headerlink" title="37，左右抖动动画"></a>37，左右抖动动画</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">//1, 创建核心动画</span></div><div class="line"><span class="built_in">CAKeyframeAnimation</span> *keyAnima = [<span class="built_in">CAKeyframeAnimation</span> animation]; </div><div class="line"></div><div class="line"><span class="comment">//2, 告诉系统执行什么动画。</span></div><div class="line">keyAnima.keyPath = <span class="string">@"transform.rotation"</span>; </div><div class="line">keyAnima.values = @[@(-M_PI_4 /<span class="number">90.0</span> * <span class="number">5</span>),@(M_PI_4 /<span class="number">90.0</span> * <span class="number">5</span>),@(-M_PI_4 /<span class="number">90.0</span> * <span class="number">5</span>)]; </div><div class="line"></div><div class="line"><span class="comment">//  3, 执行完之后不删除动画 </span></div><div class="line">keyAnima.removedOnCompletion = <span class="literal">NO</span>; </div><div class="line"></div><div class="line"><span class="comment">// 4, 执行完之后保存最新的状态 </span></div><div class="line">keyAnima.fillMode = kCAFillModeForwards; </div><div class="line"></div><div class="line"><span class="comment">// 5, 动画执行时间 </span></div><div class="line">keyAnima.duration = <span class="number">0.2</span>; </div><div class="line"></div><div class="line"><span class="comment">// 6, 设置重复次数。 </span></div><div class="line">keyAnima.repeatCount = MAXFLOAT; </div><div class="line"></div><div class="line"><span class="comment">// 7, 添加核心动画 </span></div><div class="line">[<span class="keyword">self</span>.iconView.layer addAnimation:keyAnima forKey:<span class="literal">nil</span>];</div></pre></td></tr></table></figure>
<h4 id="38，CALayer-的知识"><a href="#38，CALayer-的知识" class="headerlink" title="38，CALayer 的知识"></a>38，CALayer 的知识</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="built_in">CALayer</span>  负责视图中显示内容和动画</div><div class="line"><span class="built_in">UIView</span>     负责监听和响应事件</div><div class="line"></div><div class="line">创建<span class="built_in">UIView</span>对象时，<span class="built_in">UIView</span>内部会自动创建一个图层（既<span class="built_in">CALayer</span>）</div><div class="line"><span class="built_in">UIView</span>本身不具备显示的功能，是它内部的层才有显示功能.</div><div class="line"></div><div class="line"><span class="built_in">CALayer</span>属性：</div><div class="line">position  中点（由anchorPoint决定）</div><div class="line">anchorPoint 锚点</div><div class="line">borderColor 边框颜色</div><div class="line">borderWidth 边框宽度</div><div class="line">cornerRadius 圆角半径</div><div class="line">shadowColor 阴影颜色</div><div class="line">contents 内容</div><div class="line">opacity 透明度</div><div class="line">shadowOpacity 偏移</div><div class="line">shadowRadius 阴影半径</div><div class="line">shadowColor 阴影颜色</div><div class="line">masksToBounds 裁剪</div></pre></td></tr></table></figure>
<h4 id="39，性能相关"><a href="#39，性能相关" class="headerlink" title="39，性能相关"></a>39，性能相关</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="number">1.</span> 视图复用,比如<span class="built_in">UITableViewCell</span>,<span class="built_in">UICollectionViewCell</span>.</div><div class="line"><span class="number">2.</span> 数据缓存,比如用SDWebImage实现图片缓存。</div><div class="line"><span class="number">3.</span> 任何情况下都不能堵塞主线程，把耗时操作尽量放到子线程。</div><div class="line"><span class="number">4.</span> 如果有多个下载同时并发，可以控制并发数。</div><div class="line"><span class="number">5.</span> 在合适的地方尽量使用懒加载。</div><div class="line"><span class="number">6.</span> 重用重大开销对象，比如：<span class="built_in">NSDateFormatter</span>、<span class="built_in">NSCalendar</span>。</div><div class="line"><span class="number">7.</span> 选择合适的数据存储。</div><div class="line"><span class="number">8.</span> 避免循环引用。避免delegate用<span class="keyword">retain</span>、<span class="keyword">strong</span>修饰，block可能导致循环引用，<span class="built_in">NSTimer</span>也可能导致内存泄露等。</div><div class="line"><span class="number">9.</span> 当涉及到定位的时候，不用的时候最好把定位服务关闭。因为定位耗电、流量。</div><div class="line"><span class="number">10.</span> 加锁对性能有重大开销。</div><div class="line"><span class="number">11.</span> 界面最好不要添加过多的subViews.</div><div class="line"><span class="number">12.</span> TableView 如果不同行高，那么返回行高，最好做缓存。</div><div class="line"><span class="number">13.</span> Viewdidload 里尽量不要做耗时操作。</div></pre></td></tr></table></figure>
<h4 id="40，验证身份证号码"><a href="#40，验证身份证号码" class="headerlink" title="40，验证身份证号码"></a>40，验证身份证号码</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">//验证身份证号码</span></div><div class="line">- (<span class="built_in">BOOL</span>)checkIdentityCardNo:(<span class="built_in">NSString</span>*)cardNo</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (cardNo.length != <span class="number">18</span>) &#123;</div><div class="line">        <span class="keyword">return</span>  <span class="literal">NO</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">NSArray</span>* codeArray = [<span class="built_in">NSArray</span> arrayWithObjects:<span class="string">@"7"</span>,<span class="string">@"9"</span>,<span class="string">@"10"</span>,<span class="string">@"5"</span>,<span class="string">@"8"</span>,<span class="string">@"4"</span>,<span class="string">@"2"</span>,<span class="string">@"1"</span>,<span class="string">@"6"</span>,<span class="string">@"3"</span>,<span class="string">@"7"</span>,<span class="string">@"9"</span>,<span class="string">@"10"</span>,<span class="string">@"5"</span>,<span class="string">@"8"</span>,<span class="string">@"4"</span>,<span class="string">@"2"</span>, <span class="literal">nil</span>];</div><div class="line">    <span class="built_in">NSDictionary</span>* checkCodeDic = [<span class="built_in">NSDictionary</span> dictionaryWithObjects:[<span class="built_in">NSArray</span> arrayWithObjects:<span class="string">@"1"</span>,<span class="string">@"0"</span>,<span class="string">@"X"</span>,<span class="string">@"9"</span>,<span class="string">@"8"</span>,<span class="string">@"7"</span>,<span class="string">@"6"</span>,<span class="string">@"5"</span>,<span class="string">@"4"</span>,<span class="string">@"3"</span>,<span class="string">@"2"</span>, <span class="literal">nil</span>]  forKeys:[<span class="built_in">NSArray</span> arrayWithObjects:<span class="string">@"0"</span>,<span class="string">@"1"</span>,<span class="string">@"2"</span>,<span class="string">@"3"</span>,<span class="string">@"4"</span>,<span class="string">@"5"</span>,<span class="string">@"6"</span>,<span class="string">@"7"</span>,<span class="string">@"8"</span>,<span class="string">@"9"</span>,<span class="string">@"10"</span>, <span class="literal">nil</span>]];</div><div class="line"></div><div class="line">    <span class="built_in">NSScanner</span>* scan = [<span class="built_in">NSScanner</span> scannerWithString:[cardNo substringToIndex:<span class="number">17</span>]];</div><div class="line"></div><div class="line">    <span class="keyword">int</span> val;</div><div class="line">    <span class="built_in">BOOL</span> isNum = [scan scanInt:&amp;val] &amp;&amp; [scan isAtEnd];</div><div class="line">    <span class="keyword">if</span> (!isNum) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> sumValue = <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i =<span class="number">0</span>; i&lt;<span class="number">17</span>; i++) &#123;</div><div class="line">        sumValue+=[[cardNo substringWithRange:<span class="built_in">NSMakeRange</span>(i , <span class="number">1</span>) ] intValue]* [[codeArray objectAtIndex:i] intValue];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">NSString</span>* strlast = [checkCodeDic objectForKey:[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%d"</span>,sumValue%<span class="number">11</span>]];</div><div class="line"></div><div class="line">    <span class="keyword">if</span> ([strlast isEqualToString: [[cardNo substringWithRange:<span class="built_in">NSMakeRange</span>(<span class="number">17</span>, <span class="number">1</span>)]uppercaseString]]) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span>  <span class="literal">NO</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="41，响应者链条顺序"><a href="#41，响应者链条顺序" class="headerlink" title="41，响应者链条顺序"></a>41，响应者链条顺序</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="number">1</span>&gt; 当应用程序启动以后创建 <span class="built_in">UIApplication</span> 对象</div><div class="line"></div><div class="line"><span class="number">2</span>&gt; 然后启动“消息循环”监听所有的事件</div><div class="line"></div><div class="line"><span class="number">3</span>&gt; 当用户触摸屏幕的时候, <span class="string">"消息循环"</span>监听到这个触摸事件</div><div class="line"></div><div class="line"><span class="number">4</span>&gt; <span class="string">"消息循环"</span> 首先把监听到的触摸事件传递了 <span class="built_in">UIApplication</span> 对象</div><div class="line"></div><div class="line"><span class="number">5</span>&gt; <span class="built_in">UIApplication</span> 对象再传递给 <span class="built_in">UIWindow</span> 对象</div><div class="line"></div><div class="line"><span class="number">6</span>&gt; <span class="built_in">UIWindow</span> 对象再传递给 <span class="built_in">UIWindow</span> 的根控制器(rootViewController)</div><div class="line"></div><div class="line"><span class="number">7</span>&gt; 控制器再传递给控制器所管理的 view</div><div class="line"></div><div class="line"><span class="number">8</span>&gt; 控制器所管理的 View 在其内部搜索看本次触摸的点在哪个控件的范围内（调用Hit test检测是否在这个范围内）</div><div class="line"></div><div class="line"><span class="number">9</span>&gt; 找到某个控件以后(调用这个控件的 touchesXxx 方法), 再一次向上返回, 最终返回给<span class="string">"消息循环"</span></div><div class="line"></div><div class="line"><span class="number">10</span>&gt; <span class="string">"消息循环"</span>知道哪个按钮被点击后, 在搜索这个按钮是否注册了对应的事件, 如果注册了, 那么就调用这个<span class="string">"事件处理"</span>程序。（一般就是执行控制器中的<span class="string">"事件处理"</span>方法）</div></pre></td></tr></table></figure>
<h4 id="42，使用函数式指针执行方法和忽略performSelector方法的时候警告"><a href="#42，使用函数式指针执行方法和忽略performSelector方法的时候警告" class="headerlink" title="42，使用函数式指针执行方法和忽略performSelector方法的时候警告"></a>42，使用函数式指针执行方法和忽略performSelector方法的时候警告</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">//不带参数的：</span></div><div class="line">SEL selector = <span class="built_in">NSSelectorFromString</span>(<span class="string">@"someMethod"</span>);</div><div class="line">IMP imp = [_controller methodForSelector:selector];</div><div class="line"><span class="keyword">void</span> (*func)(<span class="keyword">id</span>, SEL) = (<span class="keyword">void</span> *)imp;</div><div class="line">func(_controller, selector);</div><div class="line"></div><div class="line"><span class="comment">//带参数的：</span></div><div class="line">SEL selector = <span class="built_in">NSSelectorFromString</span>(<span class="string">@"processRegion:ofView:"</span>);</div><div class="line">IMP imp = [_controller methodForSelector:selector];</div><div class="line"><span class="built_in">CGRect</span> (*func)(<span class="keyword">id</span>, SEL, <span class="built_in">CGRect</span>, <span class="built_in">UIView</span> *) = (<span class="keyword">void</span> *)imp;</div><div class="line"><span class="built_in">CGRect</span> result = func(_controller, selector, someRect, someView);</div><div class="line"></div><div class="line"><span class="comment">//忽略警告：</span></div><div class="line"><span class="meta">#pragma clang diagnostic push </span></div><div class="line"><span class="meta">#pragma clang diagnostic ignored <span class="meta-string">"-Warc-performSelector-leaks"</span></span></div><div class="line">[someController performSelector: <span class="built_in">NSSelectorFromString</span>(<span class="string">@"someMethod"</span>)]</div><div class="line"><span class="meta">#pragma clang diagnostic pop</span></div><div class="line"></div><div class="line"><span class="comment">//如果需要忽视的警告有多处，可以定义一个宏：</span></div><div class="line"><span class="meta">#define SuppressPerformSelectorLeakWarning(Stuff) \ </span></div><div class="line"><span class="keyword">do</span> &#123;\ </div><div class="line">_Pragma(<span class="string">"clang diagnostic push"</span>) \ </div><div class="line">_Pragma(<span class="string">"clang diagnostic ignored \"-Warc-performSelector-leaks\""</span>) \</div><div class="line">Stuff; \</div><div class="line">_Pragma(<span class="string">"clang diagnostic pop"</span>) \ </div><div class="line">&#125; <span class="keyword">while</span> (<span class="number">0</span>)</div><div class="line"><span class="comment">//使用方法：</span></div><div class="line">SuppressPerformSelectorLeakWarning( </div><div class="line">[_target performSelector:_action withObject:<span class="keyword">self</span>]</div><div class="line">);</div></pre></td></tr></table></figure>
<h4 id="43，UIApplication的简单使用"><a href="#43，UIApplication的简单使用" class="headerlink" title="43，UIApplication的简单使用"></a>43，UIApplication的简单使用</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">//--------设置角标数字--------</span></div><div class="line"><span class="comment">//获取UIApplication对象</span></div><div class="line">    <span class="built_in">UIApplication</span> *ap = [<span class="built_in">UIApplication</span> sharedApplication];</div><div class="line"><span class="comment">//在设置之前, 要注册一个通知,从ios8之后,都要先注册一个通知对象.才能够接收到提醒.</span></div><div class="line">    <span class="built_in">UIUserNotificationSettings</span> *notice =</div><div class="line">    [<span class="built_in">UIUserNotificationSettings</span> settingsForTypes:<span class="built_in">UIUserNotificationTypeBadge</span> categories:<span class="literal">nil</span>];</div><div class="line"><span class="comment">//注册通知对象</span></div><div class="line">    [ap registerUserNotificationSettings:notice];</div><div class="line"><span class="comment">//设置提醒数字</span></div><div class="line">    ap.applicationIconBadgeNumber = <span class="number">20</span>;</div><div class="line"></div><div class="line"><span class="comment">//--------设置联网状态--------</span></div><div class="line"><span class="built_in">UIApplication</span> *ap = [<span class="built_in">UIApplication</span> sharedApplication];</div><div class="line">ap.networkActivityIndicatorVisible = <span class="literal">YES</span>;</div></pre></td></tr></table></figure>
<h4 id="44-UITableView隐藏空白部分线条"><a href="#44-UITableView隐藏空白部分线条" class="headerlink" title="44, UITableView隐藏空白部分线条"></a>44, UITableView隐藏空白部分线条</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="keyword">self</span>.tableView.tableFooterView =  [[<span class="built_in">UIView</span> alloc]init];</div></pre></td></tr></table></figure>
<h4 id="45，显示git增量的Xcode插件：GitDiff"><a href="#45，显示git增量的Xcode插件：GitDiff" class="headerlink" title="45，显示git增量的Xcode插件：GitDiff"></a>45，显示git增量的Xcode插件：GitDiff</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">下载地址：https:<span class="comment">//github.com/johnno1962/GitDiff</span></div><div class="line">这款插件的名字是GitDiff，作用就是可以显示表示出git增量提交的代码行,会在Xcode左边标识出来</div></pre></td></tr></table></figure>
<h4 id="46，各种收藏的网址"><a href="#46，各种收藏的网址" class="headerlink" title="46，各种收藏的网址"></a>46，各种收藏的网址</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">unicode编码转换</div><div class="line">http:<span class="comment">//tool.chinaz.com/tools/unicode.aspx    </span></div><div class="line"></div><div class="line">JSON 字符串格式化</div><div class="line">http:<span class="comment">//www.runoob.com/jsontool</span></div><div class="line"></div><div class="line">RGB 颜色值转换</div><div class="line">http:<span class="comment">//www.sioe.cn/yingyong/yanse-rgb-16/</span></div><div class="line"></div><div class="line">短网址生成</div><div class="line">http:<span class="comment">//dwz.wailian.work/</span></div><div class="line"></div><div class="line">MAC 软件下载</div><div class="line">http:<span class="comment">//www.waitsun.com/</span></div><div class="line"></div><div class="line">objc 中国</div><div class="line">http:<span class="comment">//objccn.io/</span></div></pre></td></tr></table></figure>
<h4 id="47，NSObject-继承图"><a href="#47，NSObject-继承图" class="headerlink" title="47，NSObject 继承图"></a>47，NSObject 继承图</h4><p><img src="http://oo90m08ev.bkt.clouddn.com/17-4-27/72206646-file_1493286154744_f939.png" alt=""></p>
<h4 id="48，浅拷贝、深拷贝、copy和strong"><a href="#48，浅拷贝、深拷贝、copy和strong" class="headerlink" title="48，浅拷贝、深拷贝、copy和strong"></a>48，浅拷贝、深拷贝、copy和strong</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">浅拷贝：（任何一方的变动都会影响到另一方）</div><div class="line">只是对对象的简单拷贝，让几个对象共用一片内存，当内存销毁的时候，指向这片内存的几个指针</div><div class="line">需要重新定义才可以使用。</div><div class="line"></div><div class="line">深拷贝：（任何一方的变动都不会影响到另一方）</div><div class="line">拷贝对象的具体内容，内存地址是自主分配的，拷贝结束后，两个对象虽然存的值是相同的，但是</div><div class="line">内存地址不一样，两个对象也互不影响，互不干涉。</div><div class="line"></div><div class="line"><span class="keyword">copy</span>和Strong的区别：<span class="keyword">copy</span>是创建一个新对象，Strong是创建一个指针。</div></pre></td></tr></table></figure>
<h4 id="49，SEL-和-IMP"><a href="#49，SEL-和-IMP" class="headerlink" title="49，SEL 和 IMP"></a>49，SEL 和 IMP</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">SEL: 其实是对方法的一种包装,将方法包装成一个SEL类型的数据,去寻找对应的方法地址,找到方法地址后</div><div class="line">就可以调用方法。这些都是运行时特性,发消息就是发送SEL,然后根据SEL找到地址,调用方法。</div><div class="line"></div><div class="line"></div><div class="line">IMP:  是”implementation”的缩写,它是objetive-C 方法 (method)实现代码块的地址,类似函数</div><div class="line">指针,通过它可以 直接访问任意一个方法。免去发送消息的代价。</div></pre></td></tr></table></figure>
<h4 id="50-self-和-super"><a href="#50-self-和-super" class="headerlink" title="50, self 和 super"></a>50, self 和 super</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">在动态方法中，<span class="keyword">self</span>代表着<span class="string">"对象"</span></div><div class="line">在静态方法中，<span class="keyword">self</span>代表着<span class="string">"类"</span></div><div class="line"></div><div class="line">万变不离其宗，记住一句话就行了：</div><div class="line"><span class="keyword">self</span>代表着当前方法的调用者<span class="keyword">self</span> 和 <span class="keyword">super</span> 是oc提供的 两个保留字, 但有根本区别，<span class="keyword">self</span>是类的隐藏的</div><div class="line">参数变量,指向当前调用方法的对象（类也是对象，类对象）</div><div class="line">另一个隐藏参数是_cmd，代表当前类方法的selector。</div><div class="line"></div><div class="line"><span class="keyword">super</span>并不是隐藏的参数,它只是一个<span class="string">"编译器指示符"</span></div><div class="line"><span class="keyword">super</span> 就是个障眼法 发，编译器符号， 它可以替换成 [<span class="keyword">self</span> <span class="keyword">class</span>],只不过 方法是从 <span class="keyword">self</span> 的</div><div class="line">超类开始寻找。</div></pre></td></tr></table></figure>
<h4 id="51-长连接-和-短连接"><a href="#51-长连接-和-短连接" class="headerlink" title="51, 长连接 和 短连接"></a>51, 长连接 和 短连接</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">长连接：（长连接在没有数据通信时，定时发送数据包(心跳)，以维持连接状态）</div><div class="line">连接→数据传输→保持连接(心跳)→数据传输→保持连接(心跳)→……→关闭连接；  </div><div class="line">长连接：连接服务器就不断开</div><div class="line"></div><div class="line">短连接：（短连接在没有数据传输时直接关闭就行了）</div><div class="line">连接→数据传输→关闭连接；</div><div class="line">短连接：连接上服务器，获取完数据，就立即断开。</div></pre></td></tr></table></figure>
<h4 id="52-HTTP-基本状态码"><a href="#52-HTTP-基本状态码" class="headerlink" title="52, HTTP 基本状态码"></a>52, HTTP 基本状态码</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="number">200</span> OK</div><div class="line">请求已成功，请求所希望的响应头或数据体将随此响应返回。</div><div class="line"></div><div class="line"><span class="number">300</span> Multiple Choices</div><div class="line">被请求的资源有一系列可供选择的回馈信息，每个都有自己特定的地址和浏览器驱动的商议信息。用户或浏览器能够自行选择一个首选的地址进行重定向。</div><div class="line"></div><div class="line"><span class="number">400</span> Bad Request</div><div class="line">由于包含语法错误，当前请求无法被服务器理解。除非进行修改，否则客户端不应该重复提交这个请求。</div><div class="line"></div><div class="line"><span class="number">404</span> Not Found</div><div class="line">请求失败，请求所希望得到的资源未被在服务器上发现。没有信息能够告诉用户这个状况到底是暂时的还是永久的。假如服务器知道情况的话，应当使用<span class="number">410</span>状态码来告知旧资源因为某些内部的配置机制问题，已经永久的不可用，而且没有任何可以跳转的地址。<span class="number">404</span>这个状态码被广泛应用于当服务器不想揭示到底为何请求被拒绝或者没有其他适合的响应可用的情况下。</div><div class="line"></div><div class="line"><span class="number">408</span> Request Timeout</div><div class="line">请求超时。客户端没有在服务器预备等待的时间内完成一个请求的发送。客户端可以随时再次提交这一请求而无需进行任何更改。</div><div class="line"></div><div class="line"><span class="number">500</span> Internal Server Error</div><div class="line">服务器遇到了一个未曾预料的状况，导致了它无法完成对请求的处理。一般来说，这个问题都会在服务器的程序码出错时出现。</div></pre></td></tr></table></figure>
<h4 id="53-TCP-和-UDP"><a href="#53-TCP-和-UDP" class="headerlink" title="53, TCP 和 UDP"></a>53, TCP 和 UDP</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">TCP：</div><div class="line"></div><div class="line">- 建立连接，形成传输数据的通道</div><div class="line">- 在连接中进行大数据传输（数据大小受限制）</div><div class="line">- 通过三次握手完成连接，是可靠协议</div><div class="line">- 必须建立连接，效率比UDP低</div><div class="line"></div><div class="line">UDP:</div><div class="line"></div><div class="line">- 只管发送，不管接受</div><div class="line">- 将数据以及源和目的封装成数据包中，不需要建立连接、</div><div class="line">- 每个数据报的大小限制在<span class="number">64</span>K之内</div><div class="line">- 不可靠协议</div><div class="line">- 速度快</div></pre></td></tr></table></figure>
<h4 id="54-三次握手和四次断开"><a href="#54-三次握手和四次断开" class="headerlink" title="54, 三次握手和四次断开"></a>54, 三次握手和四次断开</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">三次握手：</div><div class="line">你在吗-我在的-我问你个事情</div><div class="line">四次断开握手</div><div class="line">我这个问题问完了--你问完了吗---可以下线了吗---我真的问完了拜拜</div></pre></td></tr></table></figure>
<h4 id="55-设置按钮按下时候高亮"><a href="#55-设置按钮按下时候高亮" class="headerlink" title="55, 设置按钮按下时候高亮"></a>55, 设置按钮按下时候高亮</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">button.showsTouchWhenHighlighted=<span class="literal">YES</span>;</div></pre></td></tr></table></figure>
<h4 id="56-ScrollView莫名其妙不能在viewController划到顶怎么办？"><a href="#56-ScrollView莫名其妙不能在viewController划到顶怎么办？" class="headerlink" title="56, ScrollView莫名其妙不能在viewController划到顶怎么办？"></a>56, ScrollView莫名其妙不能在viewController划到顶怎么办？</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="keyword">self</span>.automaticallyAdjustsScrollViewInsets = <span class="literal">NO</span>;</div></pre></td></tr></table></figure>
<h4 id="57，复制字符串到iOS剪贴板"><a href="#57，复制字符串到iOS剪贴板" class="headerlink" title="57，复制字符串到iOS剪贴板"></a>57，复制字符串到iOS剪贴板</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="built_in">UIPasteboard</span> *pasteboard = [<span class="built_in">UIPasteboard</span> generalPasteboard];</div><div class="line">pasteboard.string = <span class="keyword">self</span>.label.text;</div></pre></td></tr></table></figure>
<h4 id="58，线程租调度事例"><a href="#58，线程租调度事例" class="headerlink" title="58，线程租调度事例"></a>58，线程租调度事例</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">//  群组－统一监控一组任务</span></div><div class="line">dispatch_group_t group = dispatch_group_create();</div><div class="line"></div><div class="line"><span class="built_in">dispatch_queue_t</span> q = dispatch_get_global_queue(<span class="number">0</span>, <span class="number">0</span>);</div><div class="line"><span class="comment">// 添加任务</span></div><div class="line"><span class="comment">// group 负责监控任务，queue 负责调度任务</span></div><div class="line">dispatch_group_async(group, q, ^&#123;</div><div class="line">[<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">1.0</span>];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"任务1 %@"</span>, [<span class="built_in">NSThread</span> currentThread]);</div><div class="line">&#125;);</div><div class="line">dispatch_group_async(group, q, ^&#123;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"任务2 %@"</span>, [<span class="built_in">NSThread</span> currentThread]);</div><div class="line">&#125;);</div><div class="line">dispatch_group_async(group, q, ^&#123;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"任务3 %@"</span>, [<span class="built_in">NSThread</span> currentThread]);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 监听所有任务完成 － 等到 group 中的所有任务执行完毕后，"由队列调度 block 中的任务异步执行！"</span></div><div class="line">dispatch_group_notify(group, dispatch_get_main_queue(), ^&#123;</div><div class="line"><span class="comment">// 修改为主队列，后台批量下载，结束后，主线程统一更新UI</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"OK %@"</span>, [<span class="built_in">NSThread</span> currentThread]);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"come here"</span>);</div></pre></td></tr></table></figure>
<h4 id="59、视图坐标转换"><a href="#59、视图坐标转换" class="headerlink" title="59、视图坐标转换"></a>59、视图坐标转换</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">// 将像素point由point所在视图转换到目标视图view中，返回在目标视图view中的像素值</span></div><div class="line">- (<span class="built_in">CGPoint</span>)convertPoint:(<span class="built_in">CGPoint</span>)point toView:(<span class="built_in">UIView</span> *)view;</div><div class="line"><span class="comment">// 将像素point从view中转换到当前视图中，返回在当前视图中的像素值</span></div><div class="line">- (<span class="built_in">CGPoint</span>)convertPoint:(<span class="built_in">CGPoint</span>)point fromView:(<span class="built_in">UIView</span> *)view;</div><div class="line"></div><div class="line"><span class="comment">// 将rect由rect所在视图转换到目标视图view中，返回在目标视图view中的rect</span></div><div class="line">- (<span class="built_in">CGRect</span>)convertRect:(<span class="built_in">CGRect</span>)rect toView:(<span class="built_in">UIView</span> *)view;</div><div class="line"><span class="comment">// 将rect从view中转换到当前视图中，返回在当前视图中的rect</span></div><div class="line">- (<span class="built_in">CGRect</span>)convertRect:(<span class="built_in">CGRect</span>)rect fromView:(<span class="built_in">UIView</span> *)view;</div><div class="line"></div><div class="line"><span class="comment">// 例把UITableViewCell中的subview(btn)的frame转换到controllerA中</span></div><div class="line"><span class="comment">// controllerA 中有一个UITableView, UITableView里有多行UITableVieCell，cell上放有一个button</span></div><div class="line"><span class="comment">// 在controllerA中实现:</span></div><div class="line"><span class="built_in">CGRect</span> rc = [cell convertRect:cell.btn.frame toView:<span class="keyword">self</span>.view];</div><div class="line"><span class="comment">//或</span></div><div class="line"><span class="built_in">CGRect</span> rc = [<span class="keyword">self</span>.view convertRect:cell.btn.frame fromView:cell];</div><div class="line"><span class="comment">// 此rc为btn在controllerA中的rect</span></div><div class="line"></div><div class="line"><span class="comment">//或当已知btn时：</span></div><div class="line"><span class="built_in">CGRect</span> rc = [btn.superview convertRect:btn.frame toView:<span class="keyword">self</span>.view];</div><div class="line"><span class="comment">//或</span></div><div class="line"><span class="built_in">CGRect</span> rc = [<span class="keyword">self</span>.view convertRect:btn.frame fromView:btn.superview];</div></pre></td></tr></table></figure>
<h4 id="60、设置animation动画终了，不返回初始状态"><a href="#60、设置animation动画终了，不返回初始状态" class="headerlink" title="60、设置animation动画终了，不返回初始状态"></a>60、设置animation动画终了，不返回初始状态</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">animation.removedOnCompletion = <span class="literal">NO</span>;</div><div class="line">animation.fillMode = kCAFillModeForwards;</div></pre></td></tr></table></figure>
<h4 id="61、UIViewAnimationOptions类型"><a href="#61、UIViewAnimationOptions类型" class="headerlink" title="61、UIViewAnimationOptions类型"></a>61、UIViewAnimationOptions类型</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="number">1.</span>常规动画属性设置（可以同时选择多个进行设置）</div><div class="line"><span class="built_in">UIViewAnimationOptionLayoutSubviews</span>：动画过程中保证子视图跟随运动。</div><div class="line"><span class="built_in">UIViewAnimationOptionAllowUserInteraction</span>：动画过程中允许用户交互。</div><div class="line"><span class="built_in">UIViewAnimationOptionBeginFromCurrentState</span>：所有视图从当前状态开始运行。</div><div class="line"><span class="built_in">UIViewAnimationOptionRepeat</span>：重复运行动画。</div><div class="line"><span class="built_in">UIViewAnimationOptionAutoreverse</span> ：动画运行到结束点后仍然以动画方式回到初始点。</div><div class="line"><span class="built_in">UIViewAnimationOptionOverrideInheritedDuration</span>：忽略嵌套动画时间设置。</div><div class="line"><span class="built_in">UIViewAnimationOptionOverrideInheritedCurve</span>：忽略嵌套动画速度设置。</div><div class="line"><span class="built_in">UIViewAnimationOptionAllowAnimatedContent</span>：动画过程中重绘视图（注意仅仅适用于转场动画）。  </div><div class="line"><span class="built_in">UIViewAnimationOptionShowHideTransitionViews</span>：视图切换时直接隐藏旧视图、显示新视图，而不是将旧视图从父视图移除（仅仅适用于转场动画）<span class="built_in">UIViewAnimationOptionOverrideInheritedOptions</span> ：不继承父动画设置或动画类型。</div><div class="line"><span class="number">2.</span>动画速度控制（可从其中选择一个设置）</div><div class="line"><span class="built_in">UIViewAnimationOptionCurveEaseInOut</span>：动画先缓慢，然后逐渐加速。</div><div class="line"><span class="built_in">UIViewAnimationOptionCurveEaseIn</span> ：动画逐渐变慢。</div><div class="line"><span class="built_in">UIViewAnimationOptionCurveEaseOut</span>：动画逐渐加速。</div><div class="line"><span class="built_in">UIViewAnimationOptionCurveLinear</span> ：动画匀速执行，默认值。</div><div class="line"><span class="number">3.</span>转场类型（仅适用于转场动画设置，可以从中选择一个进行设置，基本动画、关键帧动画不需要设置）</div><div class="line"><span class="built_in">UIViewAnimationOptionTransitionNone</span>：没有转场动画效果。</div><div class="line"><span class="built_in">UIViewAnimationOptionTransitionFlipFromLeft</span> ：从左侧翻转效果。</div><div class="line"><span class="built_in">UIViewAnimationOptionTransitionFlipFromRight</span>：从右侧翻转效果。</div><div class="line"><span class="built_in">UIViewAnimationOptionTransitionCurlUp</span>：向后翻页的动画过渡效果。    </div><div class="line"><span class="built_in">UIViewAnimationOptionTransitionCurlDown</span> ：向前翻页的动画过渡效果。    </div><div class="line"><span class="built_in">UIViewAnimationOptionTransitionCrossDissolve</span>：旧视图溶解消失显示下一个新视图的效果。    </div><div class="line"><span class="built_in">UIViewAnimationOptionTransitionFlipFromTop</span> ：从上方翻转效果。    </div><div class="line"><span class="built_in">UIViewAnimationOptionTransitionFlipFromBottom</span>：从底部翻转效果。</div></pre></td></tr></table></figure>
<h4 id="62、获取当前View所在的控制器"><a href="#62、获取当前View所在的控制器" class="headerlink" title="62、获取当前View所在的控制器"></a>62、获取当前View所在的控制器</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">/** 获取当前View所在的控制器*/</span></div><div class="line">-(<span class="built_in">UIViewController</span> *)getCurrentViewController&#123;</div><div class="line">    <span class="built_in">UIResponder</span> *next = [<span class="keyword">self</span> nextResponder];</div><div class="line">    <span class="keyword">do</span> &#123;</div><div class="line">        <span class="keyword">if</span> ([next isKindOfClass:[<span class="built_in">UIViewController</span> <span class="keyword">class</span>]]) &#123;</div><div class="line">            <span class="keyword">return</span> (<span class="built_in">UIViewController</span> *)next;</div><div class="line">        &#125;</div><div class="line">        next = [next nextResponder];</div><div class="line">    &#125; <span class="keyword">while</span> (next != <span class="literal">nil</span>); </div><div class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="63、iOS横向滚动的scrollView和系统pop手势返回冲突的解决办法"><a href="#63、iOS横向滚动的scrollView和系统pop手势返回冲突的解决办法" class="headerlink" title="63、iOS横向滚动的scrollView和系统pop手势返回冲突的解决办法"></a>63、iOS横向滚动的scrollView和系统pop手势返回冲突的解决办法</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">- (<span class="built_in">BOOL</span>)gestureRecognizer:(<span class="built_in">UIGestureRecognizer</span> *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(<span class="built_in">UIGestureRecognizer</span> *)otherGestureRecognizer&#123;</div><div class="line">    <span class="comment">// 首先判断otherGestureRecognizer是不是系统pop手势</span></div><div class="line">    <span class="keyword">if</span> ([otherGestureRecognizer.view isKindOfClass:<span class="built_in">NSClassFromString</span>(<span class="string">@"UILayoutContainerView"</span>)]) &#123;</div><div class="line">        <span class="comment">// 再判断系统手势的state是began还是fail，同时判断scrollView的位置是不是正好在最左边</span></div><div class="line">        <span class="keyword">if</span> (otherGestureRecognizer.state == <span class="built_in">UIGestureRecognizerStateBegan</span> &amp;&amp; <span class="keyword">self</span>.contentOffset.x == <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="64、设置状态栏方向位置"><a href="#64、设置状态栏方向位置" class="headerlink" title="64、设置状态栏方向位置"></a>64、设置状态栏方向位置</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">//修改状态栏方向，</span></div><div class="line">[<span class="built_in">UIApplication</span> sharedApplication].statusBarOrientation = <span class="built_in">UIInterfaceOrientationLandscapeLeft</span>;</div><div class="line"></div><div class="line"><span class="comment">//枚举值说明：</span></div><div class="line"><span class="built_in">UIDeviceOrientationPortraitUpsideDown</span>,  <span class="comment">//设备直立，home按钮在上</span></div><div class="line"><span class="built_in">UIDeviceOrientationLandscapeLeft</span>,       <span class="comment">//设备横置，home按钮在右</span></div><div class="line"><span class="built_in">UIDeviceOrientationLandscapeRight</span>,      <span class="comment">//设备横置, home按钮在左</span></div><div class="line"><span class="built_in">UIDeviceOrientationFaceUp</span>,              <span class="comment">//设备平放，屏幕朝上</span></div><div class="line"><span class="built_in">UIDeviceOrientationFaceDown</span>             <span class="comment">//设备平放，屏幕朝下</span></div><div class="line"></div><div class="line"><span class="comment">//再实现这个代理方法就行了</span></div><div class="line">- (<span class="built_in">BOOL</span>)shouldAutorotate&#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">NO</span>; <span class="comment">//必须返回no, 才能强制手动旋转</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="65，Git-关联仓库-和基本配置"><a href="#65，Git-关联仓库-和基本配置" class="headerlink" title="65，Git 关联仓库 ,和基本配置"></a>65，Git 关联仓库 ,和基本配置</h4><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">-------Git global setup-------</div><div class="line"></div><div class="line">git config --global user.name <span class="string">"xinnyu"</span></div><div class="line">git config --global user.email <span class="string">"xinnyu007@gmail.com"</span></div><div class="line"></div><div class="line">-------Create a new repository-------</div><div class="line">git <span class="built_in">clone</span> git@gitlab.testAddress.com:<span class="built_in">test</span>/QRZxing.git</div><div class="line"><span class="built_in">cd</span> QRZxing</div><div class="line">touch README.md</div><div class="line">git add README.mdgit commit -m <span class="string">"add README"</span></div><div class="line">git push -u origin master</div><div class="line"></div><div class="line">-------Existing folder or Git repository-------</div><div class="line"><span class="built_in">cd</span> existing_folder</div><div class="line">git init</div><div class="line">git remote add origin git@gitlab.testAddress.com:<span class="built_in">test</span>/QRZxing.git</div><div class="line">git add .</div><div class="line">git commit</div><div class="line">git push -u origin master</div></pre></td></tr></table></figure>
<h4 id="66，Git-命令大全"><a href="#66，Git-命令大全" class="headerlink" title="66，Git 命令大全"></a>66，Git 命令大全</h4><p><img src="http://upload-images.jianshu.io/upload_images/790890-2233c59924c77b95.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="1234.png"></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2017/04/14/Pyinstaller将python脚本打包成可执行文件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/14/Pyinstaller将python脚本打包成可执行文件/" itemprop="url">
                  Pyinstaller将python脚本打包成可执行文件
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-14T01:00:08+08:00">
                2017-04-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/04/14/Pyinstaller将python脚本打包成可执行文件/" class="leancloud_visitors" data-flag-title="Pyinstaller将python脚本打包成可执行文件">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://github.com/pyinstaller/pyinstaller/" target="_blank" rel="external">PyInstaller</a>可以用来打包Python应用程序，把Python脚本和所用到的库打包为exe文件，可以更方便的发布程序，避免使用程序的每个电脑都必须安装Python，这样，打包完的程序就可以在没有安装Python解释器的机器上运行了。</p>
<h4 id="安装Pyinstaller"><a href="#安装Pyinstaller" class="headerlink" title="安装Pyinstaller"></a>安装Pyinstaller</h4><p>使用pip或者easy_install来安装：<br><code>sudo pip install pyinstaller</code></p>
<h4 id="使用PyInstaller"><a href="#使用PyInstaller" class="headerlink" title="使用PyInstaller"></a>使用PyInstaller</h4><p><code>pyinstaller myapp.py</code></p>
<p>当使用PyInstaller打包的时候，默认生成一个文件夹，文件夹中包含所有依赖项，以及可执行文件。打包成文件夹的好处就是debug的时候可以清楚的看到依赖项有没有包含。另一个好处是更新的时候，只需要更新可执行文件就可以了。当然缺点也很明显，不方便，不易管理。</p>
<p>那么它是如何工作的呢？PyInstaller的引导程序是一个二进制可执行程序。当用户启动你的程序的时候，PyInstaller的引导程序开始运行，首先创建一个临时的Python环境，然后通过Python解释器导入程序的依赖，当然它们都在同一个文件夹下。</p>
<h6 id="打包成一个文件"><a href="#打包成一个文件" class="headerlink" title="打包成一个文件"></a>打包成一个文件</h6><p>我们可以用onefile参数将所有文件打包到一个可执行文件中。</p>
<p><code>pyinstaller --onefile myapp.py</code></p>
<p>打包成一个文件相对于文件夹更容易管理。坏处运行相对比较慢。这个文件中包含了压缩的依赖文件拷贝（.so文件-Linux，dll文件-Windows）。</p>
<p>当程序运行时，PyInstaller的引导程序会新建一个临时文件夹。然后解压程序的第三方依赖文件到临时文件夹中。这也是为什么一个可执行文件比文件夹中执行的时间要长的原因。剩下的就和上面的一样了。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>所以，我们要通过PyInstaller生成可执行的文件主要下面两步。</p>
<p><code>pyinstaller [option] myapp.py</code></p>
<p>option为空生成文件夹，选择onefile，生成一个文件。</p>
<p>如果项目有一些依赖的数据文件，上面生成的二进制文件是无法运行的，这个时候可以通过生成spec文件，而后再用pyinstaller运行spec文件。</p>
<p><code>pyinstaller [option] myapp.spec</code></p>
<p><strong><em>最后有个坑就是目前最新版本的pyinstaller 3.2.1 不支持 python3.6。</em></strong></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2017/04/13/Xcode不自动补全问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/04/13/Xcode不自动补全问题/" itemprop="url">
                  Xcode不自动补全问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-13T21:24:36+08:00">
                2017-04-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/04/13/Xcode不自动补全问题/" class="leancloud_visitors" data-flag-title="Xcode不自动补全问题">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-要import-pods里的头文件"><a href="#1-要import-pods里的头文件" class="headerlink" title="1.要import pods里的头文件"></a>1.要import pods里的头文件</h3><p>有时候XCode搜索头文件不会去搜索Pods里的第三方库，我们需要在XCode里设置一下项目Target的Search Paths。</p>
<p>双击User Header Search Paths的空白处，填入”$(PODS_ROOT)”(没有引号), 设置为递归的搜索recursive，问题解决了。</p>
<h3 id="2-XCode自带BUG"><a href="#2-XCode自带BUG" class="headerlink" title="2.XCode自带BUG"></a>2.XCode自带BUG</h3><p>有些时候我们没有调用第三方库，发现UIkit的自动补全都没法触发了，这样的原因多半是因为XCode自带BUG，在你的注释里有中文的时候，不会触发自动补全，比如这个’年’，删掉过后再编译一下试试，再不行就重启一下XCode。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2017/01/30/基础算法(堆排序)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/01/30/基础算法(堆排序)/" itemprop="url">
                  基础算法(堆排序)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-01-30T14:32:05+08:00">
                2017-01-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/01/30/基础算法(堆排序)/" class="leancloud_visitors" data-flag-title="基础算法(堆排序)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://zh.wikipedia.org/wiki/%E5%A0%86%E6%8E%92%E5%BA%8F" target="_blank" rel="external">堆排序（Heapsort）</a>是指利用堆这种数据结构所设计的一种排序算法。堆积是一个近似完全二叉树的结构，并同时满足堆积的性质：即子结点的键值或索引总是小于（或者大于）它的父节点。</p>
<h4 id="算法步骤"><a href="#算法步骤" class="headerlink" title="算法步骤"></a>算法步骤</h4><ol>
<li><p>先将初始文件Array[1..n]建成一个大根堆，此堆为初始的无序区。</p>
</li>
<li><p>再将关键字最大的记录Array[1]（即堆顶）和无序区的最后一个记录Array[n]交换，由此得到新的无序区Array[1..n-1]和有序区Array[n]，然后再把无序区建成一个大根堆，然后再次将Array[1..n-1]中关键字最大的记录Array[1]和该区间的最后一个记录Array[n-1]交换.</p>
</li>
</ol>
<p>下面是算法的Swift实现:</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">/// 将Array中的index位置堆化</span></div><div class="line"><span class="comment">///</span></div><div class="line"><span class="comment">/// - Parameters:</span></div><div class="line"><span class="comment">///   - array: 数组</span></div><div class="line"><span class="comment">///   - index: 位置</span></div><div class="line"><span class="comment">///   - end: 数组的最后位置</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">maxHeapify</span><span class="params">(array: <span class="keyword">inout</span> [Int], index:Int, end:Int)</span></span>&#123;</div><div class="line">    <span class="keyword">var</span> parentIndex = index</div><div class="line">    <span class="keyword">var</span> endIndex = end</div><div class="line">    </div><div class="line">    <span class="keyword">while</span> <span class="literal">true</span> &#123;</div><div class="line">        <span class="keyword">var</span> leftChildIndex = parentIndex * <span class="number">2</span> + <span class="number">1</span></div><div class="line">        <span class="keyword">var</span> rightChildIndex = leftChildIndex + <span class="number">1</span></div><div class="line">        </div><div class="line">        <span class="keyword">var</span> childIndex = leftChildIndex</div><div class="line">        <span class="keyword">if</span> childIndex &gt; endIndex &#123;</div><div class="line">            <span class="keyword">break</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> childIndex + <span class="number">1</span> &lt;= endIndex &amp;&amp; array[leftChildIndex] &lt; array[rightChildIndex] &#123;</div><div class="line">            childIndex += <span class="number">1</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> array[parentIndex] &lt; array[childIndex]&#123;</div><div class="line">            <span class="built_in">swap</span>(&amp;array[childIndex], &amp;array[parentIndex])</div><div class="line">            parentIndex = childIndex</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">break</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/// 创建大根堆</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">creatMaxHeap</span><span class="params">(array: <span class="keyword">inout</span> [Int])</span></span>&#123;</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> (<span class="number">0</span>...(array.<span class="built_in">count</span> - <span class="number">1</span>) / <span class="number">2</span>).reversed()&#123;</div><div class="line">        maxHeapify(array: &amp;array, index: i, end: array.<span class="built_in">count</span> - <span class="number">1</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/// 堆排序</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">heapSort</span><span class="params">(array: <span class="keyword">inout</span> [Int])</span></span>&#123;</div><div class="line">    creatMaxHeap(array: &amp;array)</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> (<span class="number">0</span>...array.<span class="built_in">count</span> - <span class="number">1</span>).reversed()&#123;</div><div class="line">        <span class="keyword">if</span> i != <span class="number">0</span>&#123;</div><div class="line">            <span class="built_in">swap</span>(&amp;array[<span class="number">0</span>], &amp;array[i])</div><div class="line">        &#125;</div><div class="line">        maxHeapify(array: &amp;array, index: <span class="number">0</span>, end: i - <span class="number">1</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2017/01/29/基础算法(快速排序)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/01/29/基础算法(快速排序)/" itemprop="url">
                  基础算法(快速排序)
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-01-29T14:52:05+08:00">
                2017-01-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/01/29/基础算法(快速排序)/" class="leancloud_visitors" data-flag-title="基础算法(快速排序)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="https://zh.wikipedia.org/wiki/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F" target="_blank" rel="external">Quicksort</a>又称划分交换排序，最早由东尼·霍尔提出。在平均状况下，排序n个项目要Ο(n log n)次比较。在最坏状况下则需要Ο(n2)次比较，但这种状况并不常见。事实上，快速排序通常明显比其他Ο(n log n)算法更快，因为它的内部循环（inner loop）可以在大部分的架构上很有效率地被实现出来。</p>
<p>快速排序使用分治法（Divide and conquer）策略来把一个串行（list）分为两个子串行（sub-lists）。</p>
<h4 id="算法步骤"><a href="#算法步骤" class="headerlink" title="算法步骤"></a>算法步骤</h4><ol>
<li>从数列中挑出一个元素，称为 “基准”（pivot），</li>
<li>重新排序数列，所有元素比基准值小的摆放在基准前面，所有元素比基准值大的摆在基准的后面（相同的数可以到任一边）。在这个分区退出之后，该基准就处于数列的中间位置。这个称为分区（partition）操作。</li>
<li>递归地（recursive）把小于基准值元素的子数列和大于基准值元素的子数列排序。</li>
</ol>
<p>递归的最底部情形，是数列的大小是零或一，也就是永远都已经被排序好了。虽然一直递归下去，但是这个算法总会退出，因为在每次的迭代（iteration）中，它至少会把一个元素摆到它最后的位置去。</p>
<h4 id="Swift代码"><a href="#Swift代码" class="headerlink" title="Swift代码"></a>Swift代码</h4><p>由上面的步骤我们可以写出一个简单的快排算法：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">quickSortSimple</span><span class="params">(array:[Int])</span></span> -&gt; [<span class="type">Int</span>]&#123;</div><div class="line">    <span class="keyword">if</span> array.<span class="built_in">count</span> &lt;= <span class="number">1</span> &#123;</div><div class="line">        <span class="keyword">return</span> array</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> lowArray = [<span class="type">Int</span>](), highArray = [<span class="type">Int</span>]()</div><div class="line">    <span class="keyword">var</span> pivot = array.first!</div><div class="line">    </div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...array.<span class="built_in">count</span> - <span class="number">1</span>&#123;</div><div class="line">        <span class="keyword">let</span> num = array[i]</div><div class="line">        <span class="keyword">if</span> num &gt; pivot&#123;</div><div class="line">            highArray.append(num)</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            lowArray.append(num)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> result = quickSortSimple(array: lowArray)</div><div class="line">    result.append(pivot)</div><div class="line">    <span class="keyword">let</span> highResult = quickSortSimple(array: highArray)</div><div class="line">    result.append(contentsOf: highResult)</div><div class="line">    <span class="keyword">return</span> result</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>上面简单版本有个缺点，就是它需要Ω(n)的额外存储空间。额外需要的存储器空间配置，在实际上的实现，也会极度影响速度和缓存的性能。有一个比较复杂使用原地（in-place）分区算法的版本如下:</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">//用于将</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">partition</span><span class="params">(a: <span class="keyword">inout</span> [Int],low:Int,high:Int)</span></span> -&gt; <span class="type">Int</span>&#123;</div><div class="line">    <span class="keyword">if</span> low &gt;= high&#123;</div><div class="line">        <span class="keyword">return</span> low</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">let</span> pivot = a[low]</div><div class="line">    <span class="keyword">var</span> i = low, j = high</div><div class="line">    <span class="keyword">while</span> i &lt; j &#123;</div><div class="line">        <span class="keyword">while</span> i &lt; j &amp;&amp; a[j] &gt;= pivot &#123;</div><div class="line">            j -= <span class="number">1</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">while</span> i &lt; j &amp;&amp; a[i] &lt;= pivot &#123;</div><div class="line">            i += <span class="number">1</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> i &lt; j &#123;</div><div class="line">            <span class="built_in">swap</span>(&amp;a[i], &amp;a[j])</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> i != low&#123;</div><div class="line">        <span class="built_in">swap</span>(&amp;a[i], &amp;a[low])</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> i</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">quickSort</span><span class="params">(array: <span class="keyword">inout</span> [Int], low:Int, high:Int)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> low &gt; high&#123;</div><div class="line">        <span class="keyword">return</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">let</span> index = <span class="built_in">partition</span>(a: &amp;array, low: low, high: high)</div><div class="line">    <span class="built_in">quickSort</span>(array: &amp;array, low: low, high: index - <span class="number">1</span>)</div><div class="line">    <span class="built_in">quickSort</span>(array: &amp;array, low: index + <span class="number">1</span>, high: high)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2016/12/24/iOS,Mac著名开发者博客/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/12/24/iOS,Mac著名开发者博客/" itemprop="url">
                  iOS,Mac著名开发者博客
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-12-24T12:17:25+08:00">
                2016-12-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2016/12/24/iOS,Mac著名开发者博客/" class="leancloud_visitors" data-flag-title="iOS,Mac著名开发者博客">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <table>
<thead>
<tr>
<th>博客地址</th>
<th>RSS地址</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://onevcat.com" target="_blank" rel="external">OneV’s Den</a></td>
<td><a href="http://onevcat.com/atom.xml" target="_blank" rel="external">http://onevcat.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://blog.ibireme.com/" target="_blank" rel="external">一只魔法师的工坊</a></td>
<td><a href="http://blog.ibireme.com/feed/" target="_blank" rel="external">http://blog.ibireme.com/feed/</a></td>
</tr>
<tr>
<td><a href="http://beyondvincent.com" target="_blank" rel="external">破船之家</a></td>
<td><a href="http://beyondvincent.com/atom.xml" target="_blank" rel="external">http://beyondvincent.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://nshipster.cn" target="_blank" rel="external">NSHipster</a></td>
<td><a href="http://nshipster.cn/feed.xml" target="_blank" rel="external">http://nshipster.cn/feed.xml</a></td>
</tr>
<tr>
<td><a href="http://limboy.me/" target="_blank" rel="external">Limboy 无网不剩</a></td>
<td><a href="http://feeds.feedburner.com/lzyy" target="_blank" rel="external">http://feeds.feedburner.com/lzyy</a></td>
</tr>
<tr>
<td><a href="http://blog.devtang.com" target="_blank" rel="external">唐巧的技术博客</a></td>
<td><a href="http://blog.devtang.com/atom.xml" target="_blank" rel="external">http://blog.devtang.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://wufawei.com/" target="_blank" rel="external">Ted’s Homepage</a></td>
<td><a href="http://wufawei.com/feed" target="_blank" rel="external">http://wufawei.com/feed</a></td>
</tr>
<tr>
<td><a href="http://blog.sunnyxx.com/" target="_blank" rel="external">sunnyxx的技术博客</a></td>
<td><a href="http://blog.sunnyxx.com/atom.xml" target="_blank" rel="external">http://blog.sunnyxx.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://zhowkev.in" target="_blank" rel="external">Kevin Blog</a></td>
<td><a href="http://zhowkev.in/rss" target="_blank" rel="external">http://zhowkev.in/rss</a></td>
</tr>
<tr>
<td><a href="http://www.xiangwangfeng.com" target="_blank" rel="external">阿毛的蛋疼地</a></td>
<td><a href="http://www.xiangwangfeng.com/atom.xml" target="_blank" rel="external">http://www.xiangwangfeng.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://billwang1990.github.io" target="_blank" rel="external">亚庆的 Blog</a></td>
<td><a href="http://billwang1990.github.io/atom.xml" target="_blank" rel="external">http://billwang1990.github.io/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://nonomori.farbox.com" target="_blank" rel="external">Nonomori</a></td>
<td><a href="http://nonomori.farbox.com/feed" target="_blank" rel="external">http://nonomori.farbox.com/feed</a></td>
</tr>
<tr>
<td><a href="http://wonderffee.github.io" target="_blank" rel="external">Wonderffee’s Blog</a></td>
<td><a href="http://wonderffee.github.io/atom.xml" target="_blank" rel="external">http://wonderffee.github.io/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://imtx.me" target="_blank" rel="external">I’m TualatriX</a></td>
<td><a href="http://imtx.me/feed/latest/" target="_blank" rel="external">http://imtx.me/feed/latest/</a></td>
</tr>
<tr>
<td><a href="http://blog.cocoabit.com" target="_blank" rel="external">Cocoabit</a></td>
<td><a href="http://blog.cocoabit.com/rss/" target="_blank" rel="external">http://blog.cocoabit.com/rss/</a></td>
</tr>
<tr>
<td><a href="http://studentdeng.github.io" target="_blank" rel="external">不会开机的男孩</a></td>
<td><a href="http://studentdeng.github.io/atom.xml" target="_blank" rel="external">http://studentdeng.github.io/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://blog.inico.me" target="_blank" rel="external">Nico</a></td>
<td><a href="http://blog.inico.me/atom.xml" target="_blank" rel="external">http://blog.inico.me/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://hufeng825.github.io" target="_blank" rel="external">阿峰的技术窝窝</a></td>
<td><a href="http://hufeng825.github.io/atom.xml" target="_blank" rel="external">http://hufeng825.github.io/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://answerhuang.duapp.com" target="_blank" rel="external">answer_huang</a></td>
<td><a href="http://answerhuang.duapp.com/index.php/feed/" target="_blank" rel="external">http://answerhuang.duapp.com/index.php/feed/</a></td>
</tr>
<tr>
<td><a href="http://blog.nswebfrog.com/" target="_blank" rel="external">webfrogs</a></td>
<td><a href="http://blog.nswebfrog.com/feed/" target="_blank" rel="external">http://blog.nswebfrog.com/feed/</a></td>
</tr>
<tr>
<td><a href="http://joeyio.com" target="_blank" rel="external">代码手工艺人</a></td>
<td><a href="http://joeyio.com/atom.xml" target="_blank" rel="external">http://joeyio.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://gracelancy.com" target="_blank" rel="external">Lancy’s Blog</a></td>
<td><a href="http://gracelancy.com/atom.xml" target="_blank" rel="external">http://gracelancy.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://www.imallen.com" target="_blank" rel="external">I’m Allen</a></td>
<td><a href="http://www.imallen.com/atom.xml" target="_blank" rel="external">http://www.imallen.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://imi.im/" target="_blank" rel="external">Travis’ Blog</a></td>
<td><a href="http://imi.im/feed" target="_blank" rel="external">http://imi.im/feed</a></td>
</tr>
<tr>
<td><a href="http://wangzz.github.io/" target="_blank" rel="external">王中周的技术博客</a></td>
<td><a href="http://wangzz.github.io/atom.xml" target="_blank" rel="external">http://wangzz.github.io/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://wangkewei.cnblogs.com/" target="_blank" rel="external">克伟的博客</a></td>
<td><a href="http://feed.cnblogs.com/blog/u/23857/rss" target="_blank" rel="external">http://feed.cnblogs.com/blog/u/23857/rss</a></td>
</tr>
<tr>
<td><a href="http://cnblogs.com/biosli" target="_blank" rel="external">摇滚诗人</a></td>
<td><a href="http://feed.cnblogs.com/blog/u/35410/rss" target="_blank" rel="external">http://feed.cnblogs.com/blog/u/35410/rss</a></td>
</tr>
<tr>
<td><a href="http://geeklu.com/" target="_blank" rel="external">Luke’s Homepage</a></td>
<td><a href="http://geeklu.com/feed/" target="_blank" rel="external">http://geeklu.com/feed/</a></td>
</tr>
<tr>
<td><a href="http://iiiyu.com/" target="_blank" rel="external">萧宸宇</a></td>
<td><a href="http://iiiyu.com/atom.xml" target="_blank" rel="external">http://iiiyu.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://www.heyuan110.com/" target="_blank" rel="external">Yuan博客</a></td>
<td><a href="http://www.heyuan110.com/?feed=rss2" target="_blank" rel="external">http://www.heyuan110.com/?feed=rss2</a></td>
</tr>
<tr>
<td><a href="http://koofrank.com/" target="_blank" rel="external">KooFrank’s Blog</a></td>
<td><a href="http://koofrank.com/rss" target="_blank" rel="external">http://koofrank.com/rss</a></td>
</tr>
<tr>
<td><a href="http://helloitworks.com" target="_blank" rel="external">hello it works</a></td>
<td><a href="http://helloitworks.com/feed" target="_blank" rel="external">http://helloitworks.com/feed</a></td>
</tr>
<tr>
<td><a href="http://msching.github.io/" target="_blank" rel="external">码农人生</a></td>
<td><a href="http://msching.github.io/atom.xml" target="_blank" rel="external">http://msching.github.io/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://yulingtianxia.com" target="_blank" rel="external">玉令天下的Blog</a></td>
<td><a href="http://yulingtianxia.com/atom.xml" target="_blank" rel="external">http://yulingtianxia.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://www.hotobear.com/" target="_blank" rel="external">不掏蜂窝的熊</a></td>
<td><a href="http://www.hotobear.com/?feed=rss2" target="_blank" rel="external">http://www.hotobear.com/?feed=rss2</a></td>
</tr>
<tr>
<td><a href="https://andelf.github.io/" target="_blank" rel="external">猫·仁波切</a></td>
<td><a href="https://andelf.github.io/atom.xml" target="_blank" rel="external">https://andelf.github.io/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://ivoryxiong.org/" target="_blank" rel="external">煲仔饭</a></td>
<td><a href="http://ivoryxiong.org/feed.xml" target="_blank" rel="external">http://ivoryxiong.org/feed.xml</a></td>
</tr>
<tr>
<td><a href="http://adad184.com" target="_blank" rel="external">里脊串的开发随笔</a></td>
<td><a href="http://adad184.com/atom.xml" target="_blank" rel="external">http://adad184.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://blog.callmewhy.com/" target="_blank" rel="external">Why’s blog - 汪海的实验室</a></td>
<td><a href="http://blog.callmewhy.com/atom.xml" target="_blank" rel="external">http://blog.callmewhy.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://tutuge.me/" target="_blank" rel="external">土土哥的技术Blog</a></td>
<td><a href="http://tutuge.me/atom.xml" target="_blank" rel="external">http://tutuge.me/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://www.olinone.com/" target="_blank" rel="external">庞海礁的个人空间 </a></td>
<td><a href="http://www.olinone.com/?feed=rss2" target="_blank" rel="external">http://www.olinone.com/?feed=rss2</a></td>
</tr>
<tr>
<td><a href="http://casatwy.com/" target="_blank" rel="external">Casa Taloyum</a></td>
<td><a href="http://casatwy.com/feeds/all.atom.xml" target="_blank" rel="external">http://casatwy.com/feeds/all.atom.xml</a></td>
</tr>
<tr>
<td><a href="http://www.cnblogs.com/kenshincui/" target="_blank" rel="external">Kenshin Cui’s Blog</a></td>
<td><a href="http://www.cnblogs.com/kenshincui/rss" target="_blank" rel="external">http://www.cnblogs.com/kenshincui/rss</a></td>
</tr>
<tr>
<td><a href="http://suenblog.duapp.com/" target="_blank" rel="external">技术哥的博客</a></td>
<td><a href="http://suenblog.duapp.com/rss/" target="_blank" rel="external">http://suenblog.duapp.com/rss/</a></td>
</tr>
<tr>
<td><a href="http://www.tanhao.me/" target="_blank" rel="external">老谭笔记</a></td>
<td><a href="http://www.tanhao.me/atom.xml" target="_blank" rel="external">http://www.tanhao.me/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://www.coderyi.com/" target="_blank" rel="external">coderyi</a></td>
<td><a href="http://www.coderyi.com/feed" target="_blank" rel="external">http://www.coderyi.com/feed</a></td>
</tr>
<tr>
<td><a href="http://blog.leichunfeng.com" target="_blank" rel="external">雷纯锋的技术博客</a></td>
<td><a href="http://blog.leichunfeng.com/atom.xml" target="_blank" rel="external">http://blog.leichunfeng.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://www.iosxxx.com/" target="_blank" rel="external">向晨宇的技术博客</a></td>
<td><a href="http://iosxxx.com/atom.xml" target="_blank" rel="external">http://iosxxx.com/atom.xml</a></td>
</tr>
</tbody>
</table>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2016/11/15/iOS AVPlayer 简单封装/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/11/15/iOS AVPlayer 简单封装/" itemprop="url">
                  iOS AVPlayer 简单封装
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-11-15T10:17:25+08:00">
                2016-11-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2016/11/15/iOS AVPlayer 简单封装/" class="leancloud_visitors" data-flag-title="iOS AVPlayer 简单封装">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>这里给AVPlayer做一个简单封装，可以实现播放本地视频和网络视频。(Swift 3)</p>
<p>代码如下:</p>
<h4 id="AVPlayer-处理播放"><a href="#AVPlayer-处理播放" class="headerlink" title="AVPlayer:处理播放"></a>AVPlayer:处理播放</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> AVFoundation</div><div class="line"><span class="keyword">import</span> Foundation</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">VideoPlayerDelegate</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">downloadedProgress</span><span class="params">(progress:Double)</span></span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">readyToPlay</span><span class="params">()</span></span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">didUpdateProgress</span><span class="params">(progress:Double)</span></span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">didFinishPlayItem</span><span class="params">()</span></span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">didFailPlayToEnd</span><span class="params">()</span></span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> videoContext:<span class="type">UnsafeMutableRawPointer</span>? = <span class="literal">nil</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">VideoPlayer</span>: <span class="title">NSObject</span></span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> assetPlayer:<span class="type">AVPlayer</span>?</div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> playerItem:<span class="type">AVPlayerItem</span>?</div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> urlAsset:<span class="type">AVURLAsset</span>?</div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> videoOutput:<span class="type">AVPlayerItemVideoOutput</span>?</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> assetDuration:<span class="type">Double</span> = <span class="number">0</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> playerView:<span class="type">PlayerView</span>?</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> autoRepeatPlay:<span class="type">Bool</span> = <span class="literal">true</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> autoPlay:<span class="type">Bool</span> = <span class="literal">true</span></div><div class="line">    </div><div class="line">    <span class="keyword">var</span> delegate:<span class="type">VideoPlayerDelegate</span>?</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> playerRate:<span class="type">Float</span> = <span class="number">1</span> &#123;</div><div class="line">        <span class="keyword">didSet</span> &#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">                player.rate = playerRate &gt; <span class="number">0</span> ? playerRate : <span class="number">0.0</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> volume:<span class="type">Float</span> = <span class="number">1.0</span> &#123;</div><div class="line">        <span class="keyword">didSet</span> &#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">                player.volume = volume &gt; <span class="number">0</span> ? volume : <span class="number">0.0</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">convenience</span> <span class="keyword">init</span>(urlAsset:<span class="type">URL</span>, view:<span class="type">PlayerView</span>, startAutoPlay:<span class="type">Bool</span> = <span class="literal">true</span>, repeatAfterEnd:<span class="type">Bool</span> = <span class="literal">true</span>) &#123;</div><div class="line">        <span class="keyword">self</span>.<span class="keyword">init</span>()</div><div class="line">        </div><div class="line">        playerView = view</div><div class="line">        autoPlay = startAutoPlay</div><div class="line">        autoRepeatPlay = repeatAfterEnd</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> playView = playerView, <span class="keyword">let</span> playerLayer = playView.layer <span class="keyword">as</span>? <span class="type">AVPlayerLayer</span> &#123;</div><div class="line">            playerLayer.videoGravity = <span class="type">AVLayerVideoGravityResizeAspectFill</span></div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">        initialSetupWithURL(url: urlAsset)</div><div class="line">        prepareToPlay()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="keyword">init</span>() &#123;</div><div class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// MARK: - Public</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">isPlaying</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span> &#123;</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">            <span class="keyword">return</span> player.rate &gt; <span class="number">0</span></div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="literal">false</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">seekToPosition</span><span class="params">(seconds:Float64)</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">            pause()</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> timeScale = player.currentItem?.asset.duration.timescale &#123;</div><div class="line">                player.seek(to: <span class="type">CMTimeMakeWithSeconds</span>(seconds, timeScale), completionHandler: &#123; (complete) <span class="keyword">in</span></div><div class="line">                    <span class="keyword">self</span>.play()</div><div class="line">                &#125;)</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">pause</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">            player.pause()</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">play</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">            <span class="keyword">if</span> (player.currentItem?.status == .readyToPlay) &#123;</div><div class="line">                player.play()</div><div class="line">                player.rate = playerRate</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">cleanUp</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> item = playerItem &#123;</div><div class="line">            item.removeObserver(<span class="keyword">self</span>, forKeyPath: <span class="string">"status"</span>)</div><div class="line">            item.removeObserver(<span class="keyword">self</span>, forKeyPath: <span class="string">"loadedTimeRanges"</span>)</div><div class="line">        &#125;</div><div class="line">        <span class="type">NotificationCenter</span>.<span class="keyword">default</span>.removeObserver(<span class="keyword">self</span>)</div><div class="line">        assetPlayer = <span class="literal">nil</span></div><div class="line">        playerItem = <span class="literal">nil</span></div><div class="line">        urlAsset = <span class="literal">nil</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// MARK: - Private</span></div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">prepareToPlay</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">let</span> keys = [<span class="string">"tracks"</span>]</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> asset = urlAsset &#123;</div><div class="line">            asset.loadValuesAsynchronously(forKeys: keys, completionHandler: &#123; </div><div class="line">                <span class="type">DispatchQueue</span>.main.async &#123;</div><div class="line">                    <span class="keyword">self</span>.startLoading()</div><div class="line">                &#125;</div><div class="line">            &#125;)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">startLoading</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">var</span> error:<span class="type">NSError</span>?</div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> asset = urlAsset <span class="keyword">else</span> &#123;<span class="keyword">return</span>&#125;</div><div class="line">        </div><div class="line">        <span class="keyword">let</span> status:<span class="type">AVKeyValueStatus</span> = asset.statusOfValue(forKey: <span class="string">"tracks"</span>, error: &amp;error)</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> status == <span class="type">AVKeyValueStatus</span>.loaded &#123;</div><div class="line">            assetDuration = <span class="type">CMTimeGetSeconds</span>(asset.duration)</div><div class="line">            </div><div class="line">            <span class="keyword">let</span> videoOutputOptions = [kCVPixelBufferPixelFormatTypeKey <span class="keyword">as</span> <span class="type">String</span> : <span class="type">Int</span>(kCVPixelFormatType_420YpCbCr8BiPlanarVideoRange)]</div><div class="line">            videoOutput = <span class="type">AVPlayerItemVideoOutput</span>(pixelBufferAttributes: videoOutputOptions)</div><div class="line">            playerItem = <span class="type">AVPlayerItem</span>(asset: asset)</div><div class="line">            </div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> item = playerItem &#123;</div><div class="line">                item.addObserver(<span class="keyword">self</span>, forKeyPath: <span class="string">"status"</span>, options: .initial, context: videoContext)</div><div class="line">                item.addObserver(<span class="keyword">self</span>, forKeyPath: <span class="string">"loadedTimeRanges"</span>, options: [.new, .old], context: videoContext)</div><div class="line">                </div><div class="line">                <span class="type">NotificationCenter</span>.<span class="keyword">default</span>.addObserver(<span class="keyword">self</span>, selector: #selector(playerItemDidReachEnd), name: <span class="type">NSNotification</span>.<span class="type">Name</span>.<span class="type">AVPlayerItemDidPlayToEndTime</span>, object: <span class="literal">nil</span>)</div><div class="line">                <span class="type">NotificationCenter</span>.<span class="keyword">default</span>.addObserver(<span class="keyword">self</span>, selector: #selector(didFailedToPlayToEnd), name: <span class="type">NSNotification</span>.<span class="type">Name</span>.<span class="type">AVPlayerItemFailedToPlayToEndTime</span>, object: <span class="literal">nil</span>)</div><div class="line">                </div><div class="line">                <span class="keyword">if</span> <span class="keyword">let</span> output = videoOutput &#123;</div><div class="line">                    item.add(output)</div><div class="line">                    </div><div class="line">                    item.audioTimePitchAlgorithm = <span class="type">AVAudioTimePitchAlgorithmVarispeed</span></div><div class="line">                    assetPlayer = <span class="type">AVPlayer</span>(playerItem: item)</div><div class="line">                    </div><div class="line">                    <span class="keyword">if</span> <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">                        player.rate = playerRate</div><div class="line">                    &#125;</div><div class="line">                    </div><div class="line">                    addPeriodicalObserver()</div><div class="line">                    <span class="keyword">if</span> <span class="keyword">let</span> playView = playerView, <span class="keyword">let</span> layer = playView.layer <span class="keyword">as</span>? <span class="type">AVPlayerLayer</span> &#123;</div><div class="line">                        layer.player = assetPlayer</div><div class="line">                        <span class="built_in">print</span>(<span class="string">"player created"</span>)</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">addPeriodicalObserver</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">let</span> timeInterval = <span class="type">CMTimeMake</span>(<span class="number">1</span>, <span class="number">1</span>)</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">            player.addPeriodicTimeObserver(forInterval: timeInterval, queue: <span class="type">DispatchQueue</span>.main, using: &#123; (time) <span class="keyword">in</span></div><div class="line">                <span class="keyword">self</span>.playerDidChangeTime(time: time)</div><div class="line">            &#125;)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">playerDidChangeTime</span><span class="params">(time:CMTime)</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">            <span class="keyword">let</span> timeNow = <span class="type">CMTimeGetSeconds</span>(player.currentTime())</div><div class="line">            <span class="keyword">let</span> progress = timeNow / assetDuration</div><div class="line">            </div><div class="line">            delegate?.didUpdateProgress(progress: progress)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="meta">@objc</span> <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">playerItemDidReachEnd</span><span class="params">()</span></span> &#123;</div><div class="line">        delegate?.didFinishPlayItem()</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">            player.seek(to: kCMTimeZero)</div><div class="line">            <span class="keyword">if</span> autoRepeatPlay == <span class="literal">true</span> &#123;</div><div class="line">                play()</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="meta">@objc</span> <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">didFailedToPlayToEnd</span><span class="params">()</span></span> &#123;</div><div class="line">        delegate?.didFailPlayToEnd()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">playerDidChangeStatus</span><span class="params">(status:AVPlayerStatus)</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> status == .failed &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"Failed to load video"</span>)</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> status == .readyToPlay, <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">            volume = player.volume</div><div class="line">            delegate?.readyToPlay()</div><div class="line">            </div><div class="line">            <span class="keyword">if</span> autoPlay == <span class="literal">true</span> &amp;&amp; player.rate == <span class="number">0.0</span> &#123;</div><div class="line">                play()</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">moviewPlayerLoadedTimeRangeDidUpdated</span><span class="params">(ranges:Array&lt;NSValue&gt;)</span></span> &#123;</div><div class="line">        <span class="keyword">var</span> maximum:<span class="type">TimeInterval</span> = <span class="number">0</span></div><div class="line">        <span class="keyword">for</span> value <span class="keyword">in</span> ranges &#123;</div><div class="line">            <span class="keyword">let</span> range:<span class="type">CMTimeRange</span> = value.timeRangeValue</div><div class="line">            <span class="keyword">let</span> currentLoadedTimeRange = <span class="type">CMTimeGetSeconds</span>(range.start) + <span class="type">CMTimeGetSeconds</span>(range.duration)</div><div class="line">            <span class="keyword">if</span> currentLoadedTimeRange &gt; maximum &#123;</div><div class="line">                maximum = currentLoadedTimeRange</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">let</span> progress:<span class="type">Double</span> = assetDuration == <span class="number">0</span> ? <span class="number">0.0</span> : <span class="type">Double</span>(maximum) / assetDuration</div><div class="line">        </div><div class="line">        delegate?.downloadedProgress(progress: progress)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">deinit</span> &#123;</div><div class="line">        cleanUp()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">initialSetupWithURL</span><span class="params">(url:URL)</span></span> &#123;</div><div class="line">        <span class="keyword">let</span> options = [<span class="type">AVURLAssetPreferPreciseDurationAndTimingKey</span> : <span class="literal">true</span>]</div><div class="line">        urlAsset = <span class="type">AVURLAsset</span>(url: url, options: options)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// MARK: - Observations</span></div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">observeValue</span><span class="params">(forKeyPath keyPath: String?, of object: Any?, change: [NSKeyValueChangeKey : Any]?, context: UnsafeMutableRawPointer?)</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> context == videoContext&#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> key = keyPath&#123;</div><div class="line">                <span class="keyword">if</span> key == <span class="string">"status"</span>, <span class="keyword">let</span> player = assetPlayer&#123;</div><div class="line">                    playerDidChangeStatus(status: player.status)</div><div class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span> key == <span class="string">"loadedTimeRange"</span>, <span class="keyword">let</span> item = playerItem&#123;</div><div class="line">                    moviewPlayerLoadedTimeRangeDidUpdated(ranges: item.loadedTimeRanges)</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="PlayerView-播放视频的View"><a href="#PlayerView-播放视频的View" class="headerlink" title="PlayerView: 播放视频的View"></a>PlayerView: 播放视频的View</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlayerView</span>: <span class="title">UIView</span> </span>&#123;</div><div class="line">    <span class="keyword">override</span> <span class="class"><span class="keyword">class</span> <span class="title">var</span> <span class="title">layerClass</span>: <span class="title">AnyClass</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="type">AVPlayerLayer</span>.<span class="keyword">self</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> player:<span class="type">AVPlayer</span>?&#123;</div><div class="line">        <span class="keyword">set</span>&#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> layer = layer <span class="keyword">as</span>? <span class="type">AVPlayerLayer</span>&#123;</div><div class="line">                layer.player = player</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">get</span>&#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> layer = layer <span class="keyword">as</span>? <span class="type">AVPlayerLayer</span>&#123;</div><div class="line">                <span class="keyword">return</span> layer.player</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="使用："><a href="#使用：" class="headerlink" title="使用："></a>使用：</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">VideoTableViewCell</span>: <span class="title">UITableViewCell</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> playerView: <span class="type">PlayerView</span>!</div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> videoPlayer:<span class="type">VideoPlayer</span>?</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> url:<span class="type">URL</span>!</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">awakeFromNib</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.awakeFromNib()</div><div class="line">        <span class="comment">// Initialization code</span></div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">preparePlayer</span><span class="params">()</span></span> &#123;</div><div class="line">        videoPlayer = <span class="type">VideoPlayer</span>(urlAsset: url, view: playerView)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">pause</span><span class="params">()</span></span>&#123;</div><div class="line">        videoPlayer?.pause()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">start</span><span class="params">()</span></span>&#123;</div><div class="line">        videoPlayer?.play()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">clean</span><span class="params">()</span></span>&#123;</div><div class="line">        videoPlayer?.cleanUp()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">isPlaying</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span>&#123;</div><div class="line">        <span class="keyword">return</span> videoPlayer?.isPlaying() ?? <span class="literal">false</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2016/10/25/Swift小Tips/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/25/Swift小Tips/" itemprop="url">
                  Swift小Tips
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-25T11:17:45+08:00">
                2016-10-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2016/10/25/Swift小Tips/" class="leancloud_visitors" data-flag-title="Swift小Tips">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="noescape和-autoclosure"><a href="#noescape和-autoclosure" class="headerlink" title="@noescape和@autoclosure"></a>@noescape和@autoclosure</h4><p><code>@noescape</code>：这个关键字告诉编译器，参数闭包只能在函数内部使用。它不能被赋值给临时变量，不能异步调用，也不能作为未标记为<code>@noescape</code>的参数传递给其他函数。总之您可以放心，它无法在这个函数作用域之外使用。</p>
<p>除了安全性上的保证，swift还会为标记为<code>@noescape</code>的参数做一些优化，闭包内访问类的成员时您还可以省去<code>self.</code>的语法。</p>
<p><code>@autoclosure</code>：这个关键字将表达式封装成闭包，优点在于延迟了表达式的执行，缺点是如果滥用会导致代码可读性降低。</p>
<p>swift3中<code>@noescape</code>变成默认了，需要逃离闭包要用到<code>@escape</code>关键字</p>
<h4 id="可变参数"><a href="#可变参数" class="headerlink" title="可变参数"></a>可变参数</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">printEverythingWithAKrakenEmojiInBetween</span><span class="params">(objectsToPrint: Any...)</span></span> &#123;</div><div class="line">    <span class="keyword">for</span> object <span class="keyword">in</span> objectsToPrint &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"<span class="subst">\(object)</span>🐙"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">printEverythingWithAKrakenEmojiInBetween(<span class="string">"Hey"</span>, <span class="string">"Look"</span>, <span class="string">"At"</span>, <span class="string">"Me"</span>, <span class="string">"!"</span>)</div></pre></td></tr></table></figure>
<p>此时，参数可以当做SequenceType类型来使用，也就是说可以使用for in语法遍历其中的每一个参数。<br>Swift中的print函数就是用这个实现的。</p>
<h4 id="dynamic关键字"><a href="#dynamic关键字" class="headerlink" title="dynamic关键字"></a>dynamic关键字</h4><p>OC中@dynamic关键字是告诉编译器不要为属性合成getter和setter方法。</p>
<p>Swift中也有dynamic关键字，它可以用于修饰变量或函数，它的意思也与OC完全不同。它告诉编译器使用动态分发而不是静态分发。OC区别于其他语言的一个特点在于它的动态性，任何方法调用实际上都是消息分发，而Swift则尽可能做到静态分发。</p>
<p>因此，标记为dynamic的变量/函数会隐式的加上@objc关键字，它会使用OC的runtime机制。</p>
<p>虽然静态分发在效率上可能更好，不过一些app分析统计的库需要依赖动态分发的特性，动态的添加一些统计代码，这一点在Swift的静态分发机制下很难完成。这种情况下，虽然使用dynamic关键字会牺牲因为使用静态分发而获得的一些性能优化，但也依然是值得的。</p>
<h4 id="特殊的字面量"><a href="#特殊的字面量" class="headerlink" title="特殊的字面量"></a>特殊的字面量</h4><p>在开发或调试过程中如果能用好下面这四个字面量，将会起到事半功倍的效果：</p>
<p><code>__FILE__</code>：当前代码在那个文件中<br><code>__FUNCTION__</code>：当前代码在该文件的那个函数中<br><code>__LINE__</code>：当前代码在该文件的第多少行<br><code>__COLUMN__</code>：当前代码在改行的多少列</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">specialLitertalExpression</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="built_in">print</span>(<span class="keyword">__FILE__</span>)</div><div class="line">    <span class="built_in">print</span>(<span class="keyword">__FUNCTION__</span>)</div><div class="line">    <span class="built_in">print</span>(<span class="keyword">__LINE__</span>)</div><div class="line">    <span class="built_in">print</span>(<span class="keyword">__COLUMN__</span>)   <span class="comment">// 输出结果为11，因为有4个空格，print是五个字符，还有一个左括号。</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2016/10/14/iOS常用宏定义（Swift篇）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/14/iOS常用宏定义（Swift篇）/" itemprop="url">
                  iOS常用宏定义（Siwft篇）
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-14T15:26:21+08:00">
                2016-10-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2016/10/14/iOS常用宏定义（Swift篇）/" class="leancloud_visitors" data-flag-title="iOS常用宏定义（Siwft篇）">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>swift中并没有宏定义，只是用全局常量和利用函数获取全局常量的方式实现了OC中的宏定义功能。</p>
</blockquote>
<h4 id="屏幕"><a href="#屏幕" class="headerlink" title="屏幕"></a>屏幕</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">let</span> <span class="type">SCREEN_HEIGHT</span> = <span class="type">UIScreen</span>.mainScreen().bounds.height</div><div class="line"><span class="keyword">let</span> <span class="type">SCREEN_WIDTH</span> = <span class="type">UIScreen</span>.mainScreen().bounds.width</div><div class="line"><span class="keyword">let</span> <span class="type">FIT_WIDTH</span> = <span class="type">UIScreen</span>.mainScreen().bounds.size.width / <span class="number">375</span></div><div class="line"><span class="keyword">let</span> <span class="type">FIT_HEIGHT</span> = <span class="type">UIScreen</span>.mainScreen().bounds.size.height / <span class="number">667</span></div></pre></td></tr></table></figure>
<p>最好的办法是使用结构体：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ScreenSize</span> </span>&#123;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">let</span> height = <span class="type">UIScreen</span>.mainScreen().bounds.height</div><div class="line">    <span class="keyword">static</span> <span class="keyword">let</span> width  = <span class="type">UIScreen</span>.mainScreen().bounds.width</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="系统"><a href="#系统" class="headerlink" title="系统"></a>系统</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">//系统</span></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">System</span> </span>&#123;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">let</span> version = <span class="type">UIDevice</span> .currentDevice().systemVersion</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Log"><a href="#Log" class="headerlink" title="Log"></a>Log</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">/// Log</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">printLog</span>&lt;T&gt;<span class="params">(message: T,</span></span></div><div class="line">              file: String = #file,</div><div class="line">              method: String = #function,</div><div class="line">              line: Int = #line)</div><div class="line">&#123;</div><div class="line">    #<span class="keyword">if</span> <span class="type">DEBUG</span></div><div class="line">        <span class="built_in">print</span>(<span class="string">"Log:<span class="subst">\((file <span class="keyword">as</span> NSString)</span>.lastPathComponent)[<span class="subst">\(line)</span>], <span class="subst">\(method)</span>: <span class="subst">\(message)</span>"</span>)</div><div class="line">    #endif</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/// Error</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">printError</span>&lt;T&gt;<span class="params">(message: T,</span></span></div><div class="line">                file: String = #file,</div><div class="line">                method: String = #function,</div><div class="line">                line: Int = #line)</div><div class="line">&#123;</div><div class="line">    #<span class="keyword">if</span> <span class="type">DEBUG</span></div><div class="line">        <span class="built_in">print</span>(<span class="string">"Error:<span class="subst">\((file <span class="keyword">as</span> NSString)</span>.lastPathComponent)[<span class="subst">\(line)</span>], <span class="subst">\(method)</span>: <span class="subst">\(message)</span>"</span>)</div><div class="line">    #endif</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="UIView"><a href="#UIView" class="headerlink" title="UIView"></a>UIView</h4><p>使用Extension</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">// MARK: - UIView 扩展</span></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIView</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> x:<span class="type">CGFloat</span>&#123;</div><div class="line">        <span class="keyword">return</span> frame.origin.x</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> y:<span class="type">CGFloat</span>&#123;</div><div class="line">        <span class="keyword">return</span> frame.origin.y</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> width:<span class="type">CGFloat</span>&#123;</div><div class="line">        <span class="keyword">return</span> frame.size.width</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> height:<span class="type">CGFloat</span>&#123;</div><div class="line">        <span class="keyword">return</span> frame.size.height</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="设备"><a href="#设备" class="headerlink" title="设备"></a>设备</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">DeviceModel</span> : <span class="title">String</span> </span>&#123;</div><div class="line">    <span class="keyword">case</span> <span class="type">Simulator</span> = <span class="string">"Simulator/Sandbox"</span>,</div><div class="line">    iPod1          = <span class="string">"iPod 1"</span>,</div><div class="line">    iPod2          = <span class="string">"iPod 2"</span>,</div><div class="line">    iPod3          = <span class="string">"iPod 3"</span>,</div><div class="line">    iPod4          = <span class="string">"iPod 4"</span>,</div><div class="line">    iPod5          = <span class="string">"iPod 5"</span>,</div><div class="line">    iPad2          = <span class="string">"iPad 2"</span>,</div><div class="line">    iPad3          = <span class="string">"iPad 3"</span>,</div><div class="line">    iPad4          = <span class="string">"iPad 4"</span>,</div><div class="line">    iPhone4        = <span class="string">"iPhone 4"</span>,</div><div class="line">    iPhone4S       = <span class="string">"iPhone 4S"</span>,</div><div class="line">    iPhone5        = <span class="string">"iPhone 5"</span>,</div><div class="line">    iPhone5S       = <span class="string">"iPhone 5S"</span>,</div><div class="line">    iPhone5C       = <span class="string">"iPhone 5C"</span>,</div><div class="line">    iPadMini1      = <span class="string">"iPad Mini 1"</span>,</div><div class="line">    iPadMini2      = <span class="string">"iPad Mini 2"</span>,</div><div class="line">    iPadMini3      = <span class="string">"iPad Mini 3"</span>,</div><div class="line">    iPadAir1       = <span class="string">"iPad Air 1"</span>,</div><div class="line">    iPadAir2       = <span class="string">"iPad Air 2"</span>,</div><div class="line">    iPhone6        = <span class="string">"iPhone 6"</span>,</div><div class="line">    iPhone6plus    = <span class="string">"iPhone 6 Plus"</span>,</div><div class="line">    iPhone6S       = <span class="string">"iPhone 6S"</span>,</div><div class="line">    iPhone6Splus   = <span class="string">"iPhone 6S Plus"</span>,</div><div class="line">    iPhone7        = <span class="string">"iPhone 7"</span>,</div><div class="line">    iPhone7plus    = <span class="string">"iPhone 7 Plus"</span>,</div><div class="line">    <span class="type">Unrecognized</span>   = <span class="string">"unrecognized"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIDevice</span></span>&#123;</div><div class="line">    <span class="comment">/// 获取当前设备详细类型</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">var</span> deviceModel: <span class="type">DeviceModel</span>&#123;</div><div class="line">        <span class="keyword">var</span> systemInfo = utsname()</div><div class="line">        uname(&amp;systemInfo)</div><div class="line">        <span class="keyword">let</span> machineMirror = <span class="type">Mirror</span>(reflecting: systemInfo.machine)</div><div class="line">        <span class="keyword">let</span> identifier = machineMirror.children.<span class="built_in">reduce</span>(<span class="string">""</span>) &#123; identifier, element <span class="keyword">in</span></div><div class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> value = element.value <span class="keyword">as</span>? <span class="type">Int8</span> , value != <span class="number">0</span> <span class="keyword">else</span> &#123; <span class="keyword">return</span> identifier &#125;</div><div class="line">            <span class="keyword">return</span> identifier + <span class="type">String</span>(<span class="type">UnicodeScalar</span>(<span class="type">UInt8</span>(value)))</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">var</span> modelMap : [ <span class="type">String</span> : <span class="type">DeviceModel</span> ] = [</div><div class="line">            <span class="string">"i386"</span>      : .<span class="type">Simulator</span>,</div><div class="line">            <span class="string">"x86_64"</span>    : .<span class="type">Simulator</span>,</div><div class="line">            <span class="string">"iPod1,1"</span>   : .iPod1,</div><div class="line">            <span class="string">"iPod2,1"</span>   : .iPod2,</div><div class="line">            <span class="string">"iPod3,1"</span>   : .iPod3,</div><div class="line">            <span class="string">"iPod4,1"</span>   : .iPod4,</div><div class="line">            <span class="string">"iPod5,1"</span>   : .iPod5,</div><div class="line">            <span class="string">"iPad2,1"</span>   : .iPad2,</div><div class="line">            <span class="string">"iPad2,2"</span>   : .iPad2,</div><div class="line">            <span class="string">"iPad2,3"</span>   : .iPad2,</div><div class="line">            <span class="string">"iPad2,4"</span>   : .iPad2,</div><div class="line">            <span class="string">"iPad2,5"</span>   : .iPadMini1,</div><div class="line">            <span class="string">"iPad2,6"</span>   : .iPadMini1,</div><div class="line">            <span class="string">"iPad2,7"</span>   : .iPadMini1,</div><div class="line">            <span class="string">"iPhone3,1"</span> : .iPhone4,</div><div class="line">            <span class="string">"iPhone3,2"</span> : .iPhone4,</div><div class="line">            <span class="string">"iPhone3,3"</span> : .iPhone4,</div><div class="line">            <span class="string">"iPhone4,1"</span> : .iPhone4S,</div><div class="line">            <span class="string">"iPhone5,1"</span> : .iPhone5,</div><div class="line">            <span class="string">"iPhone5,2"</span> : .iPhone5,</div><div class="line">            <span class="string">"iPhone5,3"</span> : .iPhone5C,</div><div class="line">            <span class="string">"iPhone5,4"</span> : .iPhone5C,</div><div class="line">            <span class="string">"iPad3,1"</span>   : .iPad3,</div><div class="line">            <span class="string">"iPad3,2"</span>   : .iPad3,</div><div class="line">            <span class="string">"iPad3,3"</span>   : .iPad3,</div><div class="line">            <span class="string">"iPad3,4"</span>   : .iPad4,</div><div class="line">            <span class="string">"iPad3,5"</span>   : .iPad4,</div><div class="line">            <span class="string">"iPad3,6"</span>   : .iPad4,</div><div class="line">            <span class="string">"iPhone6,1"</span> : .iPhone5S,</div><div class="line">            <span class="string">"iPhone6,2"</span> : .iPhone5S,</div><div class="line">            <span class="string">"iPad4,1"</span>   : .iPadAir1,</div><div class="line">            <span class="string">"iPad4,2"</span>   : .iPadAir2,</div><div class="line">            <span class="string">"iPad4,4"</span>   : .iPadMini2,</div><div class="line">            <span class="string">"iPad4,5"</span>   : .iPadMini2,</div><div class="line">            <span class="string">"iPad4,6"</span>   : .iPadMini2,</div><div class="line">            <span class="string">"iPad4,7"</span>   : .iPadMini3,</div><div class="line">            <span class="string">"iPad4,8"</span>   : .iPadMini3,</div><div class="line">            <span class="string">"iPad4,9"</span>   : .iPadMini3,</div><div class="line">            <span class="string">"iPhone7,1"</span> : .iPhone6plus,</div><div class="line">            <span class="string">"iPhone7,2"</span> : .iPhone6,</div><div class="line">            <span class="string">"iPhone8,1"</span> : .iPhone6S,</div><div class="line">            <span class="string">"iPhone8,2"</span> : .iPhone6Splus,</div><div class="line">            <span class="string">"iPhone9,1"</span> : .iPhone7,</div><div class="line">            <span class="string">"iPhone9,2"</span> : .iPhone7plus</div><div class="line">        ]</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> model = modelMap[identifier] &#123;</div><div class="line">            <span class="keyword">return</span> model</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="type">DeviceModel</span>.<span class="type">Unrecognized</span></div><div class="line">    &#125;</div><div class="line">    <span class="comment">/// 判断是不是iPhone</span></div><div class="line">    <span class="keyword">var</span> isiPhone:<span class="type">Bool</span>&#123;</div><div class="line">        <span class="keyword">return</span> model == <span class="string">"iPhone"</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/// 判断是不是iPad</span></div><div class="line">    <span class="keyword">var</span> isiPad:<span class="type">Bool</span>&#123;</div><div class="line">        <span class="keyword">return</span> model == <span class="string">"iPad"</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2016/10/04/常用正则表达式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2016/10/04/常用正则表达式/" itemprop="url">
                  常用正则表达式
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-04T19:20:25+08:00">
                2016-10-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2016/10/04/常用正则表达式/" class="leancloud_visitors" data-flag-title="常用正则表达式">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>下面是开发中经常使用到的正则表达式。</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">//MARK:- 正则匹配手机号</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">checkMobile</span>(<span class="title">_</span> <span class="title">mobileNumbel</span>:<span class="title">String</span>) -&gt;<span class="title">Bool</span></span>&#123;</div><div class="line">    <span class="keyword">let</span> pattern = <span class="string">"^(13[0-9]|15[0-9]|18[0-9]|17[0-9]|147)\\d&#123;8&#125;$"</span></div><div class="line">    <span class="keyword">let</span> pred = <span class="type">NSPredicate</span>(format: <span class="string">"SELF MATCHES %@"</span>, pattern)</div><div class="line">    <span class="keyword">let</span> isMatch:<span class="type">Bool</span> = pred.evaluate(with: idCard)</div><div class="line">    <span class="keyword">return</span> isMatch;</div><div class="line">&#125;</div><div class="line"><span class="comment">//MARK:- 正则匹配用户身份证号15或18位</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">checkUserIdCard</span>(<span class="title">_</span> <span class="title">idCard</span>:<span class="title">String</span>) -&gt;<span class="title">Bool</span> </span>&#123;</div><div class="line">    <span class="keyword">let</span> pattern = <span class="string">"(^[0-9]&#123;15&#125;$)|([0-9]&#123;17&#125;([0-9]|X)$)"</span>;</div><div class="line">    <span class="keyword">let</span> pred = <span class="type">NSPredicate</span>(format: <span class="string">"SELF MATCHES %@"</span>, pattern)</div><div class="line">    <span class="keyword">let</span> isMatch:<span class="type">Bool</span> = pred.evaluate(with: idCard)</div><div class="line">    <span class="keyword">return</span> isMatch;</div><div class="line">&#125;</div><div class="line"><span class="comment">//MARK:- 正则匹配用户密码6-18位数字和字母组合</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">checkPassword</span>(<span class="title">_</span> <span class="title">password</span>:<span class="title">String</span>) -&gt;<span class="title">Bool</span> </span>&#123;</div><div class="line">    <span class="keyword">let</span> pattern = <span class="string">"^(?![0-9]+$)(?![a-zA-Z]+$)[a-zA-Z0-9]&#123;6,18&#125;"</span></div><div class="line">    <span class="keyword">let</span> pred = <span class="type">NSPredicate</span>(format: <span class="string">"SELF MATCHES %@"</span>, pattern)</div><div class="line">    <span class="keyword">let</span> isMatch:<span class="type">Bool</span> = pred.evaluate(with: password)</div><div class="line">    <span class="keyword">return</span> isMatch;</div><div class="line">&#125;</div><div class="line"><span class="comment">//MARK:- 正则匹配URL</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">checkURL</span>(<span class="title">_</span> <span class="title">url</span>:<span class="title">String</span>) -&gt;<span class="title">Bool</span> </span>&#123;</div><div class="line">    <span class="keyword">let</span> pattern = <span class="string">"^[0-9A-Za-z]&#123;1,50&#125;"</span></div><div class="line">    <span class="keyword">let</span> pred = <span class="type">NSPredicate</span>(format: <span class="string">"SELF MATCHES %@"</span>, pattern)</div><div class="line">    <span class="keyword">let</span> isMatch:<span class="type">Bool</span> = pred.evaluate(with: url)</div><div class="line">    <span class="keyword">return</span> isMatch;</div><div class="line">&#125;</div><div class="line"><span class="comment">//MARK:- 正则匹配用户姓名,20位的中文或英文</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">checkUserName</span>(<span class="title">_</span> <span class="title">userName</span>:<span class="title">String</span>) -&gt;<span class="title">Bool</span> </span>&#123;</div><div class="line">    <span class="keyword">let</span> pattern = <span class="string">"^[a-zA-Z\\u4E00-\\u9FA5]&#123;1,20&#125;"</span></div><div class="line">    <span class="keyword">let</span> pred = <span class="type">NSPredicate</span>(format: <span class="string">"SELF MATCHES %@"</span>, pattern)</div><div class="line">    <span class="keyword">let</span> isMatch:<span class="type">Bool</span> = pred.evaluate(with: userName)</div><div class="line">    <span class="keyword">return</span> isMatch;</div><div class="line">&#125;</div><div class="line"><span class="comment">//MARK:- 正则匹配用户email</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">checkEmail</span>(<span class="title">_</span> <span class="title">email</span>:<span class="title">String</span>) -&gt;<span class="title">Bool</span> </span>&#123;</div><div class="line">    <span class="keyword">let</span> pattern = <span class="string">"[A-Z0-9a-z._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]&#123;2,4&#125;"</span></div><div class="line">    <span class="keyword">let</span> pred = <span class="type">NSPredicate</span>(format: <span class="string">"SELF MATCHES %@"</span>, pattern)</div><div class="line">    <span class="keyword">let</span> isMatch:<span class="type">Bool</span> = pred.evaluate(with: email)</div><div class="line">    <span class="keyword">return</span> isMatch;</div><div class="line">&#125;</div><div class="line"><span class="comment">//MARK:- 只能是中文</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">isChinese</span>(<span class="title">_</span> <span class="title">str</span>:<span class="title">String</span>) -&gt;<span class="title">Bool</span> </span>&#123;</div><div class="line">    <span class="keyword">let</span> pattern = <span class="string">"^[\\u4e00-\\u9fa5]&#123;0,&#125;$"</span></div><div class="line">    <span class="keyword">let</span> pred = <span class="type">NSPredicate</span>(format: <span class="string">"SELF MATCHES %@"</span>, pattern)</div><div class="line">    <span class="keyword">let</span> isMatch:<span class="type">Bool</span> = pred.evaluate(with: str)</div><div class="line">    <span class="keyword">return</span> isMatch;</div><div class="line">&#125;</div><div class="line"><span class="comment">//MARK:- 正则匹配金额</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">checkMoney</span>(<span class="title">_</span> <span class="title">str</span>:<span class="title">String</span>) -&gt;<span class="title">Bool</span> </span>&#123;</div><div class="line">    <span class="keyword">let</span> pattern = <span class="string">"^[0-9]+(.[0-9]&#123;2&#125;)?$"</span></div><div class="line">    <span class="keyword">let</span> pred = <span class="type">NSPredicate</span>(format: <span class="string">"SELF MATCHES %@"</span>, pattern)</div><div class="line">    <span class="keyword">let</span> isMatch:<span class="type">Bool</span> = pred.evaluate(with: str)</div><div class="line">    <span class="keyword">return</span> isMatch;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="xinnyu" />
          <p class="site-author-name" itemprop="name">xinnyu</p>
           
              <p class="site-description motion-element" itemprop="description">成就感和尊严使你快乐</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">39</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">10</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/xinnyu" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">xinnyu</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  








  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  

    

    

  




	





  





  





  






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("89bSIbjh54oGv1MH2W387qHC-gzGzoHsz", "AtsNxJJTU0iLTX4hi42nIBOW");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

  

</body>
</html>
