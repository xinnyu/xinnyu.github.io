<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="xinyu, xinnyu" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="成就感和尊严,给你快乐.">
<meta property="og:type" content="website">
<meta property="og:title" content="XINNYU">
<meta property="og:url" content="https://xinnyu.github.io/index.html">
<meta property="og:site_name" content="XINNYU">
<meta property="og:description" content="成就感和尊严,给你快乐.">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="XINNYU">
<meta name="twitter:description" content="成就感和尊严,给你快乐.">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://xinnyu.github.io/"/>





  <title> XINNYU </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">XINNYU</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-collapse">
    <span class="archive-move-on"></span>

    <span class="archive-page-counter">
      
      
       
      
      OK! 目前共计 45 篇日志。 继续努力。
    </span>

    

      
      
      

      
        
        <div class="collection-title">
          <h2 class="archive-year motion-element" id="archive-year-2017">2017</h2>
        </div>
      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2017/04/27/让你的代码更规范，Swiftlint的使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                让你的代码更规范，Swiftlint的使用
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-27T10:14:25+08:00">
                2017-04-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/04/27/让你的代码更规范，Swiftlint的使用/" class="leancloud_visitors" data-flag-title="让你的代码更规范，Swiftlint的使用">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>SwiftLint 是一个用于强制检查 Swift 代码风格和规定的一个工具，基本上以 GitHub’s Swift 代码风格指南为基础。<br>SwiftLint Hook 了 Clang 和 SourceKit 从而能够使用 AST 来表示源代码文件的更多精确结果。</p>
</blockquote>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>swiftlint官方给出了几种安装方式，这边我使用Homebrew的方式进行安装，步骤如下：</p>
<ol>
<li>安装Homebrew (如果没有的话)</li>
<li>Terminal 执行 <code>brew install swiftlint</code></li>
<li>在项目中添加一个新的 <code>Run Script Phase</code> :</li>
</ol>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line"><span class="keyword">if</span> <span class="built_in">which</span> swiftlint &gt;/dev/null; <span class="keyword">then</span></div><div class="line">  swiftlint</div><div class="line"><span class="keyword">else</span></div><div class="line">  <span class="built_in">echo</span> <span class="string">"warning: SwiftLint not installed, download from https://github.com/realm/SwiftLint"</span></div><div class="line"><span class="keyword">fi</span></div></pre></td></tr></table></figure>
<p>通过以上步骤就已经把Swiftlint安装到Mac，并集成在项目中了。</p>
<h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><p>使用的话没有什么说的，安装完成后<code>Command + B</code>编译，swiftlint就会对你项目中不规范的代码报出警告。</p>
<p>但是如果你项目中使用了其他第三方库的话，你又按照上面的做法来编译，那么你就有可能会一脸懵逼，Xcode瞬间给你<strong>999+ error</strong></p>
<p>这时我们就需要修改Swfitlint的配置文件，也就是告诉swiftlint需要检查哪些源码，以及检查的规则。</p>
<h1 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h1><h2 id="配置文件夹"><a href="#配置文件夹" class="headerlink" title="配置文件夹"></a>配置文件夹</h2><ol>
<li>在工程的根目录下新建一个<code>.swiftlint.yml</code>文件</li>
<li>在文件内写入规则：</li>
</ol>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line">included: # 执行 linting 时包含的路径。如果出现这个 `--path` 会被忽略。</div><div class="line">  - <span class="type">Source</span></div><div class="line">excluded: # 执行 linting 时忽略的路径。 优先级比 `included` 更高。</div><div class="line">  - <span class="type">Carthage</span></div><div class="line">  - <span class="type">Pods</span></div><div class="line">  - <span class="type">Source</span>/<span class="type">ExcludedFolder</span></div><div class="line">  - <span class="type">Source</span>/<span class="type">ExcludedFile</span>.swift</div><div class="line">  </div><div class="line">disabled_rules: # 执行时排除掉的规则</div><div class="line">  - colon</div><div class="line">  - comma</div><div class="line">  - control_statement</div><div class="line">opt_in_rules: # 一些规则仅仅是可选的</div><div class="line">  - empty_count</div><div class="line">  - missing_docs</div><div class="line">  # 可以通过执行如下指令来查找所有可用的规则:</div><div class="line">  # swiftlint rules</div></pre></td></tr></table></figure>
<h2 id="配置规则"><a href="#配置规则" class="headerlink" title="配置规则"></a>配置规则</h2><p>官方还提供了自定义规则的方法,基于正则表达式</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line">custom_rules:</div><div class="line">  pirates_beat_ninjas: # 规则标识符</div><div class="line">    name: <span class="string">"Pirates Beat Ninjas"</span> # 规则名称，可选</div><div class="line">    regex: <span class="string">"([n,N]inja)"</span> # 匹配的模式</div><div class="line">    match_kinds: # 需要匹配的语法类型，可选</div><div class="line">      - comment</div><div class="line">      - identifier</div><div class="line">    message: <span class="string">"Pirates are better than ninjas."</span> # 提示信息，可选</div><div class="line">    severity: error # 提示的级别，可选</div><div class="line">  no_hiding_in_strings:</div><div class="line">    regex: <span class="string">"([n,N]inja)"</span></div><div class="line">    match_kinds: string</div></pre></td></tr></table></figure>
<p>更多类容可以查看：<a href="https://github.com/realm/SwiftLint/blob/master/README_CN.md" target="_blank" rel="external">Swfitlint 规则</a></p>
<h1 id="小Tips"><a href="#小Tips" class="headerlink" title="小Tips"></a>小Tips</h1><p>在确定源码被正常备份后使用<code>swiftlint autocorrect</code>指令可以对源代码进行自动修正</p>
<p>可以通过在一个源文件中定义一个如下格式的注释来关闭某个规则：<br><code>// swiftlint:disable &lt;rule&gt;</code><br>在该文件结束之前或者在定义如下格式的匹配注释之前，这条规则都会被禁用：<br><code>// swiftlint:enable &lt;rule&gt;</code></p>
<p>下面是我个人的配置文件分享：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line">included: # 检查的目录</div><div class="line">excluded: # 忽略检查的目录，优先级比included高</div><div class="line">  - <span class="type">Carthage</span></div><div class="line">  - <span class="type">Pods</span></div><div class="line"></div><div class="line">identifier_name:</div><div class="line">  min_length: # not possible to disable this partial rule, so <span class="keyword">set</span> it to zero</div><div class="line">    warning: <span class="number">0</span></div><div class="line">    error: <span class="number">0</span></div><div class="line">  excluded:</div><div class="line">    - _addNotificationBlock(<span class="number">_</span>:)</div><div class="line">    - _nsError</div><div class="line">    - _nsErrorDomain</div><div class="line">    - id</div><div class="line">    - pk</div><div class="line">    - to</div><div class="line"></div><div class="line">file_length: <span class="number">1000</span> #文件的行数</div><div class="line"></div><div class="line">line_length: <span class="number">150</span> # 每一行的字符数</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/Swift/" rel="tag"># Swift</a>
          
            <a href="/tags/Xcode/" rel="tag"># Xcode</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/04/14/Pyinstaller将python脚本打包成可执行文件/" rel="prev" title="Pyinstaller将python脚本打包成可执行文件">
                Pyinstaller将python脚本打包成可执行文件 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2017/04/14/Pyinstaller将python脚本打包成可执行文件/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Pyinstaller将python脚本打包成可执行文件
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-14T01:00:08+08:00">
                2017-04-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/04/14/Pyinstaller将python脚本打包成可执行文件/" class="leancloud_visitors" data-flag-title="Pyinstaller将python脚本打包成可执行文件">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><a href="https://github.com/pyinstaller/pyinstaller/" target="_blank" rel="external">PyInstaller</a>可以用来打包Python应用程序，把Python脚本和所用到的库打包为exe文件，可以更方便的发布程序，避免使用程序的每个电脑都必须安装Python，这样，打包完的程序就可以在没有安装Python解释器的机器上运行了。</p>
<h4 id="安装Pyinstaller"><a href="#安装Pyinstaller" class="headerlink" title="安装Pyinstaller"></a>安装Pyinstaller</h4><p>使用pip或者easy_install来安装：<br><code>sudo pip install pyinstaller</code></p>
<h4 id="使用PyInstaller"><a href="#使用PyInstaller" class="headerlink" title="使用PyInstaller"></a>使用PyInstaller</h4><p><code>pyinstaller myapp.py</code></p>
<p>当使用PyInstaller打包的时候，默认生成一个文件夹，文件夹中包含所有依赖项，以及可执行文件。打包成文件夹的好处就是debug的时候可以清楚的看到依赖项有没有包含。另一个好处是更新的时候，只需要更新可执行文件就可以了。当然缺点也很明显，不方便，不易管理。</p>
<p>那么它是如何工作的呢？PyInstaller的引导程序是一个二进制可执行程序。当用户启动你的程序的时候，PyInstaller的引导程序开始运行，首先创建一个临时的Python环境，然后通过Python解释器导入程序的依赖，当然它们都在同一个文件夹下。</p>
<h6 id="打包成一个文件"><a href="#打包成一个文件" class="headerlink" title="打包成一个文件"></a>打包成一个文件</h6><p>我们可以用onefile参数将所有文件打包到一个可执行文件中。</p>
<p><code>pyinstaller --onefile myapp.py</code></p>
<p>打包成一个文件相对于文件夹更容易管理。坏处运行相对比较慢。这个文件中包含了压缩的依赖文件拷贝（.so文件-Linux，dll文件-Windows）。</p>
<p>当程序运行时，PyInstaller的引导程序会新建一个临时文件夹。然后解压程序的第三方依赖文件到临时文件夹中。这也是为什么一个可执行文件比文件夹中执行的时间要长的原因。剩下的就和上面的一样了。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>所以，我们要通过PyInstaller生成可执行的文件主要下面两步。</p>
<p><code>pyinstaller [option] myapp.py</code></p>
<p>option为空生成文件夹，选择onefile，生成一个文件。</p>
<p>如果项目有一些依赖的数据文件，上面生成的二进制文件是无法运行的，这个时候可以通过生成spec文件，而后再用pyinstaller运行spec文件。</p>
<p><code>pyinstaller [option] myapp.spec</code></p>
<p><strong><em>最后有个坑就是目前最新版本的pyinstaller 3.2.1 不支持 python3.6。</em></strong></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Python/" rel="tag"># Python</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/04/27/让你的代码更规范，Swiftlint的使用/" rel="next" title="让你的代码更规范，Swiftlint的使用">
                <i class="fa fa-chevron-left"></i> 让你的代码更规范，Swiftlint的使用
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/04/13/Xcode不自动补全问题/" rel="prev" title="Xcode不自动补全问题">
                Xcode不自动补全问题 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2017/04/13/Xcode不自动补全问题/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Xcode不自动补全问题
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-04-13T21:24:36+08:00">
                2017-04-13
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/04/13/Xcode不自动补全问题/" class="leancloud_visitors" data-flag-title="Xcode不自动补全问题">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="1-要import-pods里的头文件"><a href="#1-要import-pods里的头文件" class="headerlink" title="1.要import pods里的头文件"></a>1.要import pods里的头文件</h3><p>有时候XCode搜索头文件不会去搜索Pods里的第三方库，我们需要在XCode里设置一下项目Target的Search Paths。</p>
<p>双击User Header Search Paths的空白处，填入”$(PODS_ROOT)”(没有引号), 设置为递归的搜索recursive，问题解决了。</p>
<h3 id="2-XCode自带BUG"><a href="#2-XCode自带BUG" class="headerlink" title="2.XCode自带BUG"></a>2.XCode自带BUG</h3><p>有些时候我们没有调用第三方库，发现UIkit的自动补全都没法触发了，这样的原因多半是因为XCode自带BUG，在你的注释里有中文的时候，不会触发自动补全，比如这个’年’，删掉过后再编译一下试试，再不行就重启一下XCode。</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/Xcode/" rel="tag"># Xcode</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/04/14/Pyinstaller将python脚本打包成可执行文件/" rel="next" title="Pyinstaller将python脚本打包成可执行文件">
                <i class="fa fa-chevron-left"></i> Pyinstaller将python脚本打包成可执行文件
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/03/07/用Carthage构建自己的Framework/" rel="prev" title="用Carthage构建自己的Framework">
                用Carthage构建自己的Framework <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2017/03/07/用Carthage构建自己的Framework/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                用Carthage构建自己的Framework
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-03-07T22:19:25+08:00">
                2017-03-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/03/07/用Carthage构建自己的Framework/" class="leancloud_visitors" data-flag-title="用Carthage构建自己的Framework">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>用Framework的方式来管理公共代码是个不错的选择，Framework的好处也是多多的:</p>
<ul>
<li>本质上是个bundle，不仅可以打包代码，还可以打包资源Assets、视图XIB等</li>
<li>可以有选择的开放头文件、接口，避免了用CocoaPods集成子项目时，所有代码全部暴露的问题，只暴露需要的，代码更加清晰。</li>
<li>从iOS 8开始支持的Cocoa Touch Framework可以支持动态Framework，能在主App和各种Extension之间共享一份二进制目标代码，加快应用加载速度，减小体积，加快编译速度等。</li>
</ul>
<p>基于Cocoa Touch Framework动态框架的种种优点，“去中心化”的轻量级依赖包管理工具，Carthage也越来越受欢迎。</p>
<h1 id="创建Framework"><a href="#创建Framework" class="headerlink" title="创建Framework"></a>创建Framework</h1><p>创建Framework的过程非常简单，Xcode 6以后就有了Framework项目模板，直接选中”Cocoa Touch Framework”模板，按照提示来即可。Swift的话，将要暴露的类、方法标记public，OC的话在<code>Build Phases</code> - <code>Headers</code> - <code>Public</code> 加入需要暴露的头文件即可。</p>
<h2 id="使用Carthage创建Framework"><a href="#使用Carthage创建Framework" class="headerlink" title="使用Carthage创建Framework"></a>使用Carthage创建Framework</h2><p>Carthage只支持构建标记为“Shared”的项目Target，所以创建好了Framework工程后，还要设置Scheme为“Shared”，可以在当前Scheme的<code>Edit Scheme</code>里面设置，也可以在Xcode的菜单 <code>Product</code> - <code>Scheme</code> - <code>Manage Schemes</code> 里面设置。<br>然后将Framework工程推送到Git仓库中，记住打上版本号tag。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">git tag 0.1.0</div><div class="line">git push origin master --tags</div></pre></td></tr></table></figure>
<p>下面有一篇详细教程：</p>
<blockquote>
<p><a href="http://blog.mat.tc/how-to-make-a-carthage-compatible-framework/" target="_blank" rel="external">Matt Condon’s Blog - Making Carthage-compatible Frameworks with Swift</a><br><a href="http://tutuge.me/2016/04/10/summary-of-code-organization/" target="_blank" rel="external">总结一些iOS项目中组织代码的方法</a></p>
</blockquote>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/04/13/Xcode不自动补全问题/" rel="next" title="Xcode不自动补全问题">
                <i class="fa fa-chevron-left"></i> Xcode不自动补全问题
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/02/15/Runtime相关-Swift应用/" rel="prev" title="Runtime相关-Swift">
                Runtime相关-Swift <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2017/02/15/Runtime相关-Swift应用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Runtime相关-Swift
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-02-15T10:17:25+08:00">
                2017-02-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/02/15/Runtime相关-Swift应用/" class="leancloud_visitors" data-flag-title="Runtime相关-Swift">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>深入了解过Objective-C这门语言的人一定知道，这是一门动态语言。在日常的开发中，也常常会使用到Runtime对自己的项目做一些小”手脚”，比如说替换这些视图控制器的viewWillAppear方法让他们在启动的时候能在自己的事件日志中记录一下，或者是记录一下这个视图控制器的时间；或者是对某个模型做一些便利化的操作，比如说动态的获取到模型里边的属性名称，然后自动的encode与decode，将JSON自动的转为Model之类的操作。</p>
<p>但在Swift中，纯的Swift类是没有Runtime这个概念的，它的函数调用已经不是obj-c的objc——msgsend，在编译时就确定了要调用说明函数。<br>可是如果你把你的Swift类继承自NSObject，它就具有了动态性，也能使用Runtime的方法了。有一点要注意的是，Tuple这个类型是swift独有的无法映射到OC，所以就无法通过runtime获取。</p>
<p>下面是一个简单的例子，通过runtime交换Button的点击事件，来实现Button不能无限点击的效果：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//  ButtonExtensions.swift</span></div><div class="line"><span class="comment">//  RuntimeDemo</span></div><div class="line"><span class="comment">//</span></div><div class="line"><span class="comment">//  Created by panxinyu on 04/05/2017.</span></div><div class="line"><span class="comment">//  Copyright © 2017 panxinyu. All rights reserved.</span></div><div class="line"><span class="comment">//</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> UIKit</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIButton</span></span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">let</span> doOnce:() = &#123;</div><div class="line">        swizzleSendActionMethod()</div><div class="line">    &#125;()</div><div class="line">    </div><div class="line">    <span class="keyword">override</span> open <span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">initialize</span>()</span>&#123;</div><div class="line">        <span class="number">_</span> = doOnce</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">swizzleSendActionMethod</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">let</span> originalSelector = #selector(sendAction(<span class="number">_</span>:to:<span class="keyword">for</span>:))</div><div class="line">        <span class="keyword">let</span> swizzleSelector = #selector(xy_sendAction(<span class="number">_</span>:to:<span class="keyword">for</span>:))</div><div class="line">        </div><div class="line">        changeMethod(original: originalSelector, swizzled: swizzleSelector)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">xy_sendAction</span><span class="params">(<span class="number">_</span> action: Selector, to target: Any?, <span class="keyword">for</span> event: UIEvent?)</span></span>&#123;</div><div class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">once</span></span>&#123;</div><div class="line">            <span class="keyword">static</span> <span class="keyword">var</span> canClick = <span class="literal">true</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> once.canClick&#123;</div><div class="line">            <span class="comment">// 注意这里不是死循环，因为我们已经把方法实现替换掉了，它实际上是调用原本的点击方法</span></div><div class="line">            xy_sendAction(action, to: target, <span class="keyword">for</span>: event)</div><div class="line">            once.canClick = <span class="literal">false</span></div><div class="line">            <span class="type">DispatchQueue</span>.main.asyncAfter(deadline: .now() + <span class="number">2</span>, execute: &#123;</div><div class="line">                once.canClick = <span class="literal">true</span></div><div class="line">            &#125;)</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"单身20年手速，怕不怕"</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">NSObject</span></span>&#123;</div><div class="line">    </div><div class="line">    <span class="comment">/// 利用runtime替换方法实现 *****慎用*******</span></div><div class="line">    <span class="comment">///</span></div><div class="line">    <span class="comment">/// - Parameters:</span></div><div class="line">    <span class="comment">///   - original: 原始方法</span></div><div class="line">    <span class="comment">///   - swizzled: 替换后的方法</span></div><div class="line">    <span class="keyword">static</span> <span class="function"><span class="keyword">func</span> <span class="title">changeMethod</span><span class="params">(original:Selector, swizzled:Selector)</span></span> -&gt; () &#123;</div><div class="line">        <span class="keyword">let</span> originalMethod = class_getInstanceMethod(<span class="keyword">self</span>, original)</div><div class="line">        <span class="keyword">let</span> swizzledMethod = class_getInstanceMethod(<span class="keyword">self</span>, swizzled)</div><div class="line">        </div><div class="line">        <span class="comment">//在进行 Swizzling 的时候,需要用 class_addMethod 先进行判断一下原有类中是否有要替换方法的实现</span></div><div class="line">        <span class="keyword">let</span> didAddMethod: <span class="type">Bool</span> = class_addMethod(<span class="keyword">self</span>, original, method_getImplementation(swizzledMethod), method_getTypeEncoding(swizzledMethod))</div><div class="line">        </div><div class="line">        <span class="comment">//如果 class_addMethod 返回 yes,说明当前类中没有要替换方法的实现,所以需要在父类中查找,这时候就用到 method_getImplemetation 去获取 class_getInstanceMethod 里面的方法实现,然后再进行 class_replaceMethod 来实现 Swizzing</span></div><div class="line">        <span class="keyword">if</span> didAddMethod &#123;</div><div class="line">            class_replaceMethod(<span class="keyword">self</span>, swizzled, method_getImplementation(originalMethod), method_getTypeEncoding(originalMethod))</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            method_exchangeImplementations(originalMethod, swizzledMethod)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>如果有些Button需要不延时点击的话，可以给Button加上一个tag判断即可</p>
<p>下面还有一个runtime的使用场景：</p>
<p>当我们用NSCoding协议进行序列化和反序列化的时候，通常的做法是在encoder和decoder中把每一个属性都写进去，但是如果这个类有很多属性的时候，这就变成了一件麻烦事；<br>这时我们就可以使用runtime获取这个类的属性列表，然后遍历属性利用KVO进行归档和解档操作了</p>
<p>代码如下：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</div><div class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</div><div class="line">        </div><div class="line">        <span class="comment">// copyIvarList 获取一个类的成员变量个数</span></div><div class="line">        </div><div class="line">        <span class="comment">// 这个变量来储存变量的个数</span></div><div class="line">        <span class="keyword">var</span> ivarCount:<span class="type">UInt32</span> = <span class="number">0</span></div><div class="line">        <span class="keyword">let</span> ivars = class_copyIvarList(<span class="type">Person</span>.<span class="keyword">self</span>, &amp;ivarCount)</div><div class="line">        <span class="built_in">print</span>(<span class="string">"<span class="subst">\(ivarCount)</span> --- ivar count"</span>)</div><div class="line">        </div><div class="line">        <span class="comment">// 遍历成员变量获得成员变量的name</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..&lt;ivarCount&#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> ivar = ivars?[<span class="type">Int</span>(i)] &#123;</div><div class="line">                <span class="comment">// 获取到的变量名是 UnsafePointer&lt;Int8&gt; ，利用cString转换成String</span></div><div class="line">                <span class="keyword">let</span> key = <span class="type">String</span>(cString: ivar_getName(ivar))</div><div class="line">                <span class="comment">// 解档</span></div><div class="line">                <span class="keyword">let</span> value = aDecoder.decodeObject(forKey: key)</div><div class="line">                <span class="comment">// KVC</span></div><div class="line">                setValue(value, forKey: key)</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">encode</span><span class="params">(with aCoder: NSCoder)</span></span> &#123;</div><div class="line">        <span class="comment">// copyIvarList 获取一个类的成员变量个数</span></div><div class="line">        <span class="keyword">var</span> ivarCount:<span class="type">UInt32</span> = <span class="number">0</span></div><div class="line">        <span class="keyword">let</span> ivars = class_copyIvarList(<span class="type">Person</span>.<span class="keyword">self</span>, &amp;ivarCount)</div><div class="line">        <span class="built_in">print</span>(<span class="string">"<span class="subst">\(ivarCount)</span> --- ivar count"</span>)</div><div class="line">        </div><div class="line">        <span class="comment">// 遍历成员变量获得成员变量的name</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..&lt;ivarCount&#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> ivar = ivars?[<span class="type">Int</span>(i)] &#123;</div><div class="line">                <span class="comment">// 获取到的变量名是 UnsafePointer&lt;Int8&gt; ，利用cString转换成String</span></div><div class="line">                <span class="keyword">let</span> key = <span class="type">String</span>(cString: ivar_getName(ivar))</div><div class="line">                <span class="comment">//归档</span></div><div class="line">                aCoder.encode(<span class="keyword">self</span>.value(forKey: key), forKey: key)</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    </div><div class="line"><span class="comment">// 使用</span></div><div class="line"></div><div class="line"><span class="type">NSKeyedArchiver</span>.archiveRootObject(p, toFile: path)</div><div class="line"></div><div class="line"><span class="keyword">if</span> <span class="keyword">let</span> p1 = <span class="type">NSKeyedUnarchiver</span>.unarchiveObject(withFile: path) <span class="keyword">as</span>? <span class="type">Person</span>&#123;</div><div class="line">    <span class="comment">// do something</span></div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>我们还可以自定义一个ArchivableObject的类，方便使用：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> Foundation</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span>:<span class="title">ArchivableObject</span></span>&#123;</div><div class="line">    <span class="keyword">var</span> name:<span class="type">String</span>!</div><div class="line">    <span class="keyword">var</span> age:<span class="type">NSNumber</span>?</div><div class="line">    <span class="keyword">var</span> gender:<span class="type">String</span>! = <span class="string">"none"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ArchivableObject</span>: <span class="title">NSObject</span>,<span class="title">NSCoding</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(coder aDecoder: <span class="type">NSCoder</span>) &#123;</div><div class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</div><div class="line">        <span class="comment">// copyIvarList 获取一个类的成员变量个数</span></div><div class="line">        <span class="keyword">var</span> ivarCount:<span class="type">UInt32</span> = <span class="number">0</span></div><div class="line">        <span class="keyword">let</span> ivars = class_copyIvarList(<span class="type">Person</span>.<span class="keyword">self</span>, &amp;ivarCount)</div><div class="line">        <span class="built_in">print</span>(<span class="string">"<span class="subst">\(ivarCount)</span> --- ivar count"</span>)</div><div class="line">        </div><div class="line">        <span class="comment">// 遍历成员变量获得成员变量的name</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..&lt;ivarCount&#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> ivar = ivars?[<span class="type">Int</span>(i)] &#123;</div><div class="line">                <span class="keyword">let</span> key = <span class="type">String</span>(cString: ivar_getName(ivar))</div><div class="line">                <span class="comment">// 解档</span></div><div class="line">                <span class="keyword">let</span> value = aDecoder.decodeObject(forKey: key)</div><div class="line">                <span class="comment">// KVC</span></div><div class="line">                setValue(value, forKey: key)</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="keyword">init</span>() &#123;</div><div class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">encode</span><span class="params">(with aCoder: NSCoder)</span></span> &#123;</div><div class="line">        <span class="comment">// copyIvarList 获取一个类的成员变量个数</span></div><div class="line">        <span class="keyword">var</span> ivarCount:<span class="type">UInt32</span> = <span class="number">0</span></div><div class="line">        <span class="keyword">let</span> ivars = class_copyIvarList(<span class="type">Person</span>.<span class="keyword">self</span>, &amp;ivarCount)</div><div class="line">        <span class="built_in">print</span>(<span class="string">"<span class="subst">\(ivarCount)</span> --- ivar count"</span>)</div><div class="line">        </div><div class="line">        <span class="comment">// 遍历成员变量获得成员变量的name</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">0</span>..&lt;ivarCount&#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> ivar = ivars?[<span class="type">Int</span>(i)] &#123;</div><div class="line">                <span class="keyword">let</span> key = <span class="type">String</span>(cString: ivar_getName(ivar))</div><div class="line">                <span class="comment">//归档</span></div><div class="line">                aCoder.encode(<span class="keyword">self</span>.value(forKey: key), forKey: key)</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>之前在OC中我们使用runtime的一个场景就是给一个类的category添加属性，同样在swift中我们还是可以这样使用，来给类的extension添加存储属性，代码如下：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"></div><div class="line"><span class="comment">// MARK: - UIViewController Extension</span></div><div class="line"></div><div class="line">fileprivate <span class="keyword">var</span> foo:<span class="type">Void</span>?</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIViewController</span></span>&#123;</div><div class="line">    </div><div class="line">    <span class="comment">/// set this property to True to disable swipe pop</span></div><div class="line">    <span class="keyword">var</span> foo:<span class="type">Bool</span>&#123;</div><div class="line">        <span class="keyword">get</span>&#123;</div><div class="line">            <span class="keyword">return</span> objc_getAssociatedObject(<span class="keyword">self</span>, &amp;foo) <span class="keyword">as</span>? <span class="type">Bool</span> ?? <span class="literal">false</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">set</span>&#123;</div><div class="line">            objc_setAssociatedObject(<span class="keyword">self</span>, &amp;foo, newValue, .<span class="type">OBJC_ASSOCIATION_RETAIN_NONATOMIC</span>)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在上面的代码中我们就给UIViewController的extension添加一个foo的属性。</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/Xcode/" rel="tag"># Xcode</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/03/07/用Carthage构建自己的Framework/" rel="next" title="用Carthage构建自己的Framework">
                <i class="fa fa-chevron-left"></i> 用Carthage构建自己的Framework
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/01/30/基础算法(堆排序)/" rel="prev" title="基础算法(堆排序)">
                基础算法(堆排序) <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2017/01/30/基础算法(堆排序)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                基础算法(堆排序)
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-01-30T14:32:05+08:00">
                2017-01-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/01/30/基础算法(堆排序)/" class="leancloud_visitors" data-flag-title="基础算法(堆排序)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><a href="https://zh.wikipedia.org/wiki/%E5%A0%86%E6%8E%92%E5%BA%8F" target="_blank" rel="external">堆排序（Heapsort）</a>是指利用堆这种数据结构所设计的一种排序算法。堆积是一个近似完全二叉树的结构，并同时满足堆积的性质：即子结点的键值或索引总是小于（或者大于）它的父节点。</p>
<h4 id="算法步骤"><a href="#算法步骤" class="headerlink" title="算法步骤"></a>算法步骤</h4><ol>
<li><p>先将初始文件Array[1..n]建成一个大根堆，此堆为初始的无序区。</p>
</li>
<li><p>再将关键字最大的记录Array[1]（即堆顶）和无序区的最后一个记录Array[n]交换，由此得到新的无序区Array[1..n-1]和有序区Array[n]，然后再把无序区建成一个大根堆，然后再次将Array[1..n-1]中关键字最大的记录Array[1]和该区间的最后一个记录Array[n-1]交换.</p>
</li>
</ol>
<p>下面是算法的Swift实现:</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">/// 将Array中的index位置堆化</span></div><div class="line"><span class="comment">///</span></div><div class="line"><span class="comment">/// - Parameters:</span></div><div class="line"><span class="comment">///   - array: 数组</span></div><div class="line"><span class="comment">///   - index: 位置</span></div><div class="line"><span class="comment">///   - end: 数组的最后位置</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">maxHeapify</span><span class="params">(array: <span class="keyword">inout</span> [Int], index:Int, end:Int)</span></span>&#123;</div><div class="line">    <span class="keyword">var</span> parentIndex = index</div><div class="line">    <span class="keyword">var</span> endIndex = end</div><div class="line">    </div><div class="line">    <span class="keyword">while</span> <span class="literal">true</span> &#123;</div><div class="line">        <span class="keyword">var</span> leftChildIndex = parentIndex * <span class="number">2</span> + <span class="number">1</span></div><div class="line">        <span class="keyword">var</span> rightChildIndex = leftChildIndex + <span class="number">1</span></div><div class="line">        </div><div class="line">        <span class="keyword">var</span> childIndex = leftChildIndex</div><div class="line">        <span class="keyword">if</span> childIndex &gt; endIndex &#123;</div><div class="line">            <span class="keyword">break</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> childIndex + <span class="number">1</span> &lt;= endIndex &amp;&amp; array[leftChildIndex] &lt; array[rightChildIndex] &#123;</div><div class="line">            childIndex += <span class="number">1</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> array[parentIndex] &lt; array[childIndex]&#123;</div><div class="line">            <span class="built_in">swap</span>(&amp;array[childIndex], &amp;array[parentIndex])</div><div class="line">            parentIndex = childIndex</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            <span class="keyword">break</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/// 创建大根堆</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">creatMaxHeap</span><span class="params">(array: <span class="keyword">inout</span> [Int])</span></span>&#123;</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> (<span class="number">0</span>...(array.<span class="built_in">count</span> - <span class="number">1</span>) / <span class="number">2</span>).reversed()&#123;</div><div class="line">        maxHeapify(array: &amp;array, index: i, end: array.<span class="built_in">count</span> - <span class="number">1</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">/// 堆排序</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">heapSort</span><span class="params">(array: <span class="keyword">inout</span> [Int])</span></span>&#123;</div><div class="line">    creatMaxHeap(array: &amp;array)</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> (<span class="number">0</span>...array.<span class="built_in">count</span> - <span class="number">1</span>).reversed()&#123;</div><div class="line">        <span class="keyword">if</span> i != <span class="number">0</span>&#123;</div><div class="line">            <span class="built_in">swap</span>(&amp;array[<span class="number">0</span>], &amp;array[i])</div><div class="line">        &#125;</div><div class="line">        maxHeapify(array: &amp;array, index: <span class="number">0</span>, end: i - <span class="number">1</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/算法/" rel="tag"># 算法</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/02/15/Runtime相关-Swift应用/" rel="next" title="Runtime相关-Swift">
                <i class="fa fa-chevron-left"></i> Runtime相关-Swift
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/01/29/基础算法(快速排序)/" rel="prev" title="基础算法(快速排序)">
                基础算法(快速排序) <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2017/01/29/基础算法(快速排序)/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                基础算法(快速排序)
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-01-29T14:52:05+08:00">
                2017-01-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/01/29/基础算法(快速排序)/" class="leancloud_visitors" data-flag-title="基础算法(快速排序)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><a href="https://zh.wikipedia.org/wiki/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F" target="_blank" rel="external">Quicksort</a>又称划分交换排序，最早由东尼·霍尔提出。在平均状况下，排序n个项目要Ο(n log n)次比较。在最坏状况下则需要Ο(n2)次比较，但这种状况并不常见。事实上，快速排序通常明显比其他Ο(n log n)算法更快，因为它的内部循环（inner loop）可以在大部分的架构上很有效率地被实现出来。</p>
<p>快速排序使用分治法（Divide and conquer）策略来把一个串行（list）分为两个子串行（sub-lists）。</p>
<h4 id="算法步骤"><a href="#算法步骤" class="headerlink" title="算法步骤"></a>算法步骤</h4><ol>
<li>从数列中挑出一个元素，称为 “基准”（pivot），</li>
<li>重新排序数列，所有元素比基准值小的摆放在基准前面，所有元素比基准值大的摆在基准的后面（相同的数可以到任一边）。在这个分区退出之后，该基准就处于数列的中间位置。这个称为分区（partition）操作。</li>
<li>递归地（recursive）把小于基准值元素的子数列和大于基准值元素的子数列排序。</li>
</ol>
<p>递归的最底部情形，是数列的大小是零或一，也就是永远都已经被排序好了。虽然一直递归下去，但是这个算法总会退出，因为在每次的迭代（iteration）中，它至少会把一个元素摆到它最后的位置去。</p>
<h4 id="Swift代码"><a href="#Swift代码" class="headerlink" title="Swift代码"></a>Swift代码</h4><p>由上面的步骤我们可以写出一个简单的快排算法：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">quickSortSimple</span><span class="params">(array:[Int])</span></span> -&gt; [<span class="type">Int</span>]&#123;</div><div class="line">    <span class="keyword">if</span> array.<span class="built_in">count</span> &lt;= <span class="number">1</span> &#123;</div><div class="line">        <span class="keyword">return</span> array</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> lowArray = [<span class="type">Int</span>](), highArray = [<span class="type">Int</span>]()</div><div class="line">    <span class="keyword">var</span> pivot = array.first!</div><div class="line">    </div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="number">1</span>...array.<span class="built_in">count</span> - <span class="number">1</span>&#123;</div><div class="line">        <span class="keyword">let</span> num = array[i]</div><div class="line">        <span class="keyword">if</span> num &gt; pivot&#123;</div><div class="line">            highArray.append(num)</div><div class="line">        &#125;<span class="keyword">else</span>&#123;</div><div class="line">            lowArray.append(num)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> result = quickSortSimple(array: lowArray)</div><div class="line">    result.append(pivot)</div><div class="line">    <span class="keyword">let</span> highResult = quickSortSimple(array: highArray)</div><div class="line">    result.append(contentsOf: highResult)</div><div class="line">    <span class="keyword">return</span> result</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>上面简单版本有个缺点，就是它需要Ω(n)的额外存储空间。额外需要的存储器空间配置，在实际上的实现，也会极度影响速度和缓存的性能。有一个比较复杂使用原地（in-place）分区算法的版本如下:</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">partition</span><span class="params">(a: <span class="keyword">inout</span> [Int],low:Int,high:Int)</span></span> -&gt; <span class="type">Int</span>&#123;</div><div class="line">    <span class="keyword">if</span> low &gt;= high&#123;</div><div class="line">        <span class="keyword">return</span> low</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">let</span> pivot = a[low]</div><div class="line">    <span class="keyword">var</span> i = low, j = high</div><div class="line">    <span class="keyword">while</span> i &lt; j &#123;</div><div class="line">        <span class="keyword">while</span> i &lt; j &amp;&amp; a[j] &gt;= pivot &#123;</div><div class="line">            j -= <span class="number">1</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">while</span> i &lt; j &amp;&amp; a[i] &lt;= pivot &#123;</div><div class="line">            i += <span class="number">1</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">if</span> i &lt; j &#123;</div><div class="line">            <span class="built_in">swap</span>(&amp;a[i], &amp;a[j])</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> i != low&#123;</div><div class="line">        <span class="built_in">swap</span>(&amp;a[i], &amp;a[low])</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> i</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">quickSort</span><span class="params">(array: <span class="keyword">inout</span> [Int], low:Int, high:Int)</span></span>&#123;</div><div class="line">    <span class="keyword">if</span> low &gt; high&#123;</div><div class="line">        <span class="keyword">return</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">let</span> index = <span class="built_in">partition</span>(a: &amp;array, low: low, high: high)</div><div class="line">    <span class="built_in">quickSort</span>(array: &amp;array, low: low, high: index - <span class="number">1</span>)</div><div class="line">    <span class="built_in">quickSort</span>(array: &amp;array, low: index + <span class="number">1</span>, high: high)</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/算法/" rel="tag"># 算法</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/01/30/基础算法(堆排序)/" rel="next" title="基础算法(堆排序)">
                <i class="fa fa-chevron-left"></i> 基础算法(堆排序)
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/01/23/Swift3中的GCD/" rel="prev" title="Swift3中的GCD">
                Swift3中的GCD <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2017/01/23/Swift3中的GCD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Swift3中的GCD
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-01-23T23:17:25+08:00">
                2017-01-23
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/01/23/Swift3中的GCD/" class="leancloud_visitors" data-flag-title="Swift3中的GCD">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>在swift3中苹果重写了dispatch的API,让开发者使用更加方便了</p>
<p>下面是使用方法：</p>
<ul>
<li>dispatch_after</li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">extension</span> <span class="title">DispatchQueue</span> </span>&#123;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">var</span> _onceTracker = [<span class="type">String</span>]()</div><div class="line">    </div><div class="line">    <span class="comment">/// 实现Swift3中取消的dispatch_once</span></div><div class="line">    <span class="comment">///</span></div><div class="line">    <span class="comment">/// - Parameters:</span></div><div class="line">    <span class="comment">///   - token: 一个唯一化的字符串，可以自定义也可以使用UUID. eg. NSUUID().uuidString</span></div><div class="line">    <span class="comment">///   - block: 只需执行一次的代码</span></div><div class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">once</span>(<span class="title">token</span>: <span class="title">String</span>, <span class="title">block</span>:(<span class="title">Void</span>)-&gt;<span class="title">Void</span>) </span>&#123;</div><div class="line">        objc_sync_enter(<span class="keyword">self</span>); <span class="keyword">defer</span> &#123; objc_sync_exit(<span class="keyword">self</span>) &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> _onceTracker.<span class="built_in">contains</span>(token) &#123;</div><div class="line">            <span class="keyword">return</span></div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        _onceTracker.append(token)</div><div class="line">        block()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">/*</span></div><div class="line">    上述方法有一个官方的解决方案：</div><div class="line">     Dispatch The free function dispatch_once is no longer available in Swift. In Swift, you can use lazily initialized globals or static properties and get the same thread-safety and called-once guarantees as dispatch_once provided. Example:</div><div class="line">     </div><div class="line">     static let doOnce = &#123; … global contains initialization in a call to a closure … &#125;()</div><div class="line">     _ = doOnce // using myGlobal will invoke the initialization code only the first time it is used.</div><div class="line">     </div><div class="line">    */</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>自定义队列</li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">//这是官方文档的初始化方法</span></div><div class="line"><span class="keyword">convenience</span> <span class="keyword">init</span>(label: <span class="type">String</span>, qos: <span class="type">DispatchQoS</span> = <span class="keyword">default</span>,</div><div class="line">                attributes: <span class="type">DispatchQueue</span>.<span class="type">Attributes</span> = <span class="keyword">default</span>,</div><div class="line">                autoreleaseFrequency: <span class="type">DispatchQueue</span>.<span class="type">AutoreleaseFrequency</span> = <span class="keyword">default</span>,</div><div class="line">                target: <span class="type">DispatchQueue</span>? = <span class="keyword">default</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// 没有传参数的时候默认创建串行队列，async异步执行，所以他会开一条线程</span></div><div class="line"><span class="type">DispatchQueue</span>(label: <span class="string">"my_queue"</span>).async &#123;</div><div class="line">    <span class="comment">// do something     </span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//传入attributes为.concurrent时创建并行队列，异步执行，所以他会开多条线程</span></div><div class="line"><span class="type">DispatchQueue</span>(label: <span class="string">"concurrent_queue"</span>, attributes: .concurrent).async &#123;</div><div class="line">    <span class="comment">// do something        </span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>关于GCD有人总结了一个口诀，总结的很好：</p>
<blockquote>
<p>同步不开异步开，串行开1条，并行开多条。</p>
</blockquote>
<p>队列中的任务同步执行，队列就不具有开启线程的能力， 队列中的任务异步执行，队列就具有开启线程的能力。<br>（同步和异步执行决定的是否有开启线程的能力）</p>
<p>如果队列具 有开启线程的能力 (队列任务异步执行) 且队列是 串行队列 ，那么将会 开启 1 条线程 。<br>如果队列具 有开启线程的能力 (队列任务异步执行) 且队列是 并发队列 ，那么将会 开启 多 条线程 。开启线程的条数由 GCD 决定。<br>( 串行和并发决定的是开几条线程 )</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/Swift/" rel="tag"># Swift</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/01/29/基础算法(快速排序)/" rel="next" title="基础算法(快速排序)">
                <i class="fa fa-chevron-left"></i> 基础算法(快速排序)
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/01/15/iOS小Tips/" rel="prev" title="iOS小Tips">
                iOS小Tips <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2017/01/15/iOS小Tips/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                iOS小Tips
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-01-15T18:16:29+08:00">
                2017-01-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/01/15/iOS小Tips/" class="leancloud_visitors" data-flag-title="iOS小Tips">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h4 id="1，打印View所有子视图"><a href="#1，打印View所有子视图" class="headerlink" title="1，打印View所有子视图"></a>1，打印View所有子视图</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">po [[<span class="keyword">self</span> view]recursiveDescription]</div></pre></td></tr></table></figure>
<h4 id="2，layoutSubviews调用的调用时机"><a href="#2，layoutSubviews调用的调用时机" class="headerlink" title="2，layoutSubviews调用的调用时机"></a>2，layoutSubviews调用的调用时机</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line">* 当视图第一次显示的时候会被调用。</div><div class="line">* 添加子视图也会调用这个方法。</div><div class="line">* 当本视图的大小发生改变的时候是会调用的。</div><div class="line">* 当子视图的frame发生改变的时候是会调用的。</div><div class="line">* 当删除子视图的时候是会调用的.</div></pre></td></tr></table></figure>
<h4 id="3，NSString过滤特殊字符"><a href="#3，NSString过滤特殊字符" class="headerlink" title="3，NSString过滤特殊字符"></a>3，NSString过滤特殊字符</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">// 定义一个特殊字符的集合</span></div><div class="line"><span class="built_in">NSCharacterSet</span> *set = [<span class="built_in">NSCharacterSet</span> characterSetWithCharactersInString:</div><div class="line"><span class="string">@"@／：；（）¥「」＂、[]&#123;&#125;#%-*+=_\\|~＜＞$€^•'@#$%^&amp;*()_+'\""</span>];</div><div class="line"><span class="comment">// 过滤字符串的特殊字符</span></div><div class="line"><span class="built_in">NSString</span> *newString = [trimString stringByTrimmingCharactersInSet:set];</div></pre></td></tr></table></figure>
<h4 id="4，TransForm属性"><a href="#4，TransForm属性" class="headerlink" title="4，TransForm属性"></a>4，TransForm属性</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">//平移按钮</span></div><div class="line"><span class="built_in">CGAffineTransform</span> transForm = <span class="keyword">self</span>.buttonView.transform;</div><div class="line"><span class="keyword">self</span>.buttonView.transform = <span class="built_in">CGAffineTransformTranslate</span>(transForm, <span class="number">10</span>, <span class="number">0</span>);</div><div class="line"></div><div class="line"><span class="comment">//旋转按钮</span></div><div class="line"><span class="built_in">CGAffineTransform</span> transForm = <span class="keyword">self</span>.buttonView.transform;</div><div class="line"><span class="keyword">self</span>.buttonView.transform = <span class="built_in">CGAffineTransformRotate</span>(transForm, M_PI_4);</div><div class="line"></div><div class="line"><span class="comment">//缩放按钮</span></div><div class="line"><span class="keyword">self</span>.buttonView.transform = <span class="built_in">CGAffineTransformScale</span>(transForm, <span class="number">1.2</span>, <span class="number">1.2</span>);</div><div class="line"></div><div class="line"><span class="comment">//初始化复位</span></div><div class="line"><span class="keyword">self</span>.buttonView.transform = <span class="built_in">CGAffineTransformIdentity</span>;</div></pre></td></tr></table></figure>
<h4 id="5，去掉分割线多余15像素"><a href="#5，去掉分割线多余15像素" class="headerlink" title="5，去掉分割线多余15像素"></a>5，去掉分割线多余15像素</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">//首先在viewDidLoad方法加入以下代码：</span></div><div class="line"><span class="keyword">if</span> ([<span class="keyword">self</span>.tableView respondsToSelector:<span class="keyword">@selector</span>(setSeparatorInset:)]) &#123;</div><div class="line">        [<span class="keyword">self</span>.tableView setSeparatorInset:<span class="built_in">UIEdgeInsetsZero</span>];    </div><div class="line">&#125;   </div><div class="line"><span class="keyword">if</span> ([<span class="keyword">self</span>.tableView respondsToSelector:<span class="keyword">@selector</span>(setLayoutMargins:)]) &#123;        </div><div class="line">[<span class="keyword">self</span>.tableView setLayoutMargins:<span class="built_in">UIEdgeInsetsZero</span>];</div><div class="line">&#125;</div><div class="line"><span class="comment">//然后在重写willDisplayCell方法</span></div><div class="line">- (<span class="keyword">void</span>)tableView:(<span class="built_in">UITableView</span> *)tableView willDisplayCell:(<span class="built_in">UITableViewCell</span> *)cell </div><div class="line">forRowAtIndexPath:(<span class="built_in">NSIndexPath</span> *)indexPath&#123;   </div><div class="line"><span class="keyword">if</span> ([cell respondsToSelector:<span class="keyword">@selector</span>(setSeparatorInset:)]) &#123;       </div><div class="line">[cell setSeparatorInset:<span class="built_in">UIEdgeInsetsZero</span>];    </div><div class="line">&#125;    </div><div class="line"><span class="keyword">if</span> ([cell respondsToSelector:<span class="keyword">@selector</span>(setLayoutMargins:)]) &#123;        </div><div class="line">[cell setLayoutMargins:<span class="built_in">UIEdgeInsetsZero</span>];    </div><div class="line">&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="6，计算方法耗时时间间隔"><a href="#6，计算方法耗时时间间隔" class="headerlink" title="6，计算方法耗时时间间隔"></a>6，计算方法耗时时间间隔</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">// 获取时间间隔</span></div><div class="line"><span class="meta">#define TICK   CFAbsoluteTime start = CFAbsoluteTimeGetCurrent();</span></div><div class="line"><span class="meta">#define TOCK   NSLog(@<span class="meta-string">"Time: %f"</span>, CFAbsoluteTimeGetCurrent() - start)</span></div></pre></td></tr></table></figure>
<h4 id="7，Color颜色宏定义"><a href="#7，Color颜色宏定义" class="headerlink" title="7，Color颜色宏定义"></a>7，Color颜色宏定义</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">// 随机颜色</span></div><div class="line"><span class="meta">#define RANDOM_COLOR [UIColor colorWithRed:arc4random_uniform(256) / 255.0 green:arc4random_uniform(256) / 255.0 blue:arc4random_uniform(256) / 255.0 alpha:1]</span></div><div class="line"><span class="comment">// 颜色(RGB)</span></div><div class="line"><span class="meta">#define RGBCOLOR(r, g, b) [UIColor colorWithRed:(r)/255.0f green:(g)/255.0f blue:(b)/255.0f alpha:1]</span></div><div class="line"><span class="comment">// 利用这种方法设置颜色和透明值，可不影响子视图背景色</span></div><div class="line"><span class="meta">#define RGBACOLOR(r, g, b, a) [UIColor colorWithRed:(r)/255.0f green:(g)/255.0f blue:(b)/255.0f alpha:(a)]</span></div></pre></td></tr></table></figure>
<h4 id="8，让-iOS-应用直接退出"><a href="#8，让-iOS-应用直接退出" class="headerlink" title="8，让 iOS 应用直接退出"></a>8，让 iOS 应用直接退出</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)exitApplication &#123;</div><div class="line">    AppDelegate *app = [<span class="built_in">UIApplication</span> sharedApplication].delegate;</div><div class="line">    <span class="built_in">UIWindow</span> *window = app.window;</div><div class="line"></div><div class="line">    [<span class="built_in">UIView</span> animateWithDuration:<span class="number">1.0</span>f animations:^&#123;</div><div class="line">        window.alpha = <span class="number">0</span>;</div><div class="line">    &#125; completion:^(<span class="built_in">BOOL</span> finished) &#123;</div><div class="line">        exit(<span class="number">0</span>);</div><div class="line">    &#125;];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="9，修改Label中不同文字颜色"><a href="#9，修改Label中不同文字颜色" class="headerlink" title="9，修改Label中不同文字颜色"></a>9，修改Label中不同文字颜色</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)touchesEnded:(<span class="built_in">NSSet</span>&lt;<span class="built_in">UITouch</span> *&gt; *)touches withEvent:(<span class="built_in">UIEvent</span> *)event</div><div class="line">&#123;</div><div class="line">    [<span class="keyword">self</span> editStringColor:<span class="keyword">self</span>.label.text editStr:<span class="string">@"好"</span> color:[<span class="built_in">UIColor</span> blueColor]];</div><div class="line">&#125;</div><div class="line"></div><div class="line">- (<span class="keyword">void</span>)editStringColor:(<span class="built_in">NSString</span> *)string editStr:(<span class="built_in">NSString</span> *)editStr color:(<span class="built_in">UIColor</span> *)color &#123;</div><div class="line">    <span class="comment">// string为整体字符串, editStr为需要修改的字符串</span></div><div class="line">    <span class="built_in">NSRange</span> range = [string rangeOfString:editStr];</div><div class="line"></div><div class="line">    <span class="built_in">NSMutableAttributedString</span> *attribute = [[<span class="built_in">NSMutableAttributedString</span> alloc] initWithString:string];</div><div class="line"></div><div class="line">    <span class="comment">// 设置属性修改字体颜色UIColor与大小UIFont</span></div><div class="line">    [attribute addAttributes:@&#123;<span class="built_in">NSForegroundColorAttributeName</span>:color&#125; range:range];</div><div class="line"></div><div class="line">    <span class="keyword">self</span>.label.attributedText = attribute;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="10，播放声音"><a href="#10，播放声音" class="headerlink" title="10，播放声音"></a>10，播放声音</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="meta">#import<span class="meta-string">&lt;AVFoundation/AVFoundation.h&gt;</span></span></div><div class="line"><span class="comment">//  1.获取音效资源的路径</span></div><div class="line">   <span class="built_in">NSString</span> *path = [[<span class="built_in">NSBundle</span> mainBundle]pathForResource:<span class="string">@"pour_milk"</span> ofType:<span class="string">@"wav"</span>];</div><div class="line"><span class="comment">//  2.将路劲转化为url</span></div><div class="line">   <span class="built_in">NSURL</span> *tempUrl = [<span class="built_in">NSURL</span> fileURLWithPath:path];</div><div class="line"><span class="comment">//  3.用转化成的url创建一个播放器</span></div><div class="line">   <span class="built_in">NSError</span> *error = <span class="literal">nil</span>;</div><div class="line">   <span class="built_in">AVAudioPlayer</span> *play = [[<span class="built_in">AVAudioPlayer</span> alloc]initWithContentsOfURL:tempUrl error:&amp;error];</div><div class="line">   <span class="keyword">self</span>.player = play;</div><div class="line"><span class="comment">//  4.播放</span></div><div class="line">[play play];</div></pre></td></tr></table></figure>
<h4 id="11，修改Tabbar-Item的属性"><a href="#11，修改Tabbar-Item的属性" class="headerlink" title="11，修改Tabbar Item的属性"></a>11，修改Tabbar Item的属性</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">// 修改标题位置</span></div><div class="line"><span class="keyword">self</span>.tabBarItem.titlePositionAdjustment = <span class="built_in">UIOffsetMake</span>(<span class="number">0</span>, <span class="number">-10</span>);</div><div class="line"><span class="comment">// 修改图片位置</span></div><div class="line"><span class="keyword">self</span>.tabBarItem.imageInsets = <span class="built_in">UIEdgeInsetsMake</span>(<span class="number">-3</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="number">0</span>);</div><div class="line"></div><div class="line"><span class="comment">// 批量修改属性</span></div><div class="line"><span class="keyword">for</span> (<span class="built_in">UIBarItem</span> *item <span class="keyword">in</span> <span class="keyword">self</span>.tabBarController.tabBar.items) &#123;</div><div class="line">    [item setTitleTextAttributes:[<span class="built_in">NSDictionary</span> dictionaryWithObjectsAndKeys:</div><div class="line">             [<span class="built_in">UIFont</span> fontWithName:<span class="string">@"Helvetica"</span> size:<span class="number">19.0</span>], <span class="built_in">NSFontAttributeName</span>, <span class="literal">nil</span>]</div><div class="line">                        forState:<span class="built_in">UIControlStateNormal</span>];</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 设置选中和未选中字体颜色</span></div><div class="line">[[<span class="built_in">UITabBar</span> appearance] setShadowImage:[[<span class="built_in">UIImage</span> alloc] init]];</div><div class="line"></div><div class="line"><span class="comment">//未选中字体颜色</span></div><div class="line">[[<span class="built_in">UITabBarItem</span> appearance] setTitleTextAttributes:@&#123;<span class="built_in">NSForegroundColorAttributeName</span>:[<span class="built_in">UIColor</span> greenColor]&#125; forState:<span class="built_in">UIControlStateNormal</span>];</div><div class="line"></div><div class="line"><span class="comment">//选中字体颜色</span></div><div class="line">[[<span class="built_in">UITabBarItem</span> appearance] setTitleTextAttributes:@&#123;<span class="built_in">NSForegroundColorAttributeName</span>:[<span class="built_in">UIColor</span> cyanColor]&#125; forState:<span class="built_in">UIControlStateSelected</span>];</div><div class="line"></div><div class="line"><span class="comment">//去掉BackBarButtonItem的文字</span></div><div class="line">[[<span class="built_in">UIBarButtonItem</span> appearance] setBackButtonTitlePositionAdjustment:<span class="built_in">UIOffsetMake</span>(<span class="number">0</span>, <span class="number">-60</span>)</div><div class="line">                                                         forBarMetrics:<span class="built_in">UIBarMetricsDefault</span>];</div></pre></td></tr></table></figure>
<h4 id="12，NULL-nil-Nil-NSNULL的区别"><a href="#12，NULL-nil-Nil-NSNULL的区别" class="headerlink" title="12，NULL - nil - Nil - NSNULL的区别"></a>12，NULL - nil - Nil - NSNULL的区别</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">* <span class="literal">nil</span>是OC的，空对象，地址指向空（<span class="number">0</span>）的对象。对象的字面零值</div><div class="line"></div><div class="line">* Nil是Objective-C类的字面零值</div><div class="line"></div><div class="line">* <span class="literal">NULL</span>是C的，空地址，地址的数值是<span class="number">0</span>，是个长整数</div><div class="line"></div><div class="line">* <span class="built_in">NSNull</span>用于解决向<span class="built_in">NSArray</span>和<span class="built_in">NSDictionary</span>等集合中添加空值的问题</div></pre></td></tr></table></figure>
<h4 id="13，修改UITextField中Placeholder的文字颜色"><a href="#13，修改UITextField中Placeholder的文字颜色" class="headerlink" title="13，修改UITextField中Placeholder的文字颜色"></a>13，修改UITextField中Placeholder的文字颜色</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">[text setValue:[<span class="built_in">UIColor</span> redColor] forKeyPath:<span class="string">@"_placeholderLabel.textColor"</span>];</div></pre></td></tr></table></figure>
<h4 id="14，生命周期"><a href="#14，生命周期" class="headerlink" title="14，生命周期"></a>14，生命周期</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="number">1</span>、 alloc 创建对象，分配空间</div><div class="line"><span class="number">2</span>、 init (initWithNibName) 初始化对象，初始化数据</div><div class="line"><span class="number">3</span>、 loadView 从nib载入视图 ，除非你没有使用xib文件创建视图</div><div class="line"><span class="number">4</span>、 viewDidLoad 载入完成，可以进行自定义数据以及动态创建其他控件</div><div class="line"><span class="number">5</span>、 viewWillAppear视图将出现在屏幕之前，马上这个视图就会被展现在屏幕上了</div><div class="line"><span class="number">6</span>、 viewDidAppear 视图已在屏幕上渲染完成</div><div class="line"></div><div class="line"><span class="number">1</span>、viewWillDisappear 视图将被从屏幕上移除之前执行</div><div class="line"><span class="number">2</span>、viewDidDisappear 视图已经被从屏幕上移除，用户看不到这个视图了</div><div class="line"><span class="number">3</span>、dealloc 视图被销毁，此处需要对你在init和viewDidLoad中创建的对象进行释放.</div><div class="line"></div><div class="line">viewVillUnload－ 当内存过低，即将释放时调用；</div><div class="line">viewDidUnload－当内存过低，释放一些不需要的视图时调用。</div><div class="line"></div><div class="line">*应用程序的生命周期:</div><div class="line"></div><div class="line"><span class="number">1</span>，启动但还没进入状态保存 ：</div><div class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application willFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions </div><div class="line"></div><div class="line"><span class="number">2</span>，基本完成程序准备开始运行：</div><div class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">UIApplication</span> *)application didFinishLaunchingWithOptions:(<span class="built_in">NSDictionary</span> *)launchOptions</div><div class="line"> </div><div class="line"><span class="number">3</span>，当应用程序将要入非活动状态执行，应用程序不接收消息或事件，比如来电话了：</div><div class="line">- (<span class="keyword">void</span>)applicationWillResignActive:(<span class="built_in">UIApplication</span> *)application </div><div class="line"></div><div class="line"><span class="number">4</span>，当应用程序入活动状态执行，这个刚好跟上面那个方法相反：</div><div class="line">- (<span class="keyword">void</span>)applicationDidBecomeActive:(<span class="built_in">UIApplication</span> *)application   </div><div class="line"></div><div class="line"><span class="number">5</span>，当程序被推送到后台的时候调用。所以要设置后台继续运行，则在这个函数里面设置即可：</div><div class="line">- (<span class="keyword">void</span>)applicationDidEnterBackground:(<span class="built_in">UIApplication</span> *)application  </div><div class="line"></div><div class="line"><span class="number">6</span>，当程序从后台将要重新回到前台时候调用，这个刚好跟上面的那个方法相反：</div><div class="line">- (<span class="keyword">void</span>)applicationWillEnterForeground:(<span class="built_in">UIApplication</span> *)application  </div><div class="line"></div><div class="line"><span class="number">7</span>，当程序将要退出是被调用，通常是用来保存数据和一些退出前的清理工作：</div><div class="line">- (<span class="keyword">void</span>)applicationWillTerminate:(<span class="built_in">UIApplication</span> *)application</div></pre></td></tr></table></figure>
<h4 id="15，判断view是不是指定视图的子视图"><a href="#15，判断view是不是指定视图的子视图" class="headerlink" title="15，判断view是不是指定视图的子视图"></a>15，判断view是不是指定视图的子视图</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="built_in">BOOL</span> isView =  [textView isDescendantOfView:<span class="keyword">self</span>.view];</div></pre></td></tr></table></figure>
<h4 id="16，判断对象是否遵循了某协议"><a href="#16，判断对象是否遵循了某协议" class="headerlink" title="16，判断对象是否遵循了某协议"></a>16，判断对象是否遵循了某协议</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="keyword">if</span> ([<span class="keyword">self</span>.selectedController conformsToProtocol:<span class="class"><span class="keyword">@protocol</span>(<span class="title">RefreshPtotocol</span>)]) </span>&#123;</div><div class="line">    [<span class="keyword">self</span>.selectedController performSelector:<span class="keyword">@selector</span>(onTriggerRefresh)];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="17，页面强制横屏"><a href="#17，页面强制横屏" class="headerlink" title="17，页面强制横屏"></a>17，页面强制横屏</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="meta">#pragma mark - 强制横屏代码</span></div><div class="line">- (<span class="built_in">BOOL</span>)shouldAutorotate&#123;    </div><div class="line"><span class="comment">//是否支持转屏       </span></div><div class="line"><span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">&#125;</div><div class="line">- (<span class="built_in">UIInterfaceOrientationMask</span>)supportedInterfaceOrientations&#123;    </div><div class="line"><span class="comment">//支持哪些转屏方向    </span></div><div class="line"><span class="keyword">return</span> <span class="built_in">UIInterfaceOrientationMaskLandscape</span>;</div><div class="line">&#125;</div><div class="line">- (<span class="built_in">UIInterfaceOrientation</span>)preferredInterfaceOrientationForPresentation&#123;               </div><div class="line"><span class="keyword">return</span> <span class="built_in">UIInterfaceOrientationLandscapeRight</span>;</div><div class="line">&#125;</div><div class="line">- (<span class="built_in">BOOL</span>)prefersStatusBarHidden&#123;   </div><div class="line"><span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="18，系统键盘通知消息"><a href="#18，系统键盘通知消息" class="headerlink" title="18，系统键盘通知消息"></a>18，系统键盘通知消息</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="number">1</span>、<span class="built_in">UIKeyboardWillShowNotification</span>-将要弹出键盘</div><div class="line"><span class="number">2</span>、<span class="built_in">UIKeyboardDidShowNotification</span>-显示键盘</div><div class="line"><span class="number">3</span>、<span class="built_in">UIKeyboardWillHideNotification</span>-将要隐藏键盘</div><div class="line"><span class="number">4</span>、<span class="built_in">UIKeyboardDidHideNotification</span>-键盘已经隐藏</div><div class="line"><span class="number">5</span>、<span class="built_in">UIKeyboardWillChangeFrameNotification</span>-键盘将要改变frame</div><div class="line"><span class="number">6</span>、<span class="built_in">UIKeyboardDidChangeFrameNotification</span>-键盘已经改变frame</div></pre></td></tr></table></figure>
<h4 id="19，关闭navigationController的滑动返回手势"><a href="#19，关闭navigationController的滑动返回手势" class="headerlink" title="19，关闭navigationController的滑动返回手势"></a>19，关闭navigationController的滑动返回手势</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="keyword">self</span>.navigationController.interactivePopGestureRecognizer.enabled = <span class="literal">NO</span>;</div></pre></td></tr></table></figure>
<h4 id="20，设置状态栏背景为任意的颜色"><a href="#20，设置状态栏背景为任意的颜色" class="headerlink" title="20，设置状态栏背景为任意的颜色"></a>20，设置状态栏背景为任意的颜色</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">- (<span class="keyword">void</span>)setStatusColor</div><div class="line">&#123;</div><div class="line">    <span class="built_in">UIView</span> *statusBarView = [[<span class="built_in">UIView</span> alloc] initWithFrame:<span class="built_in">CGRectMake</span>(<span class="number">0</span>, <span class="number">0</span>,[<span class="built_in">UIScreen</span> mainScreen].bounds.size.width, <span class="number">20</span>)];</div><div class="line">    statusBarView.backgroundColor = [<span class="built_in">UIColor</span> orangeColor];</div><div class="line">    [<span class="keyword">self</span>.view addSubview:statusBarView];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="21，让Xcode的控制台支持LLDB类型的打印"><a href="#21，让Xcode的控制台支持LLDB类型的打印" class="headerlink" title="21，让Xcode的控制台支持LLDB类型的打印"></a>21，让Xcode的控制台支持LLDB类型的打印</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">打开终端输入三条命令:</div><div class="line">touch ~/.lldbinit</div><div class="line">echo display <span class="keyword">@import</span> <span class="built_in">UIKit</span> &gt;&gt; ~/.lldbinit</div><div class="line">echo target stop-hook add -o \<span class="string">"target stop-hook disable\" &gt;&gt; ~/.lldbinit</span></div></pre></td></tr></table></figure>
<h4 id="22，Label行间距"><a href="#22，Label行间距" class="headerlink" title="22，Label行间距"></a>22，Label行间距</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">-（<span class="keyword">void</span>）test&#123;</div><div class="line">    <span class="built_in">NSMutableAttributedString</span> *attributedString =    </div><div class="line">    [[<span class="built_in">NSMutableAttributedString</span> alloc] initWithString:<span class="keyword">self</span>.contentLabel.text];</div><div class="line">    <span class="built_in">NSMutableParagraphStyle</span> *paragraphStyle =  [[<span class="built_in">NSMutableParagraphStyle</span> alloc] init];  </div><div class="line">    [paragraphStyle setLineSpacing:<span class="number">3</span>];</div><div class="line"></div><div class="line">    <span class="comment">//调整行间距       </span></div><div class="line">    [attributedString addAttribute:<span class="built_in">NSParagraphStyleAttributeName</span> </div><div class="line">                                    value:paragraphStyle </div><div class="line">                                    range:<span class="built_in">NSMakeRange</span>(<span class="number">0</span>, [<span class="keyword">self</span>.contentLabel.text length])];</div><div class="line">    <span class="keyword">self</span>.contentLabel.attributedText = attributedString;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="23，UIImageView填充模式"><a href="#23，UIImageView填充模式" class="headerlink" title="23，UIImageView填充模式"></a>23，UIImageView填充模式</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="string">@"UIViewContentModeScaleToFill"</span>,      <span class="comment">// 拉伸自适应填满整个视图  </span></div><div class="line"><span class="string">@"UIViewContentModeScaleAspectFit"</span>,   <span class="comment">// 自适应比例大小显示  </span></div><div class="line"><span class="string">@"UIViewContentModeScaleAspectFill"</span>,  <span class="comment">// 原始大小显示  </span></div><div class="line"><span class="string">@"UIViewContentModeRedraw"</span>,           <span class="comment">// 尺寸改变时重绘  </span></div><div class="line"><span class="string">@"UIViewContentModeCenter"</span>,           <span class="comment">// 中间  </span></div><div class="line"><span class="string">@"UIViewContentModeTop"</span>,              <span class="comment">// 顶部  </span></div><div class="line"><span class="string">@"UIViewContentModeBottom"</span>,           <span class="comment">// 底部  </span></div><div class="line"><span class="string">@"UIViewContentModeLeft"</span>,             <span class="comment">// 中间贴左  </span></div><div class="line"><span class="string">@"UIViewContentModeRight"</span>,            <span class="comment">// 中间贴右  </span></div><div class="line"><span class="string">@"UIViewContentModeTopLeft"</span>,          <span class="comment">// 贴左上  </span></div><div class="line"><span class="string">@"UIViewContentModeTopRight"</span>,         <span class="comment">// 贴右上  </span></div><div class="line"><span class="string">@"UIViewContentModeBottomLeft"</span>,       <span class="comment">// 贴左下  </span></div><div class="line"><span class="string">@"UIViewContentModeBottomRight"</span>,      <span class="comment">// 贴右下</span></div></pre></td></tr></table></figure>
<h4 id="24，宏定义检测block是否可用"><a href="#24，宏定义检测block是否可用" class="headerlink" title="24，宏定义检测block是否可用"></a>24，宏定义检测block是否可用</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="meta">#define BLOCK_EXEC(block, ...) if (block) &#123; block(__VA_ARGS__); &#125;;   </span></div><div class="line"><span class="comment">// 宏定义之前的用法</span></div><div class="line"> <span class="keyword">if</span> (completionBlock)   &#123;   </div><div class="line">    completionBlock(arg1, arg2); </div><div class="line"> &#125;    </div><div class="line"><span class="comment">// 宏定义之后的用法</span></div><div class="line">BLOCK_EXEC(completionBlock, arg1, arg2);</div></pre></td></tr></table></figure>
<h4 id="25，设置状态栏文字样式颜色"><a href="#25，设置状态栏文字样式颜色" class="headerlink" title="25，设置状态栏文字样式颜色"></a>25，设置状态栏文字样式颜色</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">[[<span class="built_in">UIApplication</span> sharedApplication] setStatusBarHidden:<span class="literal">NO</span>];</div><div class="line">[[<span class="built_in">UIApplication</span> sharedApplication] setStatusBarStyle:<span class="built_in">UIStatusBarStyleLightContent</span>];</div></pre></td></tr></table></figure>
<h4 id="26，iOS中的一些手势"><a href="#26，iOS中的一些手势" class="headerlink" title="*26，iOS中的一些手势"></a>*26，iOS中的一些手势</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">轻击手势（TapGestureRecognizer）</div><div class="line">轻扫手势（SwipeGestureRecognizer）</div><div class="line">长按手势（LongPressGestureRecognizer）</div><div class="line">拖动手势（PanGestureRecognizer）</div><div class="line">捏合手势（PinchGestureRecognizer）</div><div class="line">旋转手势（RotationGestureRecognizer）</div></pre></td></tr></table></figure>
<h4 id="27，iOS-开发中一些相关的路径"><a href="#27，iOS-开发中一些相关的路径" class="headerlink" title="27，iOS 开发中一些相关的路径"></a>27，iOS 开发中一些相关的路径</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">模拟器的位置:</div><div class="line">/Applications/Xcode.app/Contents/Developer/Platforms/iPhoneSimulator.platform/Developer/SDKs </div><div class="line"></div><div class="line">文档安装位置:</div><div class="line">/Applications/Xcode.app/Contents/Developer/Documentation/DocSets</div><div class="line"></div><div class="line">插件保存路径:</div><div class="line">~/Library/ApplicationSupport/Developer/Shared/Xcode/Plug-ins</div><div class="line"></div><div class="line">自定义代码段的保存路径:</div><div class="line">~/Library/Developer/Xcode/UserData/CodeSnippets/ </div><div class="line">如果找不到CodeSnippets文件夹，可以自己新建一个CodeSnippets文件夹。</div><div class="line"></div><div class="line">证书路径</div><div class="line">~/Library/MobileDevice/Provisioning Profiles</div></pre></td></tr></table></figure>
<h4 id="28，获取-iOS-路径的方法"><a href="#28，获取-iOS-路径的方法" class="headerlink" title="28，获取 iOS 路径的方法"></a>28，获取 iOS 路径的方法</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">获取用户目录路径的函数</div><div class="line"><span class="built_in">NSString</span> *homeDir = <span class="built_in">NSHomeDirectory</span>();</div><div class="line"></div><div class="line">获取Documents目录路径的方法</div><div class="line"><span class="built_in">NSArray</span> *paths = <span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSDocumentDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>);</div><div class="line"><span class="built_in">NSString</span> *docDir = [paths objectAtIndex:<span class="number">0</span>];</div><div class="line"></div><div class="line">获取Cache目录路径的方法</div><div class="line"><span class="built_in">NSArray</span> *paths = <span class="built_in">NSSearchPathForDirectoriesInDomains</span>(<span class="built_in">NSCachesDirectory</span>, <span class="built_in">NSUserDomainMask</span>, <span class="literal">YES</span>);</div><div class="line"><span class="built_in">NSString</span> *cachesDir = [paths objectAtIndex:<span class="number">0</span>];</div><div class="line"></div><div class="line">获取tmp目录路径的方法：</div><div class="line"><span class="built_in">NSString</span> *tmpDir = <span class="built_in">NSTemporaryDirectory</span>();</div></pre></td></tr></table></figure>
<h4 id="29，字符串相关操作"><a href="#29，字符串相关操作" class="headerlink" title="29，字符串相关操作"></a>29，字符串相关操作</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">去除所有的空格</div><div class="line">[str stringByReplacingOccurrencesOfString:<span class="string">@" "</span> withString:<span class="string">@""</span>]</div><div class="line"></div><div class="line">去除首尾的空格</div><div class="line">[str stringByTrimmingCharactersInSet:[<span class="built_in">NSCharacterSet</span> whitespaceCharacterSet]];</div><div class="line"></div><div class="line">- (<span class="built_in">NSString</span> *)uppercaseString; 全部字符转为大写字母</div><div class="line">- (<span class="built_in">NSString</span> *)lowercaseString 全部字符转为小写字母</div></pre></td></tr></table></figure>
<h4 id="30，-CocoaPods-pod-install-pod-update更新慢的问题"><a href="#30，-CocoaPods-pod-install-pod-update更新慢的问题" class="headerlink" title="30， CocoaPods pod install/pod update更新慢的问题"></a>30， CocoaPods pod install/pod update更新慢的问题</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">pod install --verbose --no-repo-update </div><div class="line">pod update --verbose --no-repo-update</div><div class="line">如果不加后面的参数，默认会升级CocoaPods的spec仓库，加一个参数可以省略这一步，然后速度就会提升不少。</div></pre></td></tr></table></figure>
<h4 id="31，MRC和ARC混编设置方式"><a href="#31，MRC和ARC混编设置方式" class="headerlink" title="31，MRC和ARC混编设置方式"></a>31，MRC和ARC混编设置方式</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">在<span class="built_in">XCode</span>中targets的build phases选项下Compile Sources下选择 不需要arc编译的文件</div><div class="line">双击输入 -fno-objc-arc 即可</div><div class="line"></div><div class="line">MRC工程中也可以使用ARC的类，方法如下：</div><div class="line">在<span class="built_in">XCode</span>中targets的build phases选项下Compile Sources下选择要使用arc编译的文件</div><div class="line">双击输入 -fobjc-arc 即可</div></pre></td></tr></table></figure>
<h4 id="32，把tableview里cell的小对勾的颜色改成别的颜色"><a href="#32，把tableview里cell的小对勾的颜色改成别的颜色" class="headerlink" title="32，把tableview里cell的小对勾的颜色改成别的颜色"></a>32，把tableview里cell的小对勾的颜色改成别的颜色</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">_mTableView.tintColor = [<span class="built_in">UIColor</span> redColor];</div></pre></td></tr></table></figure>
<h4 id="33，调整tableview的separaLine线的位置"><a href="#33，调整tableview的separaLine线的位置" class="headerlink" title="33，调整tableview的separaLine线的位置"></a>33，调整tableview的separaLine线的位置</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">tableView.separatorInset = <span class="built_in">UIEdgeInsetsMake</span>(<span class="number">0</span>, <span class="number">100</span>, <span class="number">0</span>, <span class="number">0</span>);</div></pre></td></tr></table></figure>
<h4 id="34，设置滑动的时候隐藏navigationbar"><a href="#34，设置滑动的时候隐藏navigationbar" class="headerlink" title="34，设置滑动的时候隐藏navigationbar"></a>34，设置滑动的时候隐藏navigationbar</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">navigationController.hidesBarsOnSwipe = Yes</div></pre></td></tr></table></figure>
<h4 id="35，自动处理键盘事件，实现输入框防遮挡的插件"><a href="#35，自动处理键盘事件，实现输入框防遮挡的插件" class="headerlink" title="35，自动处理键盘事件，实现输入框防遮挡的插件**"></a>35，自动处理键盘事件，实现输入框防遮挡的插件**</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">IQKeyboardManager</div><div class="line">https:<span class="comment">//github.com/hackiftekhar/IQKeyboardManager</span></div></pre></td></tr></table></figure>
<h4 id="36，Quartz2D相关"><a href="#36，Quartz2D相关" class="headerlink" title="36，Quartz2D相关"></a>36，Quartz2D相关</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">图形上下文是一个<span class="built_in">CGContextRef</span>类型的数据。</div><div class="line">图形上下文包含：</div><div class="line"><span class="number">1</span>，绘图路径（各种各样图形）</div><div class="line"><span class="number">2</span>，绘图状态（颜色，线宽，样式，旋转，缩放，平移）</div><div class="line"><span class="number">3</span>，输出目标（绘制到什么地方去？<span class="built_in">UIView</span>、图片）</div><div class="line"></div><div class="line"><span class="number">1</span>，获取当前图形上下文</div><div class="line"><span class="built_in">CGContextRef</span> ctx = <span class="built_in">UIGraphicsGetCurrentContext</span>();</div><div class="line"><span class="number">2</span>，添加线条</div><div class="line"><span class="built_in">CGContextMoveToPoint</span>(ctx, <span class="number">20</span>, <span class="number">20</span>);</div><div class="line"><span class="number">3</span>，渲染</div><div class="line"><span class="built_in">CGContextStrokePath</span>(ctx);</div><div class="line"><span class="built_in">CGContextFillPath</span>(ctx);</div><div class="line"><span class="number">4</span>，关闭路径</div><div class="line"><span class="built_in">CGContextClosePath</span>(ctx);</div><div class="line"><span class="number">5</span>，画矩形</div><div class="line"><span class="built_in">CGContextAddRect</span>(ctx, <span class="built_in">CGRectMake</span>(<span class="number">20</span>, <span class="number">20</span>, <span class="number">100</span>, <span class="number">120</span>));</div><div class="line"><span class="number">6</span>，设置线条颜色</div><div class="line">[[<span class="built_in">UIColor</span> redColor] setStroke];</div><div class="line"><span class="number">7</span>， 设置线条宽度</div><div class="line"><span class="built_in">CGContextSetLineWidth</span>(ctx, <span class="number">20</span>);</div><div class="line"><span class="number">8</span>，设置头尾样式</div><div class="line"><span class="built_in">CGContextSetLineCap</span>(ctx, kCGLineCapSquare);</div><div class="line"><span class="number">9</span>，设置转折点样式</div><div class="line"><span class="built_in">CGContextSetLineJoin</span>(ctx, kCGLineJoinBevel);</div><div class="line"><span class="number">10</span>，画圆</div><div class="line"><span class="built_in">CGContextAddEllipseInRect</span>(ctx, <span class="built_in">CGRectMake</span>(<span class="number">30</span>, <span class="number">50</span>, <span class="number">100</span>, <span class="number">100</span>));</div><div class="line"><span class="number">11</span>，指定圆心</div><div class="line"><span class="built_in">CGContextAddArc</span>(ctx, <span class="number">100</span>, <span class="number">100</span>, <span class="number">50</span>, <span class="number">0</span>, M_PI * <span class="number">2</span>, <span class="number">1</span>);</div><div class="line"><span class="number">12</span>，获取图片上下文</div><div class="line"><span class="built_in">UIGraphicsGetImageFromCurrentImageContext</span>();</div><div class="line"><span class="number">13</span>，保存图形上下文</div><div class="line"><span class="built_in">CGContextSaveGState</span>(ctx)</div><div class="line"><span class="number">14</span>，恢复图形上下文</div><div class="line"><span class="built_in">CGContextRestoreGState</span>(ctx)</div></pre></td></tr></table></figure>
<h4 id="37，屏幕截图"><a href="#37，屏幕截图" class="headerlink" title="37，屏幕截图"></a>37，屏幕截图</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">// 1. 开启一个与图片相关的图形上下文</span></div><div class="line"><span class="built_in">UIGraphicsBeginImageContextWithOptions</span>(<span class="keyword">self</span>.view.bounds.size,<span class="literal">NO</span>,<span class="number">0.0</span>);</div><div class="line"></div><div class="line"><span class="comment">// 2. 获取当前图形上下文</span></div><div class="line"><span class="built_in">CGContextRef</span> ctx = <span class="built_in">UIGraphicsGetCurrentContext</span>();</div><div class="line"></div><div class="line"><span class="comment">// 3. 获取需要截取的view的layer</span></div><div class="line">[<span class="keyword">self</span>.view.layer renderInContext:ctx];</div><div class="line"></div><div class="line"><span class="comment">// 4. 从当前上下文中获取图片</span></div><div class="line"><span class="built_in">UIImage</span> *image = <span class="built_in">UIGraphicsGetImageFromCurrentImageContext</span>();</div><div class="line"></div><div class="line"><span class="comment">// 5. 关闭图形上下文</span></div><div class="line"><span class="built_in">UIGraphicsEndImageContext</span>();</div><div class="line"></div><div class="line"><span class="comment">// 6. 把图片保存到相册</span></div><div class="line"><span class="built_in">UIImageWriteToSavedPhotosAlbum</span>(image, <span class="literal">nil</span>, <span class="literal">nil</span>, <span class="literal">nil</span>);</div></pre></td></tr></table></figure>
<h4 id="37，左右抖动动画"><a href="#37，左右抖动动画" class="headerlink" title="37，左右抖动动画"></a>37，左右抖动动画</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">//1, 创建核心动画</span></div><div class="line"><span class="built_in">CAKeyframeAnimation</span> *keyAnima = [<span class="built_in">CAKeyframeAnimation</span> animation]; </div><div class="line"></div><div class="line"><span class="comment">//2, 告诉系统执行什么动画。</span></div><div class="line">keyAnima.keyPath = <span class="string">@"transform.rotation"</span>; </div><div class="line">keyAnima.values = @[@(-M_PI_4 /<span class="number">90.0</span> * <span class="number">5</span>),@(M_PI_4 /<span class="number">90.0</span> * <span class="number">5</span>),@(-M_PI_4 /<span class="number">90.0</span> * <span class="number">5</span>)]; </div><div class="line"></div><div class="line"><span class="comment">//  3, 执行完之后不删除动画 </span></div><div class="line">keyAnima.removedOnCompletion = <span class="literal">NO</span>; </div><div class="line"></div><div class="line"><span class="comment">// 4, 执行完之后保存最新的状态 </span></div><div class="line">keyAnima.fillMode = kCAFillModeForwards; </div><div class="line"></div><div class="line"><span class="comment">// 5, 动画执行时间 </span></div><div class="line">keyAnima.duration = <span class="number">0.2</span>; </div><div class="line"></div><div class="line"><span class="comment">// 6, 设置重复次数。 </span></div><div class="line">keyAnima.repeatCount = MAXFLOAT; </div><div class="line"></div><div class="line"><span class="comment">// 7, 添加核心动画 </span></div><div class="line">[<span class="keyword">self</span>.iconView.layer addAnimation:keyAnima forKey:<span class="literal">nil</span>];</div></pre></td></tr></table></figure>
<h4 id="38，CALayer-的知识"><a href="#38，CALayer-的知识" class="headerlink" title="38，CALayer 的知识"></a>38，CALayer 的知识</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="built_in">CALayer</span>  负责视图中显示内容和动画</div><div class="line"><span class="built_in">UIView</span>     负责监听和响应事件</div><div class="line"></div><div class="line">创建<span class="built_in">UIView</span>对象时，<span class="built_in">UIView</span>内部会自动创建一个图层（既<span class="built_in">CALayer</span>）</div><div class="line"><span class="built_in">UIView</span>本身不具备显示的功能，是它内部的层才有显示功能.</div><div class="line"></div><div class="line"><span class="built_in">CALayer</span>属性：</div><div class="line">position  中点（由anchorPoint决定）</div><div class="line">anchorPoint 锚点</div><div class="line">borderColor 边框颜色</div><div class="line">borderWidth 边框宽度</div><div class="line">cornerRadius 圆角半径</div><div class="line">shadowColor 阴影颜色</div><div class="line">contents 内容</div><div class="line">opacity 透明度</div><div class="line">shadowOpacity 偏移</div><div class="line">shadowRadius 阴影半径</div><div class="line">shadowColor 阴影颜色</div><div class="line">masksToBounds 裁剪</div></pre></td></tr></table></figure>
<h4 id="39，性能相关"><a href="#39，性能相关" class="headerlink" title="39，性能相关"></a>39，性能相关</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="number">1.</span> 视图复用,比如<span class="built_in">UITableViewCell</span>,<span class="built_in">UICollectionViewCell</span>.</div><div class="line"><span class="number">2.</span> 数据缓存,比如用SDWebImage实现图片缓存。</div><div class="line"><span class="number">3.</span> 任何情况下都不能堵塞主线程，把耗时操作尽量放到子线程。</div><div class="line"><span class="number">4.</span> 如果有多个下载同时并发，可以控制并发数。</div><div class="line"><span class="number">5.</span> 在合适的地方尽量使用懒加载。</div><div class="line"><span class="number">6.</span> 重用重大开销对象，比如：<span class="built_in">NSDateFormatter</span>、<span class="built_in">NSCalendar</span>。</div><div class="line"><span class="number">7.</span> 选择合适的数据存储。</div><div class="line"><span class="number">8.</span> 避免循环引用。避免delegate用<span class="keyword">retain</span>、<span class="keyword">strong</span>修饰，block可能导致循环引用，<span class="built_in">NSTimer</span>也可能导致内存泄露等。</div><div class="line"><span class="number">9.</span> 当涉及到定位的时候，不用的时候最好把定位服务关闭。因为定位耗电、流量。</div><div class="line"><span class="number">10.</span> 加锁对性能有重大开销。</div><div class="line"><span class="number">11.</span> 界面最好不要添加过多的subViews.</div><div class="line"><span class="number">12.</span> TableView 如果不同行高，那么返回行高，最好做缓存。</div><div class="line"><span class="number">13.</span> Viewdidload 里尽量不要做耗时操作。</div></pre></td></tr></table></figure>
<h4 id="40，验证身份证号码"><a href="#40，验证身份证号码" class="headerlink" title="40，验证身份证号码"></a>40，验证身份证号码</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">//验证身份证号码</span></div><div class="line">- (<span class="built_in">BOOL</span>)checkIdentityCardNo:(<span class="built_in">NSString</span>*)cardNo</div><div class="line">&#123;</div><div class="line">    <span class="keyword">if</span> (cardNo.length != <span class="number">18</span>) &#123;</div><div class="line">        <span class="keyword">return</span>  <span class="literal">NO</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="built_in">NSArray</span>* codeArray = [<span class="built_in">NSArray</span> arrayWithObjects:<span class="string">@"7"</span>,<span class="string">@"9"</span>,<span class="string">@"10"</span>,<span class="string">@"5"</span>,<span class="string">@"8"</span>,<span class="string">@"4"</span>,<span class="string">@"2"</span>,<span class="string">@"1"</span>,<span class="string">@"6"</span>,<span class="string">@"3"</span>,<span class="string">@"7"</span>,<span class="string">@"9"</span>,<span class="string">@"10"</span>,<span class="string">@"5"</span>,<span class="string">@"8"</span>,<span class="string">@"4"</span>,<span class="string">@"2"</span>, <span class="literal">nil</span>];</div><div class="line">    <span class="built_in">NSDictionary</span>* checkCodeDic = [<span class="built_in">NSDictionary</span> dictionaryWithObjects:[<span class="built_in">NSArray</span> arrayWithObjects:<span class="string">@"1"</span>,<span class="string">@"0"</span>,<span class="string">@"X"</span>,<span class="string">@"9"</span>,<span class="string">@"8"</span>,<span class="string">@"7"</span>,<span class="string">@"6"</span>,<span class="string">@"5"</span>,<span class="string">@"4"</span>,<span class="string">@"3"</span>,<span class="string">@"2"</span>, <span class="literal">nil</span>]  forKeys:[<span class="built_in">NSArray</span> arrayWithObjects:<span class="string">@"0"</span>,<span class="string">@"1"</span>,<span class="string">@"2"</span>,<span class="string">@"3"</span>,<span class="string">@"4"</span>,<span class="string">@"5"</span>,<span class="string">@"6"</span>,<span class="string">@"7"</span>,<span class="string">@"8"</span>,<span class="string">@"9"</span>,<span class="string">@"10"</span>, <span class="literal">nil</span>]];</div><div class="line"></div><div class="line">    <span class="built_in">NSScanner</span>* scan = [<span class="built_in">NSScanner</span> scannerWithString:[cardNo substringToIndex:<span class="number">17</span>]];</div><div class="line"></div><div class="line">    <span class="keyword">int</span> val;</div><div class="line">    <span class="built_in">BOOL</span> isNum = [scan scanInt:&amp;val] &amp;&amp; [scan isAtEnd];</div><div class="line">    <span class="keyword">if</span> (!isNum) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">int</span> sumValue = <span class="number">0</span>;</div><div class="line"></div><div class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i =<span class="number">0</span>; i&lt;<span class="number">17</span>; i++) &#123;</div><div class="line">        sumValue+=[[cardNo substringWithRange:<span class="built_in">NSMakeRange</span>(i , <span class="number">1</span>) ] intValue]* [[codeArray objectAtIndex:i] intValue];</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="built_in">NSString</span>* strlast = [checkCodeDic objectForKey:[<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%d"</span>,sumValue%<span class="number">11</span>]];</div><div class="line"></div><div class="line">    <span class="keyword">if</span> ([strlast isEqualToString: [[cardNo substringWithRange:<span class="built_in">NSMakeRange</span>(<span class="number">17</span>, <span class="number">1</span>)]uppercaseString]]) &#123;</div><div class="line">        <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span>  <span class="literal">NO</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="41，响应者链条顺序"><a href="#41，响应者链条顺序" class="headerlink" title="41，响应者链条顺序"></a>41，响应者链条顺序</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="number">1</span>&gt; 当应用程序启动以后创建 <span class="built_in">UIApplication</span> 对象</div><div class="line"></div><div class="line"><span class="number">2</span>&gt; 然后启动“消息循环”监听所有的事件</div><div class="line"></div><div class="line"><span class="number">3</span>&gt; 当用户触摸屏幕的时候, <span class="string">"消息循环"</span>监听到这个触摸事件</div><div class="line"></div><div class="line"><span class="number">4</span>&gt; <span class="string">"消息循环"</span> 首先把监听到的触摸事件传递了 <span class="built_in">UIApplication</span> 对象</div><div class="line"></div><div class="line"><span class="number">5</span>&gt; <span class="built_in">UIApplication</span> 对象再传递给 <span class="built_in">UIWindow</span> 对象</div><div class="line"></div><div class="line"><span class="number">6</span>&gt; <span class="built_in">UIWindow</span> 对象再传递给 <span class="built_in">UIWindow</span> 的根控制器(rootViewController)</div><div class="line"></div><div class="line"><span class="number">7</span>&gt; 控制器再传递给控制器所管理的 view</div><div class="line"></div><div class="line"><span class="number">8</span>&gt; 控制器所管理的 View 在其内部搜索看本次触摸的点在哪个控件的范围内（调用Hit test检测是否在这个范围内）</div><div class="line"></div><div class="line"><span class="number">9</span>&gt; 找到某个控件以后(调用这个控件的 touchesXxx 方法), 再一次向上返回, 最终返回给<span class="string">"消息循环"</span></div><div class="line"></div><div class="line"><span class="number">10</span>&gt; <span class="string">"消息循环"</span>知道哪个按钮被点击后, 在搜索这个按钮是否注册了对应的事件, 如果注册了, 那么就调用这个<span class="string">"事件处理"</span>程序。（一般就是执行控制器中的<span class="string">"事件处理"</span>方法）</div></pre></td></tr></table></figure>
<h4 id="42，使用函数式指针执行方法和忽略performSelector方法的时候警告"><a href="#42，使用函数式指针执行方法和忽略performSelector方法的时候警告" class="headerlink" title="42，使用函数式指针执行方法和忽略performSelector方法的时候警告"></a>42，使用函数式指针执行方法和忽略performSelector方法的时候警告</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">//不带参数的：</span></div><div class="line">SEL selector = <span class="built_in">NSSelectorFromString</span>(<span class="string">@"someMethod"</span>);</div><div class="line">IMP imp = [_controller methodForSelector:selector];</div><div class="line"><span class="keyword">void</span> (*func)(<span class="keyword">id</span>, SEL) = (<span class="keyword">void</span> *)imp;</div><div class="line">func(_controller, selector);</div><div class="line"></div><div class="line"><span class="comment">//带参数的：</span></div><div class="line">SEL selector = <span class="built_in">NSSelectorFromString</span>(<span class="string">@"processRegion:ofView:"</span>);</div><div class="line">IMP imp = [_controller methodForSelector:selector];</div><div class="line"><span class="built_in">CGRect</span> (*func)(<span class="keyword">id</span>, SEL, <span class="built_in">CGRect</span>, <span class="built_in">UIView</span> *) = (<span class="keyword">void</span> *)imp;</div><div class="line"><span class="built_in">CGRect</span> result = func(_controller, selector, someRect, someView);</div><div class="line"></div><div class="line"><span class="comment">//忽略警告：</span></div><div class="line"><span class="meta">#pragma clang diagnostic push </span></div><div class="line"><span class="meta">#pragma clang diagnostic ignored <span class="meta-string">"-Warc-performSelector-leaks"</span></span></div><div class="line">[someController performSelector: <span class="built_in">NSSelectorFromString</span>(<span class="string">@"someMethod"</span>)]</div><div class="line"><span class="meta">#pragma clang diagnostic pop</span></div><div class="line"></div><div class="line"><span class="comment">//如果需要忽视的警告有多处，可以定义一个宏：</span></div><div class="line"><span class="meta">#define SuppressPerformSelectorLeakWarning(Stuff) \ </span></div><div class="line"><span class="keyword">do</span> &#123;\ </div><div class="line">_Pragma(<span class="string">"clang diagnostic push"</span>) \ </div><div class="line">_Pragma(<span class="string">"clang diagnostic ignored \"-Warc-performSelector-leaks\""</span>) \</div><div class="line">Stuff; \</div><div class="line">_Pragma(<span class="string">"clang diagnostic pop"</span>) \ </div><div class="line">&#125; <span class="keyword">while</span> (<span class="number">0</span>)</div><div class="line"><span class="comment">//使用方法：</span></div><div class="line">SuppressPerformSelectorLeakWarning( </div><div class="line">[_target performSelector:_action withObject:<span class="keyword">self</span>]</div><div class="line">);</div></pre></td></tr></table></figure>
<h4 id="43，UIApplication的简单使用"><a href="#43，UIApplication的简单使用" class="headerlink" title="43，UIApplication的简单使用"></a>43，UIApplication的简单使用</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">//--------设置角标数字--------</span></div><div class="line"><span class="comment">//获取UIApplication对象</span></div><div class="line">    <span class="built_in">UIApplication</span> *ap = [<span class="built_in">UIApplication</span> sharedApplication];</div><div class="line"><span class="comment">//在设置之前, 要注册一个通知,从ios8之后,都要先注册一个通知对象.才能够接收到提醒.</span></div><div class="line">    <span class="built_in">UIUserNotificationSettings</span> *notice =</div><div class="line">    [<span class="built_in">UIUserNotificationSettings</span> settingsForTypes:<span class="built_in">UIUserNotificationTypeBadge</span> categories:<span class="literal">nil</span>];</div><div class="line"><span class="comment">//注册通知对象</span></div><div class="line">    [ap registerUserNotificationSettings:notice];</div><div class="line"><span class="comment">//设置提醒数字</span></div><div class="line">    ap.applicationIconBadgeNumber = <span class="number">20</span>;</div><div class="line"></div><div class="line"><span class="comment">//--------设置联网状态--------</span></div><div class="line"><span class="built_in">UIApplication</span> *ap = [<span class="built_in">UIApplication</span> sharedApplication];</div><div class="line">ap.networkActivityIndicatorVisible = <span class="literal">YES</span>;</div></pre></td></tr></table></figure>
<h4 id="44-UITableView隐藏空白部分线条"><a href="#44-UITableView隐藏空白部分线条" class="headerlink" title="44, UITableView隐藏空白部分线条"></a>44, UITableView隐藏空白部分线条</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="keyword">self</span>.tableView.tableFooterView =  [[<span class="built_in">UIView</span> alloc]init];</div></pre></td></tr></table></figure>
<h4 id="45，显示git增量的Xcode插件：GitDiff"><a href="#45，显示git增量的Xcode插件：GitDiff" class="headerlink" title="45，显示git增量的Xcode插件：GitDiff"></a>45，显示git增量的Xcode插件：GitDiff</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">下载地址：https:<span class="comment">//github.com/johnno1962/GitDiff</span></div><div class="line">这款插件的名字是GitDiff，作用就是可以显示表示出git增量提交的代码行,会在Xcode左边标识出来</div></pre></td></tr></table></figure>
<h4 id="46，各种收藏的网址"><a href="#46，各种收藏的网址" class="headerlink" title="46，各种收藏的网址"></a>46，各种收藏的网址</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">unicode编码转换</div><div class="line">http:<span class="comment">//tool.chinaz.com/tools/unicode.aspx    </span></div><div class="line"></div><div class="line">JSON 字符串格式化</div><div class="line">http:<span class="comment">//www.runoob.com/jsontool</span></div><div class="line"></div><div class="line">RGB 颜色值转换</div><div class="line">http:<span class="comment">//www.sioe.cn/yingyong/yanse-rgb-16/</span></div><div class="line"></div><div class="line">短网址生成</div><div class="line">http:<span class="comment">//dwz.wailian.work/</span></div><div class="line"></div><div class="line">MAC 软件下载</div><div class="line">http:<span class="comment">//www.waitsun.com/</span></div><div class="line"></div><div class="line">objc 中国</div><div class="line">http:<span class="comment">//objccn.io/</span></div></pre></td></tr></table></figure>
<h4 id="47，NSObject-继承图"><a href="#47，NSObject-继承图" class="headerlink" title="47，NSObject 继承图"></a>47，NSObject 继承图</h4><p><img src="http://oo90m08ev.bkt.clouddn.com/17-4-27/72206646-file_1493286154744_f939.png" alt=""></p>
<h4 id="48，浅拷贝、深拷贝、copy和strong"><a href="#48，浅拷贝、深拷贝、copy和strong" class="headerlink" title="48，浅拷贝、深拷贝、copy和strong"></a>48，浅拷贝、深拷贝、copy和strong</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">浅拷贝：（任何一方的变动都会影响到另一方）</div><div class="line">只是对对象的简单拷贝，让几个对象共用一片内存，当内存销毁的时候，指向这片内存的几个指针</div><div class="line">需要重新定义才可以使用。</div><div class="line"></div><div class="line">深拷贝：（任何一方的变动都不会影响到另一方）</div><div class="line">拷贝对象的具体内容，内存地址是自主分配的，拷贝结束后，两个对象虽然存的值是相同的，但是</div><div class="line">内存地址不一样，两个对象也互不影响，互不干涉。</div><div class="line"></div><div class="line"><span class="keyword">copy</span>和Strong的区别：<span class="keyword">copy</span>是创建一个新对象，Strong是创建一个指针。</div></pre></td></tr></table></figure>
<h4 id="49，SEL-和-IMP"><a href="#49，SEL-和-IMP" class="headerlink" title="49，SEL 和 IMP"></a>49，SEL 和 IMP</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">SEL: 其实是对方法的一种包装,将方法包装成一个SEL类型的数据,去寻找对应的方法地址,找到方法地址后</div><div class="line">就可以调用方法。这些都是运行时特性,发消息就是发送SEL,然后根据SEL找到地址,调用方法。</div><div class="line"></div><div class="line"></div><div class="line">IMP:  是”implementation”的缩写,它是objetive-C 方法 (method)实现代码块的地址,类似函数</div><div class="line">指针,通过它可以 直接访问任意一个方法。免去发送消息的代价。</div></pre></td></tr></table></figure>
<h4 id="50-self-和-super"><a href="#50-self-和-super" class="headerlink" title="50, self 和 super"></a>50, self 和 super</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">在动态方法中，<span class="keyword">self</span>代表着<span class="string">"对象"</span></div><div class="line">在静态方法中，<span class="keyword">self</span>代表着<span class="string">"类"</span></div><div class="line"></div><div class="line">万变不离其宗，记住一句话就行了：</div><div class="line"><span class="keyword">self</span>代表着当前方法的调用者<span class="keyword">self</span> 和 <span class="keyword">super</span> 是oc提供的 两个保留字, 但有根本区别，<span class="keyword">self</span>是类的隐藏的</div><div class="line">参数变量,指向当前调用方法的对象（类也是对象，类对象）</div><div class="line">另一个隐藏参数是_cmd，代表当前类方法的selector。</div><div class="line"></div><div class="line"><span class="keyword">super</span>并不是隐藏的参数,它只是一个<span class="string">"编译器指示符"</span></div><div class="line"><span class="keyword">super</span> 就是个障眼法 发，编译器符号， 它可以替换成 [<span class="keyword">self</span> <span class="keyword">class</span>],只不过 方法是从 <span class="keyword">self</span> 的</div><div class="line">超类开始寻找。</div></pre></td></tr></table></figure>
<h4 id="51-长连接-和-短连接"><a href="#51-长连接-和-短连接" class="headerlink" title="51, 长连接 和 短连接"></a>51, 长连接 和 短连接</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">长连接：（长连接在没有数据通信时，定时发送数据包(心跳)，以维持连接状态）</div><div class="line">连接→数据传输→保持连接(心跳)→数据传输→保持连接(心跳)→……→关闭连接；  </div><div class="line">长连接：连接服务器就不断开</div><div class="line"></div><div class="line">短连接：（短连接在没有数据传输时直接关闭就行了）</div><div class="line">连接→数据传输→关闭连接；</div><div class="line">短连接：连接上服务器，获取完数据，就立即断开。</div></pre></td></tr></table></figure>
<h4 id="52-HTTP-基本状态码"><a href="#52-HTTP-基本状态码" class="headerlink" title="52, HTTP 基本状态码"></a>52, HTTP 基本状态码</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="number">200</span> OK</div><div class="line">请求已成功，请求所希望的响应头或数据体将随此响应返回。</div><div class="line"></div><div class="line"><span class="number">300</span> Multiple Choices</div><div class="line">被请求的资源有一系列可供选择的回馈信息，每个都有自己特定的地址和浏览器驱动的商议信息。用户或浏览器能够自行选择一个首选的地址进行重定向。</div><div class="line"></div><div class="line"><span class="number">400</span> Bad Request</div><div class="line">由于包含语法错误，当前请求无法被服务器理解。除非进行修改，否则客户端不应该重复提交这个请求。</div><div class="line"></div><div class="line"><span class="number">404</span> Not Found</div><div class="line">请求失败，请求所希望得到的资源未被在服务器上发现。没有信息能够告诉用户这个状况到底是暂时的还是永久的。假如服务器知道情况的话，应当使用<span class="number">410</span>状态码来告知旧资源因为某些内部的配置机制问题，已经永久的不可用，而且没有任何可以跳转的地址。<span class="number">404</span>这个状态码被广泛应用于当服务器不想揭示到底为何请求被拒绝或者没有其他适合的响应可用的情况下。</div><div class="line"></div><div class="line"><span class="number">408</span> Request Timeout</div><div class="line">请求超时。客户端没有在服务器预备等待的时间内完成一个请求的发送。客户端可以随时再次提交这一请求而无需进行任何更改。</div><div class="line"></div><div class="line"><span class="number">500</span> Internal Server Error</div><div class="line">服务器遇到了一个未曾预料的状况，导致了它无法完成对请求的处理。一般来说，这个问题都会在服务器的程序码出错时出现。</div></pre></td></tr></table></figure>
<h4 id="53-TCP-和-UDP"><a href="#53-TCP-和-UDP" class="headerlink" title="53, TCP 和 UDP"></a>53, TCP 和 UDP</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">TCP：</div><div class="line"></div><div class="line">- 建立连接，形成传输数据的通道</div><div class="line">- 在连接中进行大数据传输（数据大小受限制）</div><div class="line">- 通过三次握手完成连接，是可靠协议</div><div class="line">- 必须建立连接，效率比UDP低</div><div class="line"></div><div class="line">UDP:</div><div class="line"></div><div class="line">- 只管发送，不管接受</div><div class="line">- 将数据以及源和目的封装成数据包中，不需要建立连接、</div><div class="line">- 每个数据报的大小限制在<span class="number">64</span>K之内</div><div class="line">- 不可靠协议</div><div class="line">- 速度快</div></pre></td></tr></table></figure>
<h4 id="54-三次握手和四次断开"><a href="#54-三次握手和四次断开" class="headerlink" title="54, 三次握手和四次断开"></a>54, 三次握手和四次断开</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">三次握手：</div><div class="line">你在吗-我在的-我问你个事情</div><div class="line">四次断开握手</div><div class="line">我这个问题问完了--你问完了吗---可以下线了吗---我真的问完了拜拜</div></pre></td></tr></table></figure>
<h4 id="55-设置按钮按下时候高亮"><a href="#55-设置按钮按下时候高亮" class="headerlink" title="55, 设置按钮按下时候高亮"></a>55, 设置按钮按下时候高亮</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">button.showsTouchWhenHighlighted=<span class="literal">YES</span>;</div></pre></td></tr></table></figure>
<h4 id="56-ScrollView莫名其妙不能在viewController划到顶怎么办？"><a href="#56-ScrollView莫名其妙不能在viewController划到顶怎么办？" class="headerlink" title="56, ScrollView莫名其妙不能在viewController划到顶怎么办？"></a>56, ScrollView莫名其妙不能在viewController划到顶怎么办？</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="keyword">self</span>.automaticallyAdjustsScrollViewInsets = <span class="literal">NO</span>;</div></pre></td></tr></table></figure>
<h4 id="57，复制字符串到iOS剪贴板"><a href="#57，复制字符串到iOS剪贴板" class="headerlink" title="57，复制字符串到iOS剪贴板"></a>57，复制字符串到iOS剪贴板</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="built_in">UIPasteboard</span> *pasteboard = [<span class="built_in">UIPasteboard</span> generalPasteboard];</div><div class="line">pasteboard.string = <span class="keyword">self</span>.label.text;</div></pre></td></tr></table></figure>
<h4 id="58，线程租调度事例"><a href="#58，线程租调度事例" class="headerlink" title="58，线程租调度事例"></a>58，线程租调度事例</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">//  群组－统一监控一组任务</span></div><div class="line">dispatch_group_t group = dispatch_group_create();</div><div class="line"></div><div class="line"><span class="built_in">dispatch_queue_t</span> q = dispatch_get_global_queue(<span class="number">0</span>, <span class="number">0</span>);</div><div class="line"><span class="comment">// 添加任务</span></div><div class="line"><span class="comment">// group 负责监控任务，queue 负责调度任务</span></div><div class="line">dispatch_group_async(group, q, ^&#123;</div><div class="line">[<span class="built_in">NSThread</span> sleepForTimeInterval:<span class="number">1.0</span>];</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"任务1 %@"</span>, [<span class="built_in">NSThread</span> currentThread]);</div><div class="line">&#125;);</div><div class="line">dispatch_group_async(group, q, ^&#123;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"任务2 %@"</span>, [<span class="built_in">NSThread</span> currentThread]);</div><div class="line">&#125;);</div><div class="line">dispatch_group_async(group, q, ^&#123;</div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"任务3 %@"</span>, [<span class="built_in">NSThread</span> currentThread]);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 监听所有任务完成 － 等到 group 中的所有任务执行完毕后，"由队列调度 block 中的任务异步执行！"</span></div><div class="line">dispatch_group_notify(group, dispatch_get_main_queue(), ^&#123;</div><div class="line"><span class="comment">// 修改为主队列，后台批量下载，结束后，主线程统一更新UI</span></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"OK %@"</span>, [<span class="built_in">NSThread</span> currentThread]);</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="built_in">NSLog</span>(<span class="string">@"come here"</span>);</div></pre></td></tr></table></figure>
<h4 id="59、视图坐标转换"><a href="#59、视图坐标转换" class="headerlink" title="59、视图坐标转换"></a>59、视图坐标转换</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">// 将像素point由point所在视图转换到目标视图view中，返回在目标视图view中的像素值</span></div><div class="line">- (<span class="built_in">CGPoint</span>)convertPoint:(<span class="built_in">CGPoint</span>)point toView:(<span class="built_in">UIView</span> *)view;</div><div class="line"><span class="comment">// 将像素point从view中转换到当前视图中，返回在当前视图中的像素值</span></div><div class="line">- (<span class="built_in">CGPoint</span>)convertPoint:(<span class="built_in">CGPoint</span>)point fromView:(<span class="built_in">UIView</span> *)view;</div><div class="line"></div><div class="line"><span class="comment">// 将rect由rect所在视图转换到目标视图view中，返回在目标视图view中的rect</span></div><div class="line">- (<span class="built_in">CGRect</span>)convertRect:(<span class="built_in">CGRect</span>)rect toView:(<span class="built_in">UIView</span> *)view;</div><div class="line"><span class="comment">// 将rect从view中转换到当前视图中，返回在当前视图中的rect</span></div><div class="line">- (<span class="built_in">CGRect</span>)convertRect:(<span class="built_in">CGRect</span>)rect fromView:(<span class="built_in">UIView</span> *)view;</div><div class="line"></div><div class="line"><span class="comment">// 例把UITableViewCell中的subview(btn)的frame转换到controllerA中</span></div><div class="line"><span class="comment">// controllerA 中有一个UITableView, UITableView里有多行UITableVieCell，cell上放有一个button</span></div><div class="line"><span class="comment">// 在controllerA中实现:</span></div><div class="line"><span class="built_in">CGRect</span> rc = [cell convertRect:cell.btn.frame toView:<span class="keyword">self</span>.view];</div><div class="line"><span class="comment">//或</span></div><div class="line"><span class="built_in">CGRect</span> rc = [<span class="keyword">self</span>.view convertRect:cell.btn.frame fromView:cell];</div><div class="line"><span class="comment">// 此rc为btn在controllerA中的rect</span></div><div class="line"></div><div class="line"><span class="comment">//或当已知btn时：</span></div><div class="line"><span class="built_in">CGRect</span> rc = [btn.superview convertRect:btn.frame toView:<span class="keyword">self</span>.view];</div><div class="line"><span class="comment">//或</span></div><div class="line"><span class="built_in">CGRect</span> rc = [<span class="keyword">self</span>.view convertRect:btn.frame fromView:btn.superview];</div></pre></td></tr></table></figure>
<h4 id="60、设置animation动画终了，不返回初始状态"><a href="#60、设置animation动画终了，不返回初始状态" class="headerlink" title="60、设置animation动画终了，不返回初始状态"></a>60、设置animation动画终了，不返回初始状态</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">animation.removedOnCompletion = <span class="literal">NO</span>;</div><div class="line">animation.fillMode = kCAFillModeForwards;</div></pre></td></tr></table></figure>
<h4 id="61、UIViewAnimationOptions类型"><a href="#61、UIViewAnimationOptions类型" class="headerlink" title="61、UIViewAnimationOptions类型"></a>61、UIViewAnimationOptions类型</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="number">1.</span>常规动画属性设置（可以同时选择多个进行设置）</div><div class="line"><span class="built_in">UIViewAnimationOptionLayoutSubviews</span>：动画过程中保证子视图跟随运动。</div><div class="line"><span class="built_in">UIViewAnimationOptionAllowUserInteraction</span>：动画过程中允许用户交互。</div><div class="line"><span class="built_in">UIViewAnimationOptionBeginFromCurrentState</span>：所有视图从当前状态开始运行。</div><div class="line"><span class="built_in">UIViewAnimationOptionRepeat</span>：重复运行动画。</div><div class="line"><span class="built_in">UIViewAnimationOptionAutoreverse</span> ：动画运行到结束点后仍然以动画方式回到初始点。</div><div class="line"><span class="built_in">UIViewAnimationOptionOverrideInheritedDuration</span>：忽略嵌套动画时间设置。</div><div class="line"><span class="built_in">UIViewAnimationOptionOverrideInheritedCurve</span>：忽略嵌套动画速度设置。</div><div class="line"><span class="built_in">UIViewAnimationOptionAllowAnimatedContent</span>：动画过程中重绘视图（注意仅仅适用于转场动画）。  </div><div class="line"><span class="built_in">UIViewAnimationOptionShowHideTransitionViews</span>：视图切换时直接隐藏旧视图、显示新视图，而不是将旧视图从父视图移除（仅仅适用于转场动画）<span class="built_in">UIViewAnimationOptionOverrideInheritedOptions</span> ：不继承父动画设置或动画类型。</div><div class="line"><span class="number">2.</span>动画速度控制（可从其中选择一个设置）</div><div class="line"><span class="built_in">UIViewAnimationOptionCurveEaseInOut</span>：动画先缓慢，然后逐渐加速。</div><div class="line"><span class="built_in">UIViewAnimationOptionCurveEaseIn</span> ：动画逐渐变慢。</div><div class="line"><span class="built_in">UIViewAnimationOptionCurveEaseOut</span>：动画逐渐加速。</div><div class="line"><span class="built_in">UIViewAnimationOptionCurveLinear</span> ：动画匀速执行，默认值。</div><div class="line"><span class="number">3.</span>转场类型（仅适用于转场动画设置，可以从中选择一个进行设置，基本动画、关键帧动画不需要设置）</div><div class="line"><span class="built_in">UIViewAnimationOptionTransitionNone</span>：没有转场动画效果。</div><div class="line"><span class="built_in">UIViewAnimationOptionTransitionFlipFromLeft</span> ：从左侧翻转效果。</div><div class="line"><span class="built_in">UIViewAnimationOptionTransitionFlipFromRight</span>：从右侧翻转效果。</div><div class="line"><span class="built_in">UIViewAnimationOptionTransitionCurlUp</span>：向后翻页的动画过渡效果。    </div><div class="line"><span class="built_in">UIViewAnimationOptionTransitionCurlDown</span> ：向前翻页的动画过渡效果。    </div><div class="line"><span class="built_in">UIViewAnimationOptionTransitionCrossDissolve</span>：旧视图溶解消失显示下一个新视图的效果。    </div><div class="line"><span class="built_in">UIViewAnimationOptionTransitionFlipFromTop</span> ：从上方翻转效果。    </div><div class="line"><span class="built_in">UIViewAnimationOptionTransitionFlipFromBottom</span>：从底部翻转效果。</div></pre></td></tr></table></figure>
<h4 id="62、获取当前View所在的控制器"><a href="#62、获取当前View所在的控制器" class="headerlink" title="62、获取当前View所在的控制器"></a>62、获取当前View所在的控制器</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">/** 获取当前View所在的控制器*/</span></div><div class="line">-(<span class="built_in">UIViewController</span> *)getCurrentViewController&#123;</div><div class="line">    <span class="built_in">UIResponder</span> *next = [<span class="keyword">self</span> nextResponder];</div><div class="line">    <span class="keyword">do</span> &#123;</div><div class="line">        <span class="keyword">if</span> ([next isKindOfClass:[<span class="built_in">UIViewController</span> <span class="keyword">class</span>]]) &#123;</div><div class="line">            <span class="keyword">return</span> (<span class="built_in">UIViewController</span> *)next;</div><div class="line">        &#125;</div><div class="line">        next = [next nextResponder];</div><div class="line">    &#125; <span class="keyword">while</span> (next != <span class="literal">nil</span>); </div><div class="line">    <span class="keyword">return</span> <span class="literal">nil</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="63、iOS横向滚动的scrollView和系统pop手势返回冲突的解决办法"><a href="#63、iOS横向滚动的scrollView和系统pop手势返回冲突的解决办法" class="headerlink" title="63、iOS横向滚动的scrollView和系统pop手势返回冲突的解决办法"></a>63、iOS横向滚动的scrollView和系统pop手势返回冲突的解决办法</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">- (<span class="built_in">BOOL</span>)gestureRecognizer:(<span class="built_in">UIGestureRecognizer</span> *)gestureRecognizer shouldRecognizeSimultaneouslyWithGestureRecognizer:(<span class="built_in">UIGestureRecognizer</span> *)otherGestureRecognizer&#123;</div><div class="line">    <span class="comment">// 首先判断otherGestureRecognizer是不是系统pop手势</span></div><div class="line">    <span class="keyword">if</span> ([otherGestureRecognizer.view isKindOfClass:<span class="built_in">NSClassFromString</span>(<span class="string">@"UILayoutContainerView"</span>)]) &#123;</div><div class="line">        <span class="comment">// 再判断系统手势的state是began还是fail，同时判断scrollView的位置是不是正好在最左边</span></div><div class="line">        <span class="keyword">if</span> (otherGestureRecognizer.state == <span class="built_in">UIGestureRecognizerStateBegan</span> &amp;&amp; <span class="keyword">self</span>.contentOffset.x == <span class="number">0</span>) &#123;</div><div class="line">            <span class="keyword">return</span> <span class="literal">YES</span>;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> <span class="literal">NO</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="64、设置状态栏方向位置"><a href="#64、设置状态栏方向位置" class="headerlink" title="64、设置状态栏方向位置"></a>64、设置状态栏方向位置</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">//修改状态栏方向，</span></div><div class="line">[<span class="built_in">UIApplication</span> sharedApplication].statusBarOrientation = <span class="built_in">UIInterfaceOrientationLandscapeLeft</span>;</div><div class="line"></div><div class="line"><span class="comment">//枚举值说明：</span></div><div class="line"><span class="built_in">UIDeviceOrientationPortraitUpsideDown</span>,  <span class="comment">//设备直立，home按钮在上</span></div><div class="line"><span class="built_in">UIDeviceOrientationLandscapeLeft</span>,       <span class="comment">//设备横置，home按钮在右</span></div><div class="line"><span class="built_in">UIDeviceOrientationLandscapeRight</span>,      <span class="comment">//设备横置, home按钮在左</span></div><div class="line"><span class="built_in">UIDeviceOrientationFaceUp</span>,              <span class="comment">//设备平放，屏幕朝上</span></div><div class="line"><span class="built_in">UIDeviceOrientationFaceDown</span>             <span class="comment">//设备平放，屏幕朝下</span></div><div class="line"></div><div class="line"><span class="comment">//再实现这个代理方法就行了</span></div><div class="line">- (<span class="built_in">BOOL</span>)shouldAutorotate&#123;</div><div class="line">    <span class="keyword">return</span> <span class="literal">NO</span>; <span class="comment">//必须返回no, 才能强制手动旋转</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="65，Git-关联仓库-和基本配置"><a href="#65，Git-关联仓库-和基本配置" class="headerlink" title="65，Git 关联仓库 ,和基本配置"></a>65，Git 关联仓库 ,和基本配置</h4><figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">-------Git global setup-------</div><div class="line"></div><div class="line">git config --global user.name <span class="string">"xinnyu"</span></div><div class="line">git config --global user.email <span class="string">"xinnyu007@gmail.com"</span></div><div class="line"></div><div class="line">-------Create a new repository-------</div><div class="line">git <span class="built_in">clone</span> git@gitlab.testAddress.com:<span class="built_in">test</span>/QRZxing.git</div><div class="line"><span class="built_in">cd</span> QRZxing</div><div class="line">touch README.md</div><div class="line">git add README.mdgit commit -m <span class="string">"add README"</span></div><div class="line">git push -u origin master</div><div class="line"></div><div class="line">-------Existing folder or Git repository-------</div><div class="line"><span class="built_in">cd</span> existing_folder</div><div class="line">git init</div><div class="line">git remote add origin git@gitlab.testAddress.com:<span class="built_in">test</span>/QRZxing.git</div><div class="line">git add .</div><div class="line">git commit</div><div class="line">git push -u origin master</div></pre></td></tr></table></figure>
<h4 id="66，Git-命令大全"><a href="#66，Git-命令大全" class="headerlink" title="66，Git 命令大全"></a>66，Git 命令大全</h4><p><img src="http://upload-images.jianshu.io/upload_images/790890-2233c59924c77b95.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="1234.png"></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/OC/" rel="tag"># OC</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/01/23/Swift3中的GCD/" rel="next" title="Swift3中的GCD">
                <i class="fa fa-chevron-left"></i> Swift3中的GCD
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/01/14/synx使用/" rel="prev" title="synx使用">
                synx使用 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2017/01/14/synx使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                synx使用
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-01-14T19:20:25+08:00">
                2017-01-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/01/14/synx使用/" class="leancloud_visitors" data-flag-title="synx使用">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>synx 是一个命令行工具,用来整理你的Xcode项目文件夹以匹配您的Xcode group。</p>
</blockquote>
<h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p><code>gem install synx</code> </p>
<p>在国内的话可以需要把ruby源替换一下，注意之前的taobao镜像已经不在维护了，现在换成ruby-china在维护，所以替换源的话需要：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line">$ gem sources --add https:<span class="comment">//gems.ruby-china.org/ --remove https://rubygems.org/</span></div><div class="line">$ gem sources -l</div><div class="line"></div><div class="line">https:<span class="comment">//gems.ruby-china.org</span></div><div class="line"># 请确保只有 gems.ruby-china.org</div></pre></td></tr></table></figure>
<p>如果出现权限不够之类的，需要sudo</p>
<h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">// 路径换成自己的项目路径</div><div class="line">$ synx path/to/my/project.xcodeproj</div></pre></td></tr></table></figure>
<p>如果你使用了CocoaPods的话，在你执行了上面的命令之后，需要再 <code>pod install</code> 一下。</p>
<p><strong>注意：使用时请先备份！！！</strong></p>
<h1 id="Tips"><a href="#Tips" class="headerlink" title="Tips"></a>Tips</h1><p>加上-p可以在同步的时候删除工程中没有使用到的图片资源和文件。</p>
<p>如果使用后集成的第三方框架报错 <code>library not found for XXXXXX</code> , 需要添加 Target 的 Build Settings 的 Library Search Paths。</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/Xcode/" rel="tag"># Xcode</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/01/15/iOS小Tips/" rel="next" title="iOS小Tips">
                <i class="fa fa-chevron-left"></i> iOS小Tips
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/01/03/iOS项目的gitignore文件编写/" rel="prev" title="iOS项目的gitignore">
                iOS项目的gitignore <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2017/01/03/iOS项目的gitignore文件编写/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                iOS项目的gitignore
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-01-03T18:19:25+08:00">
                2017-01-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2017/01/03/iOS项目的gitignore文件编写/" class="leancloud_visitors" data-flag-title="iOS项目的gitignore">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>使用<a href="https://www.gitignore.io/" target="_blank" rel="external">gitignore.io</a>的服务就能很好的自动生成一个<code>gitignore</code>文件。</p>
<p>如果是正在开发的Project，可以通过git rm来拿掉xcuserstate。<br>下面有个来自slackoverflow的例子，project是项目名称，username是你电脑的user name。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">git rm --cached [project].xcodeproj/project.xcworkspace/xcuserdata/[username].xcuserdatad/UserInterfaceState.xcuserstate</div><div class="line">git commit -m &quot;Removed file that shouldn&apos;t be tracked&quot;</div></pre></td></tr></table></figure>
<p><a href="http://stackoverflow.com/questions/6564257/cant-ignore-userinterfacestate-xcuserstate" target="_blank" rel="external">xcode - Can’t ignore UserInterfaceState.xcuserstate - Stack Overflow</a></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/Xcode/" rel="tag"># Xcode</a>
          
            <a href="/tags/Git/" rel="tag"># Git</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/01/14/synx使用/" rel="next" title="synx使用">
                <i class="fa fa-chevron-left"></i> synx使用
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/12/25/UIView的几个layout方法-layoutSubviews、layoutIfNeeded、setNeedsLayout/" rel="prev" title="UIView的几个layout方法">
                UIView的几个layout方法 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
        
        <div class="collection-title">
          <h2 class="archive-year motion-element" id="archive-year-2016">2016</h2>
        </div>
      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2016/12/25/UIView的几个layout方法-layoutSubviews、layoutIfNeeded、setNeedsLayout/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                UIView的几个layout方法
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-12-25T10:17:25+08:00">
                2016-12-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2016/12/25/UIView的几个layout方法-layoutSubviews、layoutIfNeeded、setNeedsLayout/" class="leancloud_visitors" data-flag-title="UIView的几个layout方法">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="layoutSubviews"><a href="#layoutSubviews" class="headerlink" title="layoutSubviews"></a>layoutSubviews</h1><p>这个方法，默认没有做任何事情，需要子类进行重写。系统在很多时候会去调用这个方法：</p>
<ol>
<li>初始化不会触发layoutSubviews，但是如果设置了不为CGRectZero的frame的时候就会触发。</li>
<li>addSubview会触发layoutSubviews</li>
<li>设置view的Frame会触发layoutSubviews，当然前提是frame的值设置前后发生了变化</li>
<li>滚动一个UIScrollView会触发layoutSubviews</li>
<li>旋转Screen会触发父UIView上的layoutSubviews事件</li>
<li>改变一个UIView大小的时候也会触发父UIView上的layoutSubviews事件</li>
</ol>
<p>当我们在某个类的内部调整子视图位置时，需要调用。反过来的意思就是说：如果你想要在外部设置subviews的位置，就不要重写。</p>
<h1 id="setNeedsLayout"><a href="#setNeedsLayout" class="headerlink" title="setNeedsLayout"></a>setNeedsLayout</h1><p>标记为需要重新布局，不立即刷新，但layoutSubviews一定会被调用<br>配合layoutIfNeeded立即更新</p>
<h1 id="layoutIfNeeded"><a href="#layoutIfNeeded" class="headerlink" title="layoutIfNeeded"></a>layoutIfNeeded</h1><p>如果有需要刷新的标记，立即调用layoutSubviews进行布局</p>
<p>当你需要通过改变UIView的约束制作动画时，把改变约束的代码放进动画闭包，是不会产生动画的，<br>因为他只是调用了setNeedsLayout方法，并不会立即刷新。</p>
<p>所以我们需要先把约束在动画之前修改好，在动画闭包中执行layoutIfNeeded，这样就能有动画效果了。</p>
<p>如果一些变化不想动画，就在动画前执行layoutIfNeeded</p>
<h1 id="drawRect"><a href="#drawRect" class="headerlink" title="drawRect"></a>drawRect</h1><p>drawRect在以下情况下会被调用：<br>1、如果在UIView初始化时没有设置rect大小，将直接导致drawRect不被自动调用。drawRect调用是在Controller-&gt;loadView, Controller-&gt;viewDidLoad 两方法之后调用的.所以不用担心在控制器中,这些View的drawRect就开始画了.这样可以在控制器中设置一些值给View(如果这些View draw的时候需要用到某些变量值).<br>2、该方法在调用sizeToFit后被调用，所以可以先调用sizeToFit计算出size。然后系统自动调用drawRect:方法。<br>3、通过设置contentMode属性值为UIViewContentModeRedraw。那么将在每次设置或更改frame的时候自动调用drawRect:。<br>4、直接调用setNeedsDisplay，或者setNeedsDisplayInRect:触发drawRect:，但是有个前提条件是rect不能为0。<br>以上1,2推荐；而3,4不提倡</p>
<p>drawRect方法使用注意点：<br>1、若使用UIView绘图，只能在drawRect：方法中获取相应的contextRef并绘图。如果在其他方法中获取将获取到一个invalidate的ref并且不能用于画图。drawRect：方法不能手动显示调用，必须通过调用setNeedsDisplay 或者 setNeedsDisplayInRect，让系统自动调该方法。<br>2、若使用calayer绘图，只能在drawInContext:中（类似于drawRect）绘制，或者在delegate中的相应方法绘制。同样也是调用setNeedDisplay等间接调用以上方法<br>3、若要实时画图，不能使用gestureRecognizer，只能使用touchbegan等方法来掉用setNeedsDisplay实时刷新屏幕</p>
<h1 id="sizeToFit"><a href="#sizeToFit" class="headerlink" title="sizeToFit"></a>sizeToFit</h1><p>sizeToFit会自动调用sizeThatFits方法；<br>sizeToFit不应该在子类中被重写，应该重写sizeThatFits<br>sizeThatFits传入的参数是receiver当前的size，返回一个适合的size<br>sizeToFit可以被手动直接调用sizeToFit和sizeThatFits方法都没有递归，对subviews也不负责，只负责自己</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/01/03/iOS项目的gitignore文件编写/" rel="next" title="iOS项目的gitignore">
                <i class="fa fa-chevron-left"></i> iOS项目的gitignore
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/12/24/iOS,Mac著名开发者博客/" rel="prev" title="iOS,Mac著名开发者博客">
                iOS,Mac著名开发者博客 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2016/12/24/iOS,Mac著名开发者博客/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                iOS,Mac著名开发者博客
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-12-24T12:17:25+08:00">
                2016-12-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2016/12/24/iOS,Mac著名开发者博客/" class="leancloud_visitors" data-flag-title="iOS,Mac著名开发者博客">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <table>
<thead>
<tr>
<th>博客地址</th>
<th>RSS地址</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="http://onevcat.com" target="_blank" rel="external">OneV’s Den</a></td>
<td><a href="http://onevcat.com/atom.xml" target="_blank" rel="external">http://onevcat.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://blog.ibireme.com/" target="_blank" rel="external">一只魔法师的工坊</a></td>
<td><a href="http://blog.ibireme.com/feed/" target="_blank" rel="external">http://blog.ibireme.com/feed/</a></td>
</tr>
<tr>
<td><a href="http://beyondvincent.com" target="_blank" rel="external">破船之家</a></td>
<td><a href="http://beyondvincent.com/atom.xml" target="_blank" rel="external">http://beyondvincent.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://nshipster.cn" target="_blank" rel="external">NSHipster</a></td>
<td><a href="http://nshipster.cn/feed.xml" target="_blank" rel="external">http://nshipster.cn/feed.xml</a></td>
</tr>
<tr>
<td><a href="http://limboy.me/" target="_blank" rel="external">Limboy 无网不剩</a></td>
<td><a href="http://feeds.feedburner.com/lzyy" target="_blank" rel="external">http://feeds.feedburner.com/lzyy</a></td>
</tr>
<tr>
<td><a href="http://blog.devtang.com" target="_blank" rel="external">唐巧的技术博客</a></td>
<td><a href="http://blog.devtang.com/atom.xml" target="_blank" rel="external">http://blog.devtang.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://wufawei.com/" target="_blank" rel="external">Ted’s Homepage</a></td>
<td><a href="http://wufawei.com/feed" target="_blank" rel="external">http://wufawei.com/feed</a></td>
</tr>
<tr>
<td><a href="http://blog.sunnyxx.com/" target="_blank" rel="external">sunnyxx的技术博客</a></td>
<td><a href="http://blog.sunnyxx.com/atom.xml" target="_blank" rel="external">http://blog.sunnyxx.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://zhowkev.in" target="_blank" rel="external">Kevin Blog</a></td>
<td><a href="http://zhowkev.in/rss" target="_blank" rel="external">http://zhowkev.in/rss</a></td>
</tr>
<tr>
<td><a href="http://www.xiangwangfeng.com" target="_blank" rel="external">阿毛的蛋疼地</a></td>
<td><a href="http://www.xiangwangfeng.com/atom.xml" target="_blank" rel="external">http://www.xiangwangfeng.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://billwang1990.github.io" target="_blank" rel="external">亚庆的 Blog</a></td>
<td><a href="http://billwang1990.github.io/atom.xml" target="_blank" rel="external">http://billwang1990.github.io/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://nonomori.farbox.com" target="_blank" rel="external">Nonomori</a></td>
<td><a href="http://nonomori.farbox.com/feed" target="_blank" rel="external">http://nonomori.farbox.com/feed</a></td>
</tr>
<tr>
<td><a href="http://wonderffee.github.io" target="_blank" rel="external">Wonderffee’s Blog</a></td>
<td><a href="http://wonderffee.github.io/atom.xml" target="_blank" rel="external">http://wonderffee.github.io/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://imtx.me" target="_blank" rel="external">I’m TualatriX</a></td>
<td><a href="http://imtx.me/feed/latest/" target="_blank" rel="external">http://imtx.me/feed/latest/</a></td>
</tr>
<tr>
<td><a href="http://blog.cocoabit.com" target="_blank" rel="external">Cocoabit</a></td>
<td><a href="http://blog.cocoabit.com/rss/" target="_blank" rel="external">http://blog.cocoabit.com/rss/</a></td>
</tr>
<tr>
<td><a href="http://studentdeng.github.io" target="_blank" rel="external">不会开机的男孩</a></td>
<td><a href="http://studentdeng.github.io/atom.xml" target="_blank" rel="external">http://studentdeng.github.io/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://blog.inico.me" target="_blank" rel="external">Nico</a></td>
<td><a href="http://blog.inico.me/atom.xml" target="_blank" rel="external">http://blog.inico.me/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://hufeng825.github.io" target="_blank" rel="external">阿峰的技术窝窝</a></td>
<td><a href="http://hufeng825.github.io/atom.xml" target="_blank" rel="external">http://hufeng825.github.io/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://answerhuang.duapp.com" target="_blank" rel="external">answer_huang</a></td>
<td><a href="http://answerhuang.duapp.com/index.php/feed/" target="_blank" rel="external">http://answerhuang.duapp.com/index.php/feed/</a></td>
</tr>
<tr>
<td><a href="http://blog.nswebfrog.com/" target="_blank" rel="external">webfrogs</a></td>
<td><a href="http://blog.nswebfrog.com/feed/" target="_blank" rel="external">http://blog.nswebfrog.com/feed/</a></td>
</tr>
<tr>
<td><a href="http://joeyio.com" target="_blank" rel="external">代码手工艺人</a></td>
<td><a href="http://joeyio.com/atom.xml" target="_blank" rel="external">http://joeyio.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://gracelancy.com" target="_blank" rel="external">Lancy’s Blog</a></td>
<td><a href="http://gracelancy.com/atom.xml" target="_blank" rel="external">http://gracelancy.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://www.imallen.com" target="_blank" rel="external">I’m Allen</a></td>
<td><a href="http://www.imallen.com/atom.xml" target="_blank" rel="external">http://www.imallen.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://imi.im/" target="_blank" rel="external">Travis’ Blog</a></td>
<td><a href="http://imi.im/feed" target="_blank" rel="external">http://imi.im/feed</a></td>
</tr>
<tr>
<td><a href="http://wangzz.github.io/" target="_blank" rel="external">王中周的技术博客</a></td>
<td><a href="http://wangzz.github.io/atom.xml" target="_blank" rel="external">http://wangzz.github.io/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://wangkewei.cnblogs.com/" target="_blank" rel="external">克伟的博客</a></td>
<td><a href="http://feed.cnblogs.com/blog/u/23857/rss" target="_blank" rel="external">http://feed.cnblogs.com/blog/u/23857/rss</a></td>
</tr>
<tr>
<td><a href="http://cnblogs.com/biosli" target="_blank" rel="external">摇滚诗人</a></td>
<td><a href="http://feed.cnblogs.com/blog/u/35410/rss" target="_blank" rel="external">http://feed.cnblogs.com/blog/u/35410/rss</a></td>
</tr>
<tr>
<td><a href="http://geeklu.com/" target="_blank" rel="external">Luke’s Homepage</a></td>
<td><a href="http://geeklu.com/feed/" target="_blank" rel="external">http://geeklu.com/feed/</a></td>
</tr>
<tr>
<td><a href="http://iiiyu.com/" target="_blank" rel="external">萧宸宇</a></td>
<td><a href="http://iiiyu.com/atom.xml" target="_blank" rel="external">http://iiiyu.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://www.heyuan110.com/" target="_blank" rel="external">Yuan博客</a></td>
<td><a href="http://www.heyuan110.com/?feed=rss2" target="_blank" rel="external">http://www.heyuan110.com/?feed=rss2</a></td>
</tr>
<tr>
<td><a href="http://koofrank.com/" target="_blank" rel="external">KooFrank’s Blog</a></td>
<td><a href="http://koofrank.com/rss" target="_blank" rel="external">http://koofrank.com/rss</a></td>
</tr>
<tr>
<td><a href="http://helloitworks.com" target="_blank" rel="external">hello it works</a></td>
<td><a href="http://helloitworks.com/feed" target="_blank" rel="external">http://helloitworks.com/feed</a></td>
</tr>
<tr>
<td><a href="http://msching.github.io/" target="_blank" rel="external">码农人生</a></td>
<td><a href="http://msching.github.io/atom.xml" target="_blank" rel="external">http://msching.github.io/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://yulingtianxia.com" target="_blank" rel="external">玉令天下的Blog</a></td>
<td><a href="http://yulingtianxia.com/atom.xml" target="_blank" rel="external">http://yulingtianxia.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://www.hotobear.com/" target="_blank" rel="external">不掏蜂窝的熊</a></td>
<td><a href="http://www.hotobear.com/?feed=rss2" target="_blank" rel="external">http://www.hotobear.com/?feed=rss2</a></td>
</tr>
<tr>
<td><a href="https://andelf.github.io/" target="_blank" rel="external">猫·仁波切</a></td>
<td><a href="https://andelf.github.io/atom.xml" target="_blank" rel="external">https://andelf.github.io/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://ivoryxiong.org/" target="_blank" rel="external">煲仔饭</a></td>
<td><a href="http://ivoryxiong.org/feed.xml" target="_blank" rel="external">http://ivoryxiong.org/feed.xml</a></td>
</tr>
<tr>
<td><a href="http://adad184.com" target="_blank" rel="external">里脊串的开发随笔</a></td>
<td><a href="http://adad184.com/atom.xml" target="_blank" rel="external">http://adad184.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://blog.callmewhy.com/" target="_blank" rel="external">Why’s blog - 汪海的实验室</a></td>
<td><a href="http://blog.callmewhy.com/atom.xml" target="_blank" rel="external">http://blog.callmewhy.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://tutuge.me/" target="_blank" rel="external">土土哥的技术Blog</a></td>
<td><a href="http://tutuge.me/atom.xml" target="_blank" rel="external">http://tutuge.me/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://www.olinone.com/" target="_blank" rel="external">庞海礁的个人空间 </a></td>
<td><a href="http://www.olinone.com/?feed=rss2" target="_blank" rel="external">http://www.olinone.com/?feed=rss2</a></td>
</tr>
<tr>
<td><a href="http://casatwy.com/" target="_blank" rel="external">Casa Taloyum</a></td>
<td><a href="http://casatwy.com/feeds/all.atom.xml" target="_blank" rel="external">http://casatwy.com/feeds/all.atom.xml</a></td>
</tr>
<tr>
<td><a href="http://www.cnblogs.com/kenshincui/" target="_blank" rel="external">Kenshin Cui’s Blog</a></td>
<td><a href="http://www.cnblogs.com/kenshincui/rss" target="_blank" rel="external">http://www.cnblogs.com/kenshincui/rss</a></td>
</tr>
<tr>
<td><a href="http://suenblog.duapp.com/" target="_blank" rel="external">技术哥的博客</a></td>
<td><a href="http://suenblog.duapp.com/rss/" target="_blank" rel="external">http://suenblog.duapp.com/rss/</a></td>
</tr>
<tr>
<td><a href="http://www.tanhao.me/" target="_blank" rel="external">老谭笔记</a></td>
<td><a href="http://www.tanhao.me/atom.xml" target="_blank" rel="external">http://www.tanhao.me/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://www.coderyi.com/" target="_blank" rel="external">coderyi</a></td>
<td><a href="http://www.coderyi.com/feed" target="_blank" rel="external">http://www.coderyi.com/feed</a></td>
</tr>
<tr>
<td><a href="http://blog.leichunfeng.com" target="_blank" rel="external">雷纯锋的技术博客</a></td>
<td><a href="http://blog.leichunfeng.com/atom.xml" target="_blank" rel="external">http://blog.leichunfeng.com/atom.xml</a></td>
</tr>
<tr>
<td><a href="http://www.iosxxx.com/" target="_blank" rel="external">向晨宇的技术博客</a></td>
<td><a href="http://iosxxx.com/atom.xml" target="_blank" rel="external">http://iosxxx.com/atom.xml</a></td>
</tr>
</tbody>
</table>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/12/25/UIView的几个layout方法-layoutSubviews、layoutIfNeeded、setNeedsLayout/" rel="next" title="UIView的几个layout方法">
                <i class="fa fa-chevron-left"></i> UIView的几个layout方法
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/12/12/Swift中条件编译/" rel="prev" title="Swift的条件编译">
                Swift的条件编译 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2016/12/12/Swift中条件编译/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Swift的条件编译
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-12-12T15:18:45+08:00">
                2016-12-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2016/12/12/Swift中条件编译/" class="leancloud_visitors" data-flag-title="Swift的条件编译">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>在 C 系语言中，可以使用 <code>#if</code> 或者 <code>#ifdef</code> 之类的编译条件分支来控制哪些代码需要编译，而哪些代码不需要。Swift 中没有宏定义的概念，因此我们不能使用 <code>#ifdef</code> 的方法来检查某个符号是否经过宏定义。但是为了控制编译流程和内容，Swift 还是为我们提供了几种简单的机制来根据需求定制编译内容的。</p>
<p>首先是 #if 这一套编译标记还是存在的，使用的语法也和原来没有区别：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line">#<span class="keyword">if</span> &lt;condition&gt;</div><div class="line"></div><div class="line">#elseif &lt;condition&gt;</div><div class="line"></div><div class="line">#<span class="keyword">else</span></div><div class="line"></div><div class="line">#endif</div></pre></td></tr></table></figure>
<p>当然，<code>#elseif</code> 和 <code>#else</code>是可选的。</p>
<p>但是这几个表达式里的 condition 并不是任意的。Swift 内建了几种平台和架构的组合，来帮助我们为不同的平台编译不同的代码，比如：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line">#<span class="keyword">if</span> os(<span class="type">OSX</span>)</div><div class="line">    <span class="keyword">typealias</span> <span class="type">Color</span> = <span class="type">NSColor</span></div><div class="line">#<span class="keyword">else</span></div><div class="line">    <span class="keyword">typealias</span> <span class="type">Color</span> = <span class="type">UIColor</span></div><div class="line">#endif</div></pre></td></tr></table></figure>
<p>还有一个<code>arch()</code>:<br>它表示CPU的版本，参数有<code>arm</code>和<code>arm64</code>分别表示32位和62位的处理器。</p>
<p>另一种方式是对自定义的符号进行条件编译，比如我们的APP有多套API，生产环境一套，开发环境一套，测试环境一套，这时如果每次打包时都去修改API的话就太麻烦了，也容易出错，我们可以为生产环境和测试环境都建一个Build Configuration，然后在Building Setting中的Swift Compiler中添加一个Active Compilation Conditions就可以了：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line">#<span class="keyword">if</span> <span class="type">PRODUCT</span></div><div class="line">    <span class="comment">// 生产环境定义</span></div><div class="line">#<span class="keyword">else</span></div><div class="line">    <span class="comment">// 开发环境定义</span></div><div class="line">#endif</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/Swift/" rel="tag"># Swift</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/12/24/iOS,Mac著名开发者博客/" rel="next" title="iOS,Mac著名开发者博客">
                <i class="fa fa-chevron-left"></i> iOS,Mac著名开发者博客
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/11/15/iOS AVPlayer 简单封装/" rel="prev" title="iOS AVPlayer 简单封装">
                iOS AVPlayer 简单封装 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2016/11/15/iOS AVPlayer 简单封装/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                iOS AVPlayer 简单封装
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-11-15T10:17:25+08:00">
                2016-11-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2016/11/15/iOS AVPlayer 简单封装/" class="leancloud_visitors" data-flag-title="iOS AVPlayer 简单封装">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>这里给AVPlayer做一个简单封装，可以实现播放本地视频和网络视频。(Swift 3)</p>
<p>代码如下:</p>
<h4 id="AVPlayer-处理播放"><a href="#AVPlayer-处理播放" class="headerlink" title="AVPlayer:处理播放"></a>AVPlayer:处理播放</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> AVFoundation</div><div class="line"><span class="keyword">import</span> Foundation</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">protocol</span> <span class="title">VideoPlayerDelegate</span> </span>&#123;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">downloadedProgress</span><span class="params">(progress:Double)</span></span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">readyToPlay</span><span class="params">()</span></span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">didUpdateProgress</span><span class="params">(progress:Double)</span></span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">didFinishPlayItem</span><span class="params">()</span></span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">didFailPlayToEnd</span><span class="params">()</span></span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">let</span> videoContext:<span class="type">UnsafeMutableRawPointer</span>? = <span class="literal">nil</span></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">VideoPlayer</span>: <span class="title">NSObject</span></span>&#123;</div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> assetPlayer:<span class="type">AVPlayer</span>?</div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> playerItem:<span class="type">AVPlayerItem</span>?</div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> urlAsset:<span class="type">AVURLAsset</span>?</div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> videoOutput:<span class="type">AVPlayerItemVideoOutput</span>?</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> assetDuration:<span class="type">Double</span> = <span class="number">0</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> playerView:<span class="type">PlayerView</span>?</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> autoRepeatPlay:<span class="type">Bool</span> = <span class="literal">true</span></div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> autoPlay:<span class="type">Bool</span> = <span class="literal">true</span></div><div class="line">    </div><div class="line">    <span class="keyword">var</span> delegate:<span class="type">VideoPlayerDelegate</span>?</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> playerRate:<span class="type">Float</span> = <span class="number">1</span> &#123;</div><div class="line">        <span class="keyword">didSet</span> &#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">                player.rate = playerRate &gt; <span class="number">0</span> ? playerRate : <span class="number">0.0</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> volume:<span class="type">Float</span> = <span class="number">1.0</span> &#123;</div><div class="line">        <span class="keyword">didSet</span> &#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">                player.volume = volume &gt; <span class="number">0</span> ? volume : <span class="number">0.0</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">convenience</span> <span class="keyword">init</span>(urlAsset:<span class="type">URL</span>, view:<span class="type">PlayerView</span>, startAutoPlay:<span class="type">Bool</span> = <span class="literal">true</span>, repeatAfterEnd:<span class="type">Bool</span> = <span class="literal">true</span>) &#123;</div><div class="line">        <span class="keyword">self</span>.<span class="keyword">init</span>()</div><div class="line">        </div><div class="line">        playerView = view</div><div class="line">        autoPlay = startAutoPlay</div><div class="line">        autoRepeatPlay = repeatAfterEnd</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> playView = playerView, <span class="keyword">let</span> playerLayer = playView.layer <span class="keyword">as</span>? <span class="type">AVPlayerLayer</span> &#123;</div><div class="line">            playerLayer.videoGravity = <span class="type">AVLayerVideoGravityResizeAspectFill</span></div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        </div><div class="line">        initialSetupWithURL(url: urlAsset)</div><div class="line">        prepareToPlay()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="keyword">init</span>() &#123;</div><div class="line">        <span class="keyword">super</span>.<span class="keyword">init</span>()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// MARK: - Public</span></div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">isPlaying</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span> &#123;</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">            <span class="keyword">return</span> player.rate &gt; <span class="number">0</span></div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> <span class="literal">false</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">seekToPosition</span><span class="params">(seconds:Float64)</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">            pause()</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> timeScale = player.currentItem?.asset.duration.timescale &#123;</div><div class="line">                player.seek(to: <span class="type">CMTimeMakeWithSeconds</span>(seconds, timeScale), completionHandler: &#123; (complete) <span class="keyword">in</span></div><div class="line">                    <span class="keyword">self</span>.play()</div><div class="line">                &#125;)</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">pause</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">            player.pause()</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">play</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">            <span class="keyword">if</span> (player.currentItem?.status == .readyToPlay) &#123;</div><div class="line">                player.play()</div><div class="line">                player.rate = playerRate</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">cleanUp</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> item = playerItem &#123;</div><div class="line">            item.removeObserver(<span class="keyword">self</span>, forKeyPath: <span class="string">"status"</span>)</div><div class="line">            item.removeObserver(<span class="keyword">self</span>, forKeyPath: <span class="string">"loadedTimeRanges"</span>)</div><div class="line">        &#125;</div><div class="line">        <span class="type">NotificationCenter</span>.<span class="keyword">default</span>.removeObserver(<span class="keyword">self</span>)</div><div class="line">        assetPlayer = <span class="literal">nil</span></div><div class="line">        playerItem = <span class="literal">nil</span></div><div class="line">        urlAsset = <span class="literal">nil</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// MARK: - Private</span></div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">prepareToPlay</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">let</span> keys = [<span class="string">"tracks"</span>]</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> asset = urlAsset &#123;</div><div class="line">            asset.loadValuesAsynchronously(forKeys: keys, completionHandler: &#123; </div><div class="line">                <span class="type">DispatchQueue</span>.main.async &#123;</div><div class="line">                    <span class="keyword">self</span>.startLoading()</div><div class="line">                &#125;</div><div class="line">            &#125;)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">startLoading</span><span class="params">()</span></span>&#123;</div><div class="line">        <span class="keyword">var</span> error:<span class="type">NSError</span>?</div><div class="line">        <span class="keyword">guard</span> <span class="keyword">let</span> asset = urlAsset <span class="keyword">else</span> &#123;<span class="keyword">return</span>&#125;</div><div class="line">        </div><div class="line">        <span class="keyword">let</span> status:<span class="type">AVKeyValueStatus</span> = asset.statusOfValue(forKey: <span class="string">"tracks"</span>, error: &amp;error)</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> status == <span class="type">AVKeyValueStatus</span>.loaded &#123;</div><div class="line">            assetDuration = <span class="type">CMTimeGetSeconds</span>(asset.duration)</div><div class="line">            </div><div class="line">            <span class="keyword">let</span> videoOutputOptions = [kCVPixelBufferPixelFormatTypeKey <span class="keyword">as</span> <span class="type">String</span> : <span class="type">Int</span>(kCVPixelFormatType_420YpCbCr8BiPlanarVideoRange)]</div><div class="line">            videoOutput = <span class="type">AVPlayerItemVideoOutput</span>(pixelBufferAttributes: videoOutputOptions)</div><div class="line">            playerItem = <span class="type">AVPlayerItem</span>(asset: asset)</div><div class="line">            </div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> item = playerItem &#123;</div><div class="line">                item.addObserver(<span class="keyword">self</span>, forKeyPath: <span class="string">"status"</span>, options: .initial, context: videoContext)</div><div class="line">                item.addObserver(<span class="keyword">self</span>, forKeyPath: <span class="string">"loadedTimeRanges"</span>, options: [.new, .old], context: videoContext)</div><div class="line">                </div><div class="line">                <span class="type">NotificationCenter</span>.<span class="keyword">default</span>.addObserver(<span class="keyword">self</span>, selector: #selector(playerItemDidReachEnd), name: <span class="type">NSNotification</span>.<span class="type">Name</span>.<span class="type">AVPlayerItemDidPlayToEndTime</span>, object: <span class="literal">nil</span>)</div><div class="line">                <span class="type">NotificationCenter</span>.<span class="keyword">default</span>.addObserver(<span class="keyword">self</span>, selector: #selector(didFailedToPlayToEnd), name: <span class="type">NSNotification</span>.<span class="type">Name</span>.<span class="type">AVPlayerItemFailedToPlayToEndTime</span>, object: <span class="literal">nil</span>)</div><div class="line">                </div><div class="line">                <span class="keyword">if</span> <span class="keyword">let</span> output = videoOutput &#123;</div><div class="line">                    item.add(output)</div><div class="line">                    </div><div class="line">                    item.audioTimePitchAlgorithm = <span class="type">AVAudioTimePitchAlgorithmVarispeed</span></div><div class="line">                    assetPlayer = <span class="type">AVPlayer</span>(playerItem: item)</div><div class="line">                    </div><div class="line">                    <span class="keyword">if</span> <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">                        player.rate = playerRate</div><div class="line">                    &#125;</div><div class="line">                    </div><div class="line">                    addPeriodicalObserver()</div><div class="line">                    <span class="keyword">if</span> <span class="keyword">let</span> playView = playerView, <span class="keyword">let</span> layer = playView.layer <span class="keyword">as</span>? <span class="type">AVPlayerLayer</span> &#123;</div><div class="line">                        layer.player = assetPlayer</div><div class="line">                        <span class="built_in">print</span>(<span class="string">"player created"</span>)</div><div class="line">                    &#125;</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">addPeriodicalObserver</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">let</span> timeInterval = <span class="type">CMTimeMake</span>(<span class="number">1</span>, <span class="number">1</span>)</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">            player.addPeriodicTimeObserver(forInterval: timeInterval, queue: <span class="type">DispatchQueue</span>.main, using: &#123; (time) <span class="keyword">in</span></div><div class="line">                <span class="keyword">self</span>.playerDidChangeTime(time: time)</div><div class="line">            &#125;)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">playerDidChangeTime</span><span class="params">(time:CMTime)</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">            <span class="keyword">let</span> timeNow = <span class="type">CMTimeGetSeconds</span>(player.currentTime())</div><div class="line">            <span class="keyword">let</span> progress = timeNow / assetDuration</div><div class="line">            </div><div class="line">            delegate?.didUpdateProgress(progress: progress)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="meta">@objc</span> <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">playerItemDidReachEnd</span><span class="params">()</span></span> &#123;</div><div class="line">        delegate?.didFinishPlayItem()</div><div class="line">        </div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">            player.seek(to: kCMTimeZero)</div><div class="line">            <span class="keyword">if</span> autoRepeatPlay == <span class="literal">true</span> &#123;</div><div class="line">                play()</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="meta">@objc</span> <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">didFailedToPlayToEnd</span><span class="params">()</span></span> &#123;</div><div class="line">        delegate?.didFailPlayToEnd()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">playerDidChangeStatus</span><span class="params">(status:AVPlayerStatus)</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> status == .failed &#123;</div><div class="line">            <span class="built_in">print</span>(<span class="string">"Failed to load video"</span>)</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> status == .readyToPlay, <span class="keyword">let</span> player = assetPlayer &#123;</div><div class="line">            volume = player.volume</div><div class="line">            delegate?.readyToPlay()</div><div class="line">            </div><div class="line">            <span class="keyword">if</span> autoPlay == <span class="literal">true</span> &amp;&amp; player.rate == <span class="number">0.0</span> &#123;</div><div class="line">                play()</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">moviewPlayerLoadedTimeRangeDidUpdated</span><span class="params">(ranges:Array&lt;NSValue&gt;)</span></span> &#123;</div><div class="line">        <span class="keyword">var</span> maximum:<span class="type">TimeInterval</span> = <span class="number">0</span></div><div class="line">        <span class="keyword">for</span> value <span class="keyword">in</span> ranges &#123;</div><div class="line">            <span class="keyword">let</span> range:<span class="type">CMTimeRange</span> = value.timeRangeValue</div><div class="line">            <span class="keyword">let</span> currentLoadedTimeRange = <span class="type">CMTimeGetSeconds</span>(range.start) + <span class="type">CMTimeGetSeconds</span>(range.duration)</div><div class="line">            <span class="keyword">if</span> currentLoadedTimeRange &gt; maximum &#123;</div><div class="line">                maximum = currentLoadedTimeRange</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">let</span> progress:<span class="type">Double</span> = assetDuration == <span class="number">0</span> ? <span class="number">0.0</span> : <span class="type">Double</span>(maximum) / assetDuration</div><div class="line">        </div><div class="line">        delegate?.downloadedProgress(progress: progress)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">deinit</span> &#123;</div><div class="line">        cleanUp()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">func</span> <span class="title">initialSetupWithURL</span><span class="params">(url:URL)</span></span> &#123;</div><div class="line">        <span class="keyword">let</span> options = [<span class="type">AVURLAssetPreferPreciseDurationAndTimingKey</span> : <span class="literal">true</span>]</div><div class="line">        urlAsset = <span class="type">AVURLAsset</span>(url: url, options: options)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="comment">// MARK: - Observations</span></div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">observeValue</span><span class="params">(forKeyPath keyPath: String?, of object: Any?, change: [NSKeyValueChangeKey : Any]?, context: UnsafeMutableRawPointer?)</span></span> &#123;</div><div class="line">        <span class="keyword">if</span> context == videoContext&#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> key = keyPath&#123;</div><div class="line">                <span class="keyword">if</span> key == <span class="string">"status"</span>, <span class="keyword">let</span> player = assetPlayer&#123;</div><div class="line">                    playerDidChangeStatus(status: player.status)</div><div class="line">                &#125;<span class="keyword">else</span> <span class="keyword">if</span> key == <span class="string">"loadedTimeRange"</span>, <span class="keyword">let</span> item = playerItem&#123;</div><div class="line">                    moviewPlayerLoadedTimeRangeDidUpdated(ranges: item.loadedTimeRanges)</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="PlayerView-播放视频的View"><a href="#PlayerView-播放视频的View" class="headerlink" title="PlayerView: 播放视频的View"></a>PlayerView: 播放视频的View</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">PlayerView</span>: <span class="title">UIView</span> </span>&#123;</div><div class="line">    <span class="keyword">override</span> <span class="class"><span class="keyword">class</span> <span class="title">var</span> <span class="title">layerClass</span>: <span class="title">AnyClass</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="type">AVPlayerLayer</span>.<span class="keyword">self</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> player:<span class="type">AVPlayer</span>?&#123;</div><div class="line">        <span class="keyword">set</span>&#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> layer = layer <span class="keyword">as</span>? <span class="type">AVPlayerLayer</span>&#123;</div><div class="line">                layer.player = player</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">get</span>&#123;</div><div class="line">            <span class="keyword">if</span> <span class="keyword">let</span> layer = layer <span class="keyword">as</span>? <span class="type">AVPlayerLayer</span>&#123;</div><div class="line">                <span class="keyword">return</span> layer.player</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">return</span> <span class="literal">nil</span></div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="使用："><a href="#使用：" class="headerlink" title="使用："></a>使用：</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">VideoTableViewCell</span>: <span class="title">UITableViewCell</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@IBOutlet</span> <span class="keyword">weak</span> <span class="keyword">var</span> playerView: <span class="type">PlayerView</span>!</div><div class="line">    <span class="keyword">private</span> <span class="keyword">var</span> videoPlayer:<span class="type">VideoPlayer</span>?</div><div class="line">    </div><div class="line">    <span class="keyword">var</span> url:<span class="type">URL</span>!</div><div class="line">    </div><div class="line">    </div><div class="line">    <span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">awakeFromNib</span><span class="params">()</span></span> &#123;</div><div class="line">        <span class="keyword">super</span>.awakeFromNib()</div><div class="line">        <span class="comment">// Initialization code</span></div><div class="line">        </div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">preparePlayer</span><span class="params">()</span></span> &#123;</div><div class="line">        videoPlayer = <span class="type">VideoPlayer</span>(urlAsset: url, view: playerView)</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">pause</span><span class="params">()</span></span>&#123;</div><div class="line">        videoPlayer?.pause()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">start</span><span class="params">()</span></span>&#123;</div><div class="line">        videoPlayer?.play()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">clean</span><span class="params">()</span></span>&#123;</div><div class="line">        videoPlayer?.cleanUp()</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">isPlaying</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span>&#123;</div><div class="line">        <span class="keyword">return</span> videoPlayer?.isPlaying() ?? <span class="literal">false</span></div><div class="line">    &#125;</div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/Swift/" rel="tag"># Swift</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/12/12/Swift中条件编译/" rel="next" title="Swift的条件编译">
                <i class="fa fa-chevron-left"></i> Swift的条件编译
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/10/25/Swift小Tips/" rel="prev" title="Swift小Tips">
                Swift小Tips <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2016/10/25/Swift小Tips/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Swift小Tips
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-25T11:17:45+08:00">
                2016-10-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2016/10/25/Swift小Tips/" class="leancloud_visitors" data-flag-title="Swift小Tips">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h4 id="noescape和-autoclosure"><a href="#noescape和-autoclosure" class="headerlink" title="@noescape和@autoclosure"></a>@noescape和@autoclosure</h4><p><code>@noescape</code>：这个关键字告诉编译器，参数闭包只能在函数内部使用。它不能被赋值给临时变量，不能异步调用，也不能作为未标记为<code>@noescape</code>的参数传递给其他函数。总之您可以放心，它无法在这个函数作用域之外使用。</p>
<p>除了安全性上的保证，swift还会为标记为<code>@noescape</code>的参数做一些优化，闭包内访问类的成员时您还可以省去<code>self.</code>的语法。</p>
<p><code>@autoclosure</code>：这个关键字将表达式封装成闭包，优点在于延迟了表达式的执行，缺点是如果滥用会导致代码可读性降低。</p>
<p>swift3中<code>@noescape</code>变成默认了，需要逃离闭包要用到<code>@escape</code>关键字</p>
<h4 id="可变参数"><a href="#可变参数" class="headerlink" title="可变参数"></a>可变参数</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">printEverythingWithAKrakenEmojiInBetween</span><span class="params">(objectsToPrint: Any...)</span></span> &#123;</div><div class="line">    <span class="keyword">for</span> object <span class="keyword">in</span> objectsToPrint &#123;</div><div class="line">        <span class="built_in">print</span>(<span class="string">"<span class="subst">\(object)</span>🐙"</span>)</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line">printEverythingWithAKrakenEmojiInBetween(<span class="string">"Hey"</span>, <span class="string">"Look"</span>, <span class="string">"At"</span>, <span class="string">"Me"</span>, <span class="string">"!"</span>)</div></pre></td></tr></table></figure>
<p>此时，参数可以当做SequenceType类型来使用，也就是说可以使用for in语法遍历其中的每一个参数。<br>Swift中的print函数就是用这个实现的。</p>
<h4 id="dynamic关键字"><a href="#dynamic关键字" class="headerlink" title="dynamic关键字"></a>dynamic关键字</h4><p>OC中@dynamic关键字是告诉编译器不要为属性合成getter和setter方法。</p>
<p>Swift中也有dynamic关键字，它可以用于修饰变量或函数，它的意思也与OC完全不同。它告诉编译器使用动态分发而不是静态分发。OC区别于其他语言的一个特点在于它的动态性，任何方法调用实际上都是消息分发，而Swift则尽可能做到静态分发。</p>
<p>因此，标记为dynamic的变量/函数会隐式的加上@objc关键字，它会使用OC的runtime机制。</p>
<p>虽然静态分发在效率上可能更好，不过一些app分析统计的库需要依赖动态分发的特性，动态的添加一些统计代码，这一点在Swift的静态分发机制下很难完成。这种情况下，虽然使用dynamic关键字会牺牲因为使用静态分发而获得的一些性能优化，但也依然是值得的。</p>
<h4 id="特殊的字面量"><a href="#特殊的字面量" class="headerlink" title="特殊的字面量"></a>特殊的字面量</h4><p>在开发或调试过程中如果能用好下面这四个字面量，将会起到事半功倍的效果：</p>
<p><code>__FILE__</code>：当前代码在那个文件中<br><code>__FUNCTION__</code>：当前代码在该文件的那个函数中<br><code>__LINE__</code>：当前代码在该文件的第多少行<br><code>__COLUMN__</code>：当前代码在改行的多少列</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">specialLitertalExpression</span><span class="params">()</span></span> &#123;</div><div class="line">    <span class="built_in">print</span>(<span class="keyword">__FILE__</span>)</div><div class="line">    <span class="built_in">print</span>(<span class="keyword">__FUNCTION__</span>)</div><div class="line">    <span class="built_in">print</span>(<span class="keyword">__LINE__</span>)</div><div class="line">    <span class="built_in">print</span>(<span class="keyword">__COLUMN__</span>)   <span class="comment">// 输出结果为11，因为有4个空格，print是五个字符，还有一个左括号。</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="for-in-遍历"><a href="#for-in-遍历" class="headerlink" title="for in 遍历"></a>for in 遍历</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">stride</span>(from: <span class="number">0.5</span>, to: <span class="number">19.25</span>, by: <span class="number">0.3</span>)&#123;</div><div class="line">    <span class="built_in">print</span>(<span class="string">"<span class="subst">\(i)</span>"</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/Swift/" rel="tag"># Swift</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/11/15/iOS AVPlayer 简单封装/" rel="next" title="iOS AVPlayer 简单封装">
                <i class="fa fa-chevron-left"></i> iOS AVPlayer 简单封装
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/10/14/iOS常用宏定义（Swift篇）/" rel="prev" title="iOS常用宏定义（Siwft篇）">
                iOS常用宏定义（Siwft篇） <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2016/10/14/iOS常用宏定义（Swift篇）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                iOS常用宏定义（Siwft篇）
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-14T15:26:21+08:00">
                2016-10-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2016/10/14/iOS常用宏定义（Swift篇）/" class="leancloud_visitors" data-flag-title="iOS常用宏定义（Siwft篇）">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote>
<p>swift中并没有宏定义，只是用全局常量和利用函数获取全局常量的方式实现了OC中的宏定义功能。</p>
</blockquote>
<h4 id="屏幕"><a href="#屏幕" class="headerlink" title="屏幕"></a>屏幕</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">let</span> <span class="type">SCREEN_HEIGHT</span> = <span class="type">UIScreen</span>.mainScreen().bounds.height</div><div class="line"><span class="keyword">let</span> <span class="type">SCREEN_WIDTH</span> = <span class="type">UIScreen</span>.mainScreen().bounds.width</div><div class="line"><span class="keyword">let</span> <span class="type">FIT_WIDTH</span> = <span class="type">UIScreen</span>.mainScreen().bounds.size.width / <span class="number">375</span></div><div class="line"><span class="keyword">let</span> <span class="type">FIT_HEIGHT</span> = <span class="type">UIScreen</span>.mainScreen().bounds.size.height / <span class="number">667</span></div></pre></td></tr></table></figure>
<p>最好的办法是使用结构体：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ScreenSize</span> </span>&#123;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">let</span> height = <span class="type">UIScreen</span>.mainScreen().bounds.height</div><div class="line">    <span class="keyword">static</span> <span class="keyword">let</span> width  = <span class="type">UIScreen</span>.mainScreen().bounds.width</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="系统"><a href="#系统" class="headerlink" title="系统"></a>系统</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">//系统</span></div><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">System</span> </span>&#123;</div><div class="line">    <span class="keyword">static</span> <span class="keyword">let</span> version = <span class="type">UIDevice</span> .currentDevice().systemVersion</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="Log"><a href="#Log" class="headerlink" title="Log"></a>Log</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">/// Log</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">printLog</span>&lt;T&gt;<span class="params">(message: T,</span></span></div><div class="line">              file: String = #file,</div><div class="line">              method: String = #function,</div><div class="line">              line: Int = #line)</div><div class="line">&#123;</div><div class="line">    #<span class="keyword">if</span> <span class="type">DEBUG</span></div><div class="line">        <span class="built_in">print</span>(<span class="string">"Log:<span class="subst">\((file <span class="keyword">as</span> NSString)</span>.lastPathComponent)[<span class="subst">\(line)</span>], <span class="subst">\(method)</span>: <span class="subst">\(message)</span>"</span>)</div><div class="line">    #endif</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">/// Error</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">printError</span>&lt;T&gt;<span class="params">(message: T,</span></span></div><div class="line">                file: String = #file,</div><div class="line">                method: String = #function,</div><div class="line">                line: Int = #line)</div><div class="line">&#123;</div><div class="line">    #<span class="keyword">if</span> <span class="type">DEBUG</span></div><div class="line">        <span class="built_in">print</span>(<span class="string">"Error:<span class="subst">\((file <span class="keyword">as</span> NSString)</span>.lastPathComponent)[<span class="subst">\(line)</span>], <span class="subst">\(method)</span>: <span class="subst">\(message)</span>"</span>)</div><div class="line">    #endif</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="UIView"><a href="#UIView" class="headerlink" title="UIView"></a>UIView</h4><p>使用Extension</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">// MARK: - UIView 扩展</span></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIView</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> x:<span class="type">CGFloat</span>&#123;</div><div class="line">        <span class="keyword">return</span> frame.origin.x</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> y:<span class="type">CGFloat</span>&#123;</div><div class="line">        <span class="keyword">return</span> frame.origin.y</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> width:<span class="type">CGFloat</span>&#123;</div><div class="line">        <span class="keyword">return</span> frame.size.width</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> height:<span class="type">CGFloat</span>&#123;</div><div class="line">        <span class="keyword">return</span> frame.size.height</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="设备"><a href="#设备" class="headerlink" title="设备"></a>设备</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">DeviceModel</span> : <span class="title">String</span> </span>&#123;</div><div class="line">    <span class="keyword">case</span> <span class="type">Simulator</span> = <span class="string">"Simulator/Sandbox"</span>,</div><div class="line">    iPod1          = <span class="string">"iPod 1"</span>,</div><div class="line">    iPod2          = <span class="string">"iPod 2"</span>,</div><div class="line">    iPod3          = <span class="string">"iPod 3"</span>,</div><div class="line">    iPod4          = <span class="string">"iPod 4"</span>,</div><div class="line">    iPod5          = <span class="string">"iPod 5"</span>,</div><div class="line">    iPad2          = <span class="string">"iPad 2"</span>,</div><div class="line">    iPad3          = <span class="string">"iPad 3"</span>,</div><div class="line">    iPad4          = <span class="string">"iPad 4"</span>,</div><div class="line">    iPhone4        = <span class="string">"iPhone 4"</span>,</div><div class="line">    iPhone4S       = <span class="string">"iPhone 4S"</span>,</div><div class="line">    iPhone5        = <span class="string">"iPhone 5"</span>,</div><div class="line">    iPhone5S       = <span class="string">"iPhone 5S"</span>,</div><div class="line">    iPhone5C       = <span class="string">"iPhone 5C"</span>,</div><div class="line">    iPadMini1      = <span class="string">"iPad Mini 1"</span>,</div><div class="line">    iPadMini2      = <span class="string">"iPad Mini 2"</span>,</div><div class="line">    iPadMini3      = <span class="string">"iPad Mini 3"</span>,</div><div class="line">    iPadAir1       = <span class="string">"iPad Air 1"</span>,</div><div class="line">    iPadAir2       = <span class="string">"iPad Air 2"</span>,</div><div class="line">    iPhone6        = <span class="string">"iPhone 6"</span>,</div><div class="line">    iPhone6plus    = <span class="string">"iPhone 6 Plus"</span>,</div><div class="line">    iPhone6S       = <span class="string">"iPhone 6S"</span>,</div><div class="line">    iPhone6Splus   = <span class="string">"iPhone 6S Plus"</span>,</div><div class="line">    iPhone7        = <span class="string">"iPhone 7"</span>,</div><div class="line">    iPhone7plus    = <span class="string">"iPhone 7 Plus"</span>,</div><div class="line">    <span class="type">Unrecognized</span>   = <span class="string">"unrecognized"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="class"><span class="keyword">extension</span> <span class="title">UIDevice</span></span>&#123;</div><div class="line">    <span class="comment">/// 获取当前设备详细类型</span></div><div class="line">    <span class="keyword">public</span> <span class="keyword">var</span> deviceModel: <span class="type">DeviceModel</span>&#123;</div><div class="line">        <span class="keyword">var</span> systemInfo = utsname()</div><div class="line">        uname(&amp;systemInfo)</div><div class="line">        <span class="keyword">let</span> machineMirror = <span class="type">Mirror</span>(reflecting: systemInfo.machine)</div><div class="line">        <span class="keyword">let</span> identifier = machineMirror.children.<span class="built_in">reduce</span>(<span class="string">""</span>) &#123; identifier, element <span class="keyword">in</span></div><div class="line">            <span class="keyword">guard</span> <span class="keyword">let</span> value = element.value <span class="keyword">as</span>? <span class="type">Int8</span> , value != <span class="number">0</span> <span class="keyword">else</span> &#123; <span class="keyword">return</span> identifier &#125;</div><div class="line">            <span class="keyword">return</span> identifier + <span class="type">String</span>(<span class="type">UnicodeScalar</span>(<span class="type">UInt8</span>(value)))</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">var</span> modelMap : [ <span class="type">String</span> : <span class="type">DeviceModel</span> ] = [</div><div class="line">            <span class="string">"i386"</span>      : .<span class="type">Simulator</span>,</div><div class="line">            <span class="string">"x86_64"</span>    : .<span class="type">Simulator</span>,</div><div class="line">            <span class="string">"iPod1,1"</span>   : .iPod1,</div><div class="line">            <span class="string">"iPod2,1"</span>   : .iPod2,</div><div class="line">            <span class="string">"iPod3,1"</span>   : .iPod3,</div><div class="line">            <span class="string">"iPod4,1"</span>   : .iPod4,</div><div class="line">            <span class="string">"iPod5,1"</span>   : .iPod5,</div><div class="line">            <span class="string">"iPad2,1"</span>   : .iPad2,</div><div class="line">            <span class="string">"iPad2,2"</span>   : .iPad2,</div><div class="line">            <span class="string">"iPad2,3"</span>   : .iPad2,</div><div class="line">            <span class="string">"iPad2,4"</span>   : .iPad2,</div><div class="line">            <span class="string">"iPad2,5"</span>   : .iPadMini1,</div><div class="line">            <span class="string">"iPad2,6"</span>   : .iPadMini1,</div><div class="line">            <span class="string">"iPad2,7"</span>   : .iPadMini1,</div><div class="line">            <span class="string">"iPhone3,1"</span> : .iPhone4,</div><div class="line">            <span class="string">"iPhone3,2"</span> : .iPhone4,</div><div class="line">            <span class="string">"iPhone3,3"</span> : .iPhone4,</div><div class="line">            <span class="string">"iPhone4,1"</span> : .iPhone4S,</div><div class="line">            <span class="string">"iPhone5,1"</span> : .iPhone5,</div><div class="line">            <span class="string">"iPhone5,2"</span> : .iPhone5,</div><div class="line">            <span class="string">"iPhone5,3"</span> : .iPhone5C,</div><div class="line">            <span class="string">"iPhone5,4"</span> : .iPhone5C,</div><div class="line">            <span class="string">"iPad3,1"</span>   : .iPad3,</div><div class="line">            <span class="string">"iPad3,2"</span>   : .iPad3,</div><div class="line">            <span class="string">"iPad3,3"</span>   : .iPad3,</div><div class="line">            <span class="string">"iPad3,4"</span>   : .iPad4,</div><div class="line">            <span class="string">"iPad3,5"</span>   : .iPad4,</div><div class="line">            <span class="string">"iPad3,6"</span>   : .iPad4,</div><div class="line">            <span class="string">"iPhone6,1"</span> : .iPhone5S,</div><div class="line">            <span class="string">"iPhone6,2"</span> : .iPhone5S,</div><div class="line">            <span class="string">"iPad4,1"</span>   : .iPadAir1,</div><div class="line">            <span class="string">"iPad4,2"</span>   : .iPadAir2,</div><div class="line">            <span class="string">"iPad4,4"</span>   : .iPadMini2,</div><div class="line">            <span class="string">"iPad4,5"</span>   : .iPadMini2,</div><div class="line">            <span class="string">"iPad4,6"</span>   : .iPadMini2,</div><div class="line">            <span class="string">"iPad4,7"</span>   : .iPadMini3,</div><div class="line">            <span class="string">"iPad4,8"</span>   : .iPadMini3,</div><div class="line">            <span class="string">"iPad4,9"</span>   : .iPadMini3,</div><div class="line">            <span class="string">"iPhone7,1"</span> : .iPhone6plus,</div><div class="line">            <span class="string">"iPhone7,2"</span> : .iPhone6,</div><div class="line">            <span class="string">"iPhone8,1"</span> : .iPhone6S,</div><div class="line">            <span class="string">"iPhone8,2"</span> : .iPhone6Splus,</div><div class="line">            <span class="string">"iPhone9,1"</span> : .iPhone7,</div><div class="line">            <span class="string">"iPhone9,2"</span> : .iPhone7plus</div><div class="line">        ]</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> model = modelMap[identifier] &#123;</div><div class="line">            <span class="keyword">return</span> model</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> <span class="type">DeviceModel</span>.<span class="type">Unrecognized</span></div><div class="line">    &#125;</div><div class="line">    <span class="comment">/// 判断是不是iPhone</span></div><div class="line">    <span class="keyword">var</span> isiPhone:<span class="type">Bool</span>&#123;</div><div class="line">        <span class="keyword">return</span> model == <span class="string">"iPhone"</span></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">/// 判断是不是iPad</span></div><div class="line">    <span class="keyword">var</span> isiPad:<span class="type">Bool</span>&#123;</div><div class="line">        <span class="keyword">return</span> model == <span class="string">"iPad"</span></div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/Swift/" rel="tag"># Swift</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/10/25/Swift小Tips/" rel="next" title="Swift小Tips">
                <i class="fa fa-chevron-left"></i> Swift小Tips
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/10/04/常用正则表达式/" rel="prev" title="常用正则表达式">
                常用正则表达式 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2016/10/04/常用正则表达式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                常用正则表达式
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-10-04T19:20:25+08:00">
                2016-10-04
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2016/10/04/常用正则表达式/" class="leancloud_visitors" data-flag-title="常用正则表达式">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>下面是开发中经常使用到的正则表达式。</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">//MARK:- 正则匹配手机号</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">checkMobile</span>(<span class="title">_</span> <span class="title">mobileNumbel</span>:<span class="title">String</span>) -&gt;<span class="title">Bool</span></span>&#123;</div><div class="line">    <span class="keyword">let</span> pattern = <span class="string">"^(13[0-9]|15[0-9]|18[0-9]|17[0-9]|147)\\d&#123;8&#125;$"</span></div><div class="line">    <span class="keyword">let</span> pred = <span class="type">NSPredicate</span>(format: <span class="string">"SELF MATCHES %@"</span>, pattern)</div><div class="line">    <span class="keyword">let</span> isMatch:<span class="type">Bool</span> = pred.evaluate(with: idCard)</div><div class="line">    <span class="keyword">return</span> isMatch;</div><div class="line">&#125;</div><div class="line"><span class="comment">//MARK:- 正则匹配用户身份证号15或18位</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">checkUserIdCard</span>(<span class="title">_</span> <span class="title">idCard</span>:<span class="title">String</span>) -&gt;<span class="title">Bool</span> </span>&#123;</div><div class="line">    <span class="keyword">let</span> pattern = <span class="string">"(^[0-9]&#123;15&#125;$)|([0-9]&#123;17&#125;([0-9]|X)$)"</span>;</div><div class="line">    <span class="keyword">let</span> pred = <span class="type">NSPredicate</span>(format: <span class="string">"SELF MATCHES %@"</span>, pattern)</div><div class="line">    <span class="keyword">let</span> isMatch:<span class="type">Bool</span> = pred.evaluate(with: idCard)</div><div class="line">    <span class="keyword">return</span> isMatch;</div><div class="line">&#125;</div><div class="line"><span class="comment">//MARK:- 正则匹配用户密码6-18位数字和字母组合</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">checkPassword</span>(<span class="title">_</span> <span class="title">password</span>:<span class="title">String</span>) -&gt;<span class="title">Bool</span> </span>&#123;</div><div class="line">    <span class="keyword">let</span> pattern = <span class="string">"^(?![0-9]+$)(?![a-zA-Z]+$)[a-zA-Z0-9]&#123;6,18&#125;"</span></div><div class="line">    <span class="keyword">let</span> pred = <span class="type">NSPredicate</span>(format: <span class="string">"SELF MATCHES %@"</span>, pattern)</div><div class="line">    <span class="keyword">let</span> isMatch:<span class="type">Bool</span> = pred.evaluate(with: password)</div><div class="line">    <span class="keyword">return</span> isMatch;</div><div class="line">&#125;</div><div class="line"><span class="comment">//MARK:- 正则匹配URL</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">checkURL</span>(<span class="title">_</span> <span class="title">url</span>:<span class="title">String</span>) -&gt;<span class="title">Bool</span> </span>&#123;</div><div class="line">    <span class="keyword">let</span> pattern = <span class="string">"^[0-9A-Za-z]&#123;1,50&#125;"</span></div><div class="line">    <span class="keyword">let</span> pred = <span class="type">NSPredicate</span>(format: <span class="string">"SELF MATCHES %@"</span>, pattern)</div><div class="line">    <span class="keyword">let</span> isMatch:<span class="type">Bool</span> = pred.evaluate(with: url)</div><div class="line">    <span class="keyword">return</span> isMatch;</div><div class="line">&#125;</div><div class="line"><span class="comment">//MARK:- 正则匹配用户姓名,20位的中文或英文</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">checkUserName</span>(<span class="title">_</span> <span class="title">userName</span>:<span class="title">String</span>) -&gt;<span class="title">Bool</span> </span>&#123;</div><div class="line">    <span class="keyword">let</span> pattern = <span class="string">"^[a-zA-Z\\u4E00-\\u9FA5]&#123;1,20&#125;"</span></div><div class="line">    <span class="keyword">let</span> pred = <span class="type">NSPredicate</span>(format: <span class="string">"SELF MATCHES %@"</span>, pattern)</div><div class="line">    <span class="keyword">let</span> isMatch:<span class="type">Bool</span> = pred.evaluate(with: userName)</div><div class="line">    <span class="keyword">return</span> isMatch;</div><div class="line">&#125;</div><div class="line"><span class="comment">//MARK:- 正则匹配用户email</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">checkEmail</span>(<span class="title">_</span> <span class="title">email</span>:<span class="title">String</span>) -&gt;<span class="title">Bool</span> </span>&#123;</div><div class="line">    <span class="keyword">let</span> pattern = <span class="string">"[A-Z0-9a-z._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]&#123;2,4&#125;"</span></div><div class="line">    <span class="keyword">let</span> pred = <span class="type">NSPredicate</span>(format: <span class="string">"SELF MATCHES %@"</span>, pattern)</div><div class="line">    <span class="keyword">let</span> isMatch:<span class="type">Bool</span> = pred.evaluate(with: email)</div><div class="line">    <span class="keyword">return</span> isMatch;</div><div class="line">&#125;</div><div class="line"><span class="comment">//MARK:- 只能是中文</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">isChinese</span>(<span class="title">_</span> <span class="title">str</span>:<span class="title">String</span>) -&gt;<span class="title">Bool</span> </span>&#123;</div><div class="line">    <span class="keyword">let</span> pattern = <span class="string">"^[\\u4e00-\\u9fa5]&#123;0,&#125;$"</span></div><div class="line">    <span class="keyword">let</span> pred = <span class="type">NSPredicate</span>(format: <span class="string">"SELF MATCHES %@"</span>, pattern)</div><div class="line">    <span class="keyword">let</span> isMatch:<span class="type">Bool</span> = pred.evaluate(with: str)</div><div class="line">    <span class="keyword">return</span> isMatch;</div><div class="line">&#125;</div><div class="line"><span class="comment">//MARK:- 正则匹配金额</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">checkMoney</span>(<span class="title">_</span> <span class="title">str</span>:<span class="title">String</span>) -&gt;<span class="title">Bool</span> </span>&#123;</div><div class="line">    <span class="keyword">let</span> pattern = <span class="string">"^[0-9]+(.[0-9]&#123;2&#125;)?$"</span></div><div class="line">    <span class="keyword">let</span> pred = <span class="type">NSPredicate</span>(format: <span class="string">"SELF MATCHES %@"</span>, pattern)</div><div class="line">    <span class="keyword">let</span> isMatch:<span class="type">Bool</span> = pred.evaluate(with: str)</div><div class="line">    <span class="keyword">return</span> isMatch;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/正则表达式/" rel="tag"># 正则表达式</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/10/14/iOS常用宏定义（Swift篇）/" rel="next" title="iOS常用宏定义（Siwft篇）">
                <i class="fa fa-chevron-left"></i> iOS常用宏定义（Siwft篇）
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/09/14/R.swift使用/" rel="prev" title="R.swift使用">
                R.swift使用 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2016/09/14/R.swift使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                R.swift使用
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-14T03:29:11+08:00">
                2016-09-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2016/09/14/R.swift使用/" class="leancloud_visitors" data-flag-title="R.swift使用">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>使用CocoaPods来对R.Swift进行安装：</p>
<p><code>pod &#39;R.swift&#39;</code></p>
<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><ol>
<li>进入项目的配置界面，在左边的TARGETS项下面选择我们的项目，并在右边点击<code>Build Phases</code>这个tab。</li>
<li>进入<code>&lt;Build Phases&gt;</code>这个tab后，我们看到左上角有一个”+”按钮，点击并在弹出的选项卡中选择<code>New Run Script Phase</code>。</li>
<li>我们会看到界面的下方多出了一个<code>Run Script</code>项，展开它，并在脚本输入区域输入<code>&quot;\$PODS_ROOT/R.swift/rswift&quot;</code> “\$SRCROOT” (第二对双引号括起来所代码的是项目的根目录，你也可以放到根目录下的其他目录中，只需将其修改为”$SRCROOT/XXX”，XXX为目标目录名)。<br>4.我们按住新建的这个<code>Run Script</code>项向上移动，移到<code>Compile Source</code>项的上方，不过也要保证此时它也在<code>Check Pods Manifest.lock</code>项的下方。</li>
<li>Command + B，编译一下，编译成功后，在Finder进入到刚刚我们制定的目录中，此时我们会看到一个名为R.generated.swift的文件已经创建了，直接把此文件拖入Xcode项目中，<strong>记住不要勾选Copy items if needed项</strong>。</li>
<li>配置到此完成，我们可以构建自己的项目了</li>
</ol>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><h4 id="Image-图片"><a href="#Image-图片" class="headerlink" title="Image - 图片"></a>Image - 图片</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">//  不使用R.Swift</span></div><div class="line"><span class="keyword">let</span> pImage = <span class="type">UIImage</span>(named: <span class="string">"image_test"</span>)</div><div class="line"><span class="comment">//  使用R.Swift</span></div><div class="line"><span class="keyword">let</span> nImage = <span class="type">R</span>.image.image_test()</div></pre></td></tr></table></figure>
<h4 id="File-数据文件"><a href="#File-数据文件" class="headerlink" title="File - 数据文件"></a>File - 数据文件</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">//  不使用R.Swift</span></div><div class="line"><span class="keyword">let</span> pFile = <span class="type">NSBundle</span>.mainBundle().pathForResource(<span class="string">"DataFile"</span>, ofType: <span class="string">"json"</span>)</div><div class="line"><span class="comment">//  使用R.Swift</span></div><div class="line"><span class="keyword">let</span> nFile = <span class="type">R</span>.file.dataFileJson.path()</div></pre></td></tr></table></figure>
<h4 id="Font-字体"><a href="#Font-字体" class="headerlink" title="Font - 字体"></a>Font - 字体</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">//  不使用R.Swift</span></div><div class="line"><span class="keyword">let</span> pFont = <span class="type">UIFont</span>(name: <span class="string">"chalkduster"</span>, size: <span class="number">35</span>)</div><div class="line"><span class="comment">//  使用R.Swift</span></div><div class="line"><span class="keyword">let</span> nFont = <span class="type">R</span>.font.chalkduster(size: <span class="number">35</span>)</div><div class="line"><span class="comment">//  你看，非常神奇，在上面的方法中你不仅可以选择字体类型，还能设置字体大小</span></div></pre></td></tr></table></figure>
<h4 id="Color-颜色"><a href="#Color-颜色" class="headerlink" title="Color - 颜色"></a>Color - 颜色</h4><p>把.clr文件拖入项目中即可使用颜色配置<br><code>let appRedColor = R.color.myAppColor.red()</code></p>
<h4 id="Nibs"><a href="#Nibs" class="headerlink" title="Nibs"></a>Nibs</h4><p>不使用R.swift</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">let</span> nameOfNib = <span class="string">"CustomView"</span></div><div class="line"><span class="keyword">let</span> customViewNib = <span class="type">UINib</span>(nibName: <span class="string">"CustomView"</span>, bundle: <span class="literal">nil</span>)</div><div class="line"><span class="keyword">let</span> rootViews = customViewNib.instantiate(withOwner: <span class="literal">nil</span>, options: <span class="literal">nil</span>)</div><div class="line"><span class="keyword">let</span> customView = rootViews[<span class="number">0</span>] <span class="keyword">as</span>? <span class="type">CustomView</span></div><div class="line"></div><div class="line"><span class="keyword">let</span> viewControllerWithNib = <span class="type">CustomViewController</span>(nibName: <span class="string">"CustomView"</span>, bundle: <span class="literal">nil</span>)</div></pre></td></tr></table></figure>
<p>使用 R.swift</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">let</span> nameOfNib = <span class="type">R</span>.nib.customView.name</div><div class="line"><span class="keyword">let</span> customViewNib = <span class="type">R</span>.nib.customView()</div><div class="line"><span class="keyword">let</span> rootViews = <span class="type">R</span>.nib.customView.instantiateWithOwner(<span class="literal">nil</span>)</div><div class="line"><span class="keyword">let</span> customView = <span class="type">R</span>.nib.customView.firstView(owner: <span class="literal">nil</span>)</div><div class="line"></div><div class="line"><span class="keyword">let</span> viewControllerWithNib = <span class="type">CustomViewController</span>(nib: <span class="type">R</span>.nib.customView)</div></pre></td></tr></table></figure>
<h4 id="Localized-strings"><a href="#Localized-strings" class="headerlink" title="Localized strings"></a>Localized strings</h4><p>不使用R.swift</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">let</span> welcomeMessage = <span class="type">NSLocalizedString</span>(<span class="string">"welcome.message"</span>, comment: <span class="string">""</span>)</div><div class="line"><span class="keyword">let</span> settingsTitle = <span class="type">NSLocalizedString</span>(<span class="string">"title"</span>, tableName: <span class="string">"Settings"</span>, comment: <span class="string">""</span>)</div><div class="line"></div><div class="line"><span class="comment">// Formatted strings</span></div><div class="line"><span class="keyword">let</span> welcomeName = <span class="type">String</span>(format: <span class="type">NSLocalizedString</span>(<span class="string">"welcome.withName"</span>, comment: <span class="string">""</span>), locale: <span class="type">NSLocale</span>.current, <span class="string">"Alice"</span>)</div><div class="line"></div><div class="line"><span class="comment">// Stringsdict files</span></div><div class="line"><span class="keyword">let</span> progress = <span class="type">String</span>(format: <span class="type">NSLocalizedString</span>(<span class="string">"copy.progress"</span>, comment: <span class="string">""</span>), locale: <span class="type">NSLocale</span>.current, <span class="number">4</span>, <span class="number">23</span>)</div></pre></td></tr></table></figure>
<p>使用 R.swift</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">// Localized strings are grouped per table (.strings file)</span></div><div class="line"><span class="keyword">let</span> welcomeMessage = <span class="type">R</span>.string.localizable.welcomeMessage()</div><div class="line"><span class="keyword">let</span> settingsTitle = <span class="type">R</span>.string.settings.title()</div><div class="line"></div><div class="line"><span class="comment">// Functions with parameters are generated for format strings</span></div><div class="line"><span class="keyword">let</span> welcomeName = <span class="type">R</span>.string.localizable.welcomeWithName(<span class="string">"Alice"</span>)</div><div class="line"></div><div class="line"><span class="comment">// Functions with named argument labels are generated for stringsdict keys</span></div><div class="line"><span class="keyword">let</span> progress = <span class="type">R</span>.string.localizable.copyProgress(completed: <span class="number">4</span>, total: <span class="number">23</span>)</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/Swift/" rel="tag"># Swift</a>
          
            <a href="/tags/第三方库/" rel="tag"># 第三方库</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/10/04/常用正则表达式/" rel="next" title="常用正则表达式">
                <i class="fa fa-chevron-left"></i> 常用正则表达式
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/09/14/iOS常用的第三方库/" rel="prev" title="iOS常用的第三方库">
                iOS常用的第三方库 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2016/09/14/iOS常用的第三方库/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                iOS常用的第三方库
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-14T01:37:51+08:00">
                2016-09-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2016/09/14/iOS常用的第三方库/" class="leancloud_visitors" data-flag-title="iOS常用的第三方库">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <ol>
<li>DZNEmptyDataSet （空白提示-提升用户体验） <a href="https://github.com/dzenbot/DZNEmptyDataSet" target="_blank" rel="external">github地址</a></li>
<li>MagicalRecord （数据库-CoreData的封装） <a href="https://github.com/magicalpanda/MagicalRecord" target="_blank" rel="external">github地址</a></li>
<li>Chameleon (色彩框架） <a href="https://github.com/ViccAlexander/Chameleon" target="_blank" rel="external">github地址</a></li>
<li>TextFieldEffects （文本输入框）  <a href="https://github.com/raulriera/TextFieldEffects" target="_blank" rel="external">github地址</a></li>
<li>Spring  （动画框架）  <a href="https://github.com/MengTo/Spring" target="_blank" rel="external">github地址</a></li>
<li>GPUImage  (图片处理)  <a href="http://github.com/BradLarson/GPUImage" target="_blank" rel="external">github地址</a></li>
<li>iRate (用户评论)    <a href="https://github.com/nicklockwood/iRate" target="_blank" rel="external">github地址</a></li>
<li>MGSwipeTableCell  (可滑动cell)  <a href="https://github.com/MortimerGoro/MGSwipeTableCell" target="_blank" rel="external">github地址</a></li>
<li>FontBlaster （自定义字体加载到APP）  <a href="https://github.com/ArtSabintsev/FontBlaster" target="_blank" rel="external">github地址</a></li>
<li>quick   (单元测试)   <a href="https://github.com/Quick/Quick" target="_blank" rel="external">github地址</a></li>
<li>FlatUIKit   (扁平化UI的iOS组件)   <a href="https://github.com/Grouper/FlatUIKit" target="_blank" rel="external">github地址</a></li>
<li>AlamofireObjectMapper  (JSON数据转换成对象) <a href="https://github.com/tristanhimmelman/AlamofireObjectMapper" target="_blank" rel="external">github地址</a></li>
<li>SnipKit (Masonry Swift版本 自动布局)  <a href="https://github.com/SnapKit/SnapKit" target="_blank" rel="external">github地址</a></li>
<li>Shimmer (有闪烁效果的第三方控件)  <a href="https://github.com/facebook/Shimmer" target="_blank" rel="external">github地址</a></li>
<li>RESideMenu (侧滑效果)  <a href="https://github.com/romaonthego/RESideMenu" target="_blank" rel="external">github地址</a></li>
<li>RealtimeGradientText (渐变label)  <a href="https://github.com/kevinzhow/RealtimeGradientText" target="_blank" rel="external">github地址</a></li>
<li>JVFloatLabeledTextField  (floating textfield) <a href="https://github.com/jverdi/JVFloatLabeledTextField" target="_blank" rel="external">github地址</a></li>
<li>SWTableViewCell (滑动Cell)   <a href="https://github.com/CEWendel/SWTableViewCell" target="_blank" rel="external">github地址</a></li>
<li>MonkeyKing （社交分享） <a href="https://github.com/nixzhu/MonkeyKing" target="_blank" rel="external">github地址</a></li>
<li>R.swift （以一种优雅安全的方式使用资源文件）  <a href="https://github.com/mac-cain13/R.swift" target="_blank" rel="external">github地址</a></li>
<li>Moya  (Alamofire的封装)   <a href="https://github.com/Moya/Moya" target="_blank" rel="external">github地址</a></li>
<li>SwiftyUserDefaults (UserDefults 封装)   <a href="https://github.com/radex/SwiftyUserDefaults" target="_blank" rel="external">github地址</a>  <a href="quiver:///notes/66EFF11D-55FB-4918-BE2C-7C83D3C654BB" target="_blank" rel="external">SwiftyUserDefaults 使用</a></li>
<li>FillableLoaders (自定义的进度加载动画)   <a href="https://github.com/poolqf/FillableLoaders" target="_blank" rel="external">github地址</a></li>
<li>SwiftString  （字符串扩展）  <a href="https://github.com/amayne/SwiftString" target="_blank" rel="external">github地址</a></li>
<li>ExSwift  (Swift基础类型扩展库)  <a href="https://github.com/pNre/ExSwift#instance-methods-5" target="_blank" rel="external">github地址</a></li>
<li>Koloda   （卡片视图）   <a href="https://github.com/Yalantis/Koloda" target="_blank" rel="external">github地址</a></li>
<li>ImagePicker  （图片选择器）   <a href="https://github.com/hyperoslo/ImagePicker" target="_blank" rel="external">github地址</a></li>
<li>Material     <a href="https://github.com/CosmicMind/Material" target="_blank" rel="external">github地址</a></li>
<li>IFTTT/RazzleDazzle  (集成引导页，IFTTT)  <a href="https://github.com/IFTTT/RazzleDazzle" target="_blank" rel="external">github地址</a></li>
<li>Instructions    (用法指南，介绍页面)     <a href="https://github.com/ephread/Instructions" target="_blank" rel="external">github地址</a></li>
<li>Animated Tab Bar （动画Tab Bar）   <a href="https://github.com/Ramotion/animated-tab-bar" target="_blank" rel="external">github地址</a></li>
<li>Adaptive Tab Bar                <a href="https://github.com/Ramotion/adaptive-tab-bar" target="_blank" rel="external">github地址</a></li>
<li>ESTabBarController     （Tab Bar）   <a href="https://github.com/eggswift/ESTabBarController" target="_blank" rel="external">github地址</a></li>
<li>Eureka   (动态TableView)    <a href="https://github.com/xmartlabs/Eureka" target="_blank" rel="external">github地址</a> <a href="http://blog.csdn.net/sps900608/article/details/51768854#comments" target="_blank" rel="external">用法</a></li>
<li>folding-cell   (折叠动画cell)    <a href="https://github.com/Ramotion/folding-cell" target="_blank" rel="external">github地址</a></li>
<li>SCLAlertView    (alert view)     <a href="https://github.com/vikmeup/SCLAlertView-Swift" target="_blank" rel="external">github地址</a></li>
<li>SweetAlert-iOS   (alert view)     <a href="https://github.com/codestergit/SweetAlert-iOS" target="_blank" rel="external">github地址</a></li>
<li>DOFavoriteButton    (twitter 风格点赞按钮)     <a href="https://github.com/okmr-d/DOFavoriteButton" target="_blank" rel="external">github地址</a></li>
<li>LiquidFloatingActionButton  (floating button 动画nice)  <a href="https://github.com/yoavlt/LiquidFloatingActionButton" target="_blank" rel="external">github地址</a></li>
<li>ZFRippleButton （Material 风格按钮） <a href="https://github.com/zoonooz/ZFRippleButton" target="_blank" rel="external">github地址</a></li>
<li>DynamicButton  (动态按钮)   <a href="https://github.com/yannickl/DynamicButton" target="_blank" rel="external">github地址</a></li>
<li>paper-switch  (改变父视图效果的Switch)  <a href="https://github.com/Ramotion/paper-switch" target="_blank" rel="external">github地址</a></li>
<li>LTMorphingLabel  （动画Label）    <a href="https://github.com/lexrus/LTMorphingLabel" target="_blank" rel="external">github地址</a></li>
<li>ActiveLabel.swift  （有很多效果的label hashtag） <a href="https://github.com/optonaut/ActiveLabel.swift" target="_blank" rel="external">github地址</a></li>
<li>TextFieldEffects   （有很多效果的textfield）  <a href="https://github.com/raulriera/TextFieldEffects" target="_blank" rel="external">github地址</a></li>
<li>PhoneNumberKit    (针对电话输入的textfield)   <a href="https://github.com/marmelroy/PhoneNumberKit" target="_blank" rel="external">github地址</a></li>
<li>SkyFloatingLabelTextField （Material 风格textfield） <a href="https://github.com/Skyscanner/SkyFloatingLabelTextField" target="_blank" rel="external">github地址</a></li>
<li>NextGrowingTextView (自适应高度的TextView)    <a href="https://github.com/muukii/NextGrowingTextView" target="_blank" rel="external">github地址</a></li>
<li>Hue (颜色  color)    <a href="https://github.com/hyperoslo/Hue" target="_blank" rel="external">github地址</a></li>
<li>TextAttributes   (封装 NSAttributeString)  <a href="https://github.com/delba/TextAttributes" target="_blank" rel="external">github地址</a></li>
<li>SwiftOCR   <a href="https://github.com/garnele007/SwiftOCR" target="_blank" rel="external">github地址</a></li>
<li>Gifu   (GIF)    <a href="https://github.com/kaishin/Gifu" target="_blank" rel="external">github地址</a></li>
<li>FlowingMenu  (手势侧滑menu)   <a href="https://github.com/yannickl/FlowingMenu" target="_blank" rel="external">github地址</a></li>
<li>circle-menu   （圆形动画菜单）  <a href="https://github.com/Ramotion/circle-menu" target="_blank" rel="external">github地址</a></li>
<li>PageMenu   （分页效果）  <a href="https://github.com/uacaps/PageMenu" target="_blank" rel="external">github地址</a></li>
<li>XLPagerTabStrip  (Material 风格分页效果)  <a href="https://github.com/xmartlabs/XLPagerTabStrip" target="_blank" rel="external">github地址</a></li>
<li>Timepiece  （NSDate相关）  <a href="https://github.com/naoty/Timepiece" target="_blank" rel="external">github地址</a></li>
<li>Cosmos     (评分控件)    <a href="https://github.com/marketplacer/Cosmos" target="_blank" rel="external">github地址</a></li>
<li>ZFPlayer    (视频播放)   <a href="https://github.com/renzifeng/ZFPlayer" target="_blank" rel="external">github地址</a></li>
</ol>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/第三方库/" rel="tag"># 第三方库</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/09/14/R.swift使用/" rel="next" title="R.swift使用">
                <i class="fa fa-chevron-left"></i> R.swift使用
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/09/01/CocoaPods Podfile/" rel="prev" title="CocoaPods Podfile">
                CocoaPods Podfile <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2016/09/01/CocoaPods Podfile/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                CocoaPods Podfile
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-09-01T12:52:05+08:00">
                2016-09-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2016/09/01/CocoaPods Podfile/" class="leancloud_visitors" data-flag-title="CocoaPods Podfile">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="Podfile-语法改变"><a href="#Podfile-语法改变" class="headerlink" title="Podfile 语法改变"></a>Podfile 语法改变</h1><p>CocoaPods 1.0版本有一些改变， 会直接让现在已有的 Podfile 不能工作：</p>
<ul>
<li>必须指明 <code>target</code></li>
<li><code>:exclusive =&gt; true</code> 和 <code>link_with</code> 被去掉了</li>
<li><code>pod install</code> 默认不再进行 <code>pod repo update</code></li>
</ul>
<h1 id="inhibit-all-warnings"><a href="#inhibit-all-warnings" class="headerlink" title="inhibit_all_warnings!"></a>inhibit_all_warnings!</h1><p><code>inhibit_all_warnings!</code> 屏蔽所有来自于cocoapods依赖库的警告。你可以全局定义，也能在子target里面定义，也可以指定某一个库：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line"># 隐藏SSZipArchive的警告而不隐藏ShowTVAuth的警告</div><div class="line">pod &apos;SSZipArchive&apos;, :inhibit_warnings =&gt; true</div><div class="line">pod &apos;ShowTVAuth&apos;, :inhibit_warnings =&gt; false</div></pre></td></tr></table></figure>
<h1 id="Build-configurations（编译配置）"><a href="#Build-configurations（编译配置）" class="headerlink" title="Build configurations（编译配置）"></a>Build configurations（编译配置）</h1><p>默认情况下， 依赖项会被安装在所有target的build configuration中。为了调试或者处于其他原因，依赖项只能在给定的build configuration中被启用。<br>下面写法指明只有在Debug和Beta模式下才有启用配置：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">pod &apos;DebugFramework&apos;, :configurations =&gt; [&apos;Debug&apos;, &apos;Beta&apos;]</div></pre></td></tr></table></figure>
<p>或者，可以弄白名单只指定一个build configurations。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">pod &apos;DebugFramework&apos;, :configuration =&gt; &apos;Debug&apos;</div></pre></td></tr></table></figure>
<h1 id="Subspecs"><a href="#Subspecs" class="headerlink" title="Subspecs"></a>Subspecs</h1><p>一般情况我们会通过依赖库的名称来引入，cocoapods会默认安装依赖库的所有内容。<br>我们也可以指定安装具体依赖库的某个子模块，例如：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line"># 仅安装QueryKit库下的Attribute模块</div><div class="line">pod &apos;QueryKit/Attribute&apos;</div><div class="line"># 仅安装QueryKit下的Attribute和QuerySet模块</div><div class="line">pod &apos;QueryKit&apos;, :subspecs =&gt; [&apos;Attribute&apos;, &apos;QuerySet&apos;]</div></pre></td></tr></table></figure>
<h1 id="Using-the-files-from-a-local-path-使用本地文件"><a href="#Using-the-files-from-a-local-path-使用本地文件" class="headerlink" title="Using the files from a local path (使用本地文件)"></a>Using the files from a local path (使用本地文件)</h1><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">pod &apos;AFNetworking&apos;, :path =&gt; &apos;~/Documents/AFNetworking&apos;</div></pre></td></tr></table></figure>
<h1 id="有时我们需要引入依赖库指定的分支或节点，写法如下。"><a href="#有时我们需要引入依赖库指定的分支或节点，写法如下。" class="headerlink" title="有时我们需要引入依赖库指定的分支或节点，写法如下。"></a>有时我们需要引入依赖库指定的分支或节点，写法如下。</h1><p>引入master分支（默认）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">pod &apos;AFNetworking&apos;, :git =&gt; &apos;https://github.com/gowalla/AFNetworking.git&apos;</div></pre></td></tr></table></figure>
<p>引入指定的分支</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">pod &apos;AFNetworking&apos;, :git =&gt; &apos;https://github.com/gowalla/AFNetworking.git&apos;, :branch =&gt; &apos;dev&apos;</div></pre></td></tr></table></figure>
<p>引入某个节点的代码</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">pod &apos;AFNetworking&apos;, :git =&gt; &apos;https://github.com/gowalla/AFNetworking.git&apos;, :tag =&gt; &apos;0.7.0&apos;</div></pre></td></tr></table></figure>
<p>引入某个特殊的提交节点</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">pod &apos;AFNetworking&apos;, :git =&gt; &apos;https://github.com/gowalla/AFNetworking.git&apos;, :commit =&gt; &apos;082f8319af</div></pre></td></tr></table></figure>
<h1 id="target"><a href="#target" class="headerlink" title="target"></a>target</h1><p>在给定的块内定义pod的target（Xcode工程中的target）和指定依赖的范围。一个target应该与Xcode工程的target有关联。默认情况下，target会包含定义在块外的依赖，除非指定不使用<code>inherit!</code>来继承（说的是嵌套的块里的继承问题）</p>
<p>定义一个简单target ZipApp引入SSZipArchive库</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">target &apos;ZipApp&apos; do </div><div class="line">pod &apos;SSZipArchive&apos;</div><div class="line">end</div></pre></td></tr></table></figure>
<p>定义一个ZipApptarget仅引入SSZipArchive库，定义ZipAppTeststarget 引入Nimble的同时也会继承ZipApptarget里面的SSZipArchive库</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">target &apos;ZipApp&apos; do </div><div class="line">    pod &apos;SSZipArchive&apos; </div><div class="line">    target &apos;ZipAppTests&apos; do</div><div class="line">        inherit! :search_paths </div><div class="line">        pod &apos;Nimble&apos; </div><div class="line">    end</div><div class="line">end</div></pre></td></tr></table></figure>
<p>target块中嵌套多个子块</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">target &apos;ShowsApp&apos; do</div><div class="line">    # ShowsApp 仅仅引入ShowsKit</div><div class="line">    pod &apos;ShowsKit&apos; </div><div class="line">    # 引入 ShowsKit 和 ShowTVAuth </div><div class="line">    target &apos;ShowsTV&apos; do </div><div class="line">        pod &apos;ShowTVAuth&apos; </div><div class="line">    end </div><div class="line">    # 引入了Specta和Expecta以及ShowsKit</div><div class="line">    target &apos;ShowsTests&apos; do </div><div class="line">        inherit! :search_paths </div><div class="line">        pod &apos;Specta&apos; </div><div class="line">        pod &apos;Expecta&apos; </div><div class="line">    end</div><div class="line">end</div></pre></td></tr></table></figure>
<h1 id="抽象target"><a href="#抽象target" class="headerlink" title="抽象target"></a>抽象target</h1><p>定义一个新的抽象目标，它可以方便的用于目标依赖继承。</p>
<p>简单写法</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">abstract_target &apos;Networking&apos; do</div><div class="line">    pod &apos;AlamoFire&apos; </div><div class="line">    target &apos;Networking App 1&apos; </div><div class="line">    target &apos;Networking App 2&apos;</div><div class="line">end</div></pre></td></tr></table></figure>
<p>定义一种abstract_target包含多个target</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line"># 注意：这是个抽象的target也就是说在工程中并没有这个target引入ShowsKit</div><div class="line">abstract_target &apos;Shows&apos; do</div><div class="line">    pod &apos;ShowsKit&apos;</div><div class="line">    # ShowsiOS target会引入ShowWebAuth库以及继承自Shows的ShowsKit库</div><div class="line">    target &apos;ShowsiOS&apos; do</div><div class="line">         pod &apos;ShowWebAuth&apos;</div><div class="line">    end</div><div class="line">  # ShowsTV target会引入ShowTVAuth库以及继承自Shows的ShowsKit库</div><div class="line">    target &apos;ShowsTV&apos; do</div><div class="line">        pod &apos;ShowTVAuth&apos;</div><div class="line">    end</div><div class="line">    # ShowsTests target引入了Specta和Expecta库，并且指明继承Shows，所以也会引入ShowsKit</div><div class="line">    target &apos;ShowsTests&apos; do</div><div class="line">        inherit! :search_paths </div><div class="line">        pod &apos;Specta&apos; </div><div class="line">        pod &apos;Expecta&apos; </div><div class="line">    end</div><div class="line">end</div></pre></td></tr></table></figure>
<h2 id="abstract-和-inherit"><a href="#abstract-和-inherit" class="headerlink" title="abstract! 和 inherit!"></a>abstract! 和 inherit!</h2><p><code>abstract!</code> 指示当前的target是抽象的，因此不会直接链接Xcode target。<br><code>inherit!</code> 设置当前target的继承模式。例如：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">target &apos;App&apos; do</div><div class="line">    target &apos;AppTests&apos; do</div><div class="line">        inherit! :search_paths </div><div class="line">    end</div><div class="line">end</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/09/14/iOS常用的第三方库/" rel="next" title="iOS常用的第三方库">
                <i class="fa fa-chevron-left"></i> iOS常用的第三方库
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/07/14/iOS常用宏定义（OC篇）/" rel="prev" title="iOS常用宏定义（OC篇）">
                iOS常用宏定义（OC篇） <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2016/07/14/iOS常用宏定义（OC篇）/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                iOS常用宏定义（OC篇）
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-07-14T12:53:33+08:00">
                2016-07-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2016/07/14/iOS常用宏定义（OC篇）/" class="leancloud_visitors" data-flag-title="iOS常用宏定义（OC篇）">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="OC"><a href="#OC" class="headerlink" title="OC"></a>OC</h2><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">//获取屏幕宽度和高度</span></div><div class="line"><span class="meta">#define SCREEN_WIDTH   [UIScreen mainScreen].bounds.size.width</span></div><div class="line"><span class="meta">#define SCREENH_HEIGHT [UIScreen mainScreen].bounds.size.height</span></div></pre></td></tr></table></figure>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">//支持横屏的宽度和高度</span></div><div class="line"><span class="meta">#if __IPHONE_OS_VERSION_MAX_ALLOWED &gt;= 80000 // 当前Xcode支持iOS8及以上</span></div><div class="line"></div><div class="line"><span class="meta">#define SCREEN_WIDTH ([[UIScreen mainScreen] respondsToSelector:@selector(nativeBounds)]?[UIScreen mainScreen].nativeBounds.size.width/[UIScreen mainScreen].nativeScale:[UIScreen mainScreen].bounds.size.width)</span></div><div class="line"></div><div class="line"><span class="meta">#define SCREENH_HEIGHT ([[UIScreen mainScreen] respondsToSelector:@selector(nativeBounds)]?[UIScreen mainScreen].nativeBounds.size.height/[UIScreen mainScreen].nativeScale:[UIScreen mainScreen].bounds.size.height)</span></div><div class="line"></div><div class="line"><span class="meta">#define SCREEN_SIZE ([[UIScreen mainScreen] respondsToSelector:@selector(nativeBounds)]?CGSizeMake([UIScreen mainScreen].nativeBounds.size.width/[UIScreen mainScreen].nativeScale,[UIScreen mainScreen].nativeBounds.size.height/[UIScreen mainScreen].nativeScale):[UIScreen mainScreen].bounds.size)</span></div><div class="line"><span class="meta">#else</span></div><div class="line"><span class="meta">#define SCREEN_WIDTH [UIScreen mainScreen].bounds.size.width</span></div><div class="line"><span class="meta">#define SCREENH_HEIGHT [UIScreen mainScreen].bounds.size.height</span></div><div class="line"><span class="meta">#define SCREEN_SIZE [UIScreen mainScreen].bounds.size</span></div><div class="line"><span class="meta">#endif</span></div><div class="line"></div><div class="line"><span class="comment">//通知中心</span></div><div class="line"><span class="meta">#define LRNotificationCenter [NSNotificationCenter defaultCenter]</span></div><div class="line"><span class="comment">//获取随机颜色</span></div><div class="line"><span class="meta">#define LRRandomColor [UIColor colorWithRed:arc4random_uniform(256)/255.0 green:arc4random_uniform(256)/255.0 blue:arc4random_uniform(256)/255.0 alpha:1.0]</span></div><div class="line"><span class="comment">//设置RGB颜色</span></div><div class="line"><span class="meta">#define LRRGBColor(r, g, b) [UIColor colorWithRed:(r)/255.0 green:(g)/255.0 blue:(b)/255.0 alpha:1.0]</span></div><div class="line"><span class="meta">#define LRRGBAColor(r, g, b, a) [UIColor colorWithRed:(r)/255.0 green:(r)/255.0 blue:(r)/255.0 alpha:a]</span></div><div class="line"><span class="comment">// clear背景颜色</span></div><div class="line"><span class="meta">#define LRClearColor [UIColor clearColor]</span></div><div class="line"><span class="comment">//Log</span></div><div class="line"><span class="meta">#ifdef DEBUG</span></div><div class="line"><span class="meta">#define XYLog(...) NSLog(@<span class="meta-string">"%s 第%d行 \n %@\n\n"</span>,__func__,__LINE__,[NSString stringWithFormat:__VA_ARGS__])</span></div><div class="line"><span class="meta">#else</span></div><div class="line"><span class="meta">#define XYLog(...)</span></div><div class="line"><span class="meta">#endif</span></div><div class="line"></div><div class="line"><span class="comment">//判断是否为iPhone</span></div><div class="line"><span class="meta">#define IS_IPHONE (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPhone)</span></div><div class="line"><span class="meta">#define IS_IPHONE ([[[UIDevice currentDevice] model] isEqualToString:@<span class="meta-string">"iPhone"</span>])</span></div><div class="line"></div><div class="line"><span class="comment">//判断是否为iPad</span></div><div class="line"><span class="meta">#define IS_IPAD (UI_USER_INTERFACE_IDIOM() == UIUserInterfaceIdiomPad)</span></div><div class="line"><span class="meta">#define IS_IPAD ([[[UIDevice currentDevice] model] isEqualToString:@<span class="meta-string">"iPad"</span>])</span></div><div class="line"></div><div class="line"><span class="comment">//判断是否为ipod</span></div><div class="line"><span class="meta">#define IS_IPOD ([[[UIDevice currentDevice] model] isEqualToString:@<span class="meta-string">"iPod touch"</span>])</span></div><div class="line"></div><div class="line"><span class="comment">// 判断是否为 iPhone 5SE</span></div><div class="line"><span class="meta">#define iPhone5SE [[UIScreen mainScreen] bounds].size.width == 320.0f &amp;&amp; [[UIScreen mainScreen] bounds].size.height == 568.0f</span></div><div class="line"></div><div class="line"><span class="comment">// 判断是否为iPhone 6/6s</span></div><div class="line"><span class="meta">#define iPhone6_6s [[UIScreen mainScreen] bounds].size.width == 375.0f &amp;&amp; [[UIScreen mainScreen] bounds].size.height == 667.0f</span></div><div class="line"></div><div class="line"><span class="comment">// 判断是否为iPhone 6Plus/6sPlus</span></div><div class="line"><span class="meta">#define iPhone6Plus_6sPlus [[UIScreen mainScreen] bounds].size.width == 414.0f &amp;&amp; [[UIScreen mainScreen] bounds].size.height == 736.0f</span></div><div class="line"></div><div class="line"><span class="comment">//获取系统版本</span></div><div class="line"><span class="meta">#define IOS_SYSTEM_STRING [[UIDevice currentDevice] systemVersion]</span></div><div class="line"></div><div class="line"><span class="comment">//判断 iOS 8 或更高的系统版本</span></div><div class="line"><span class="meta">#define IOS_VERSION_8_OR_LATER (([[[UIDevice currentDevice] systemVersion] floatValue] &gt;=8.0)? (YES):(NO))</span></div><div class="line"></div><div class="line"><span class="comment">// 判断是不是iOS系统，如果是iOS系统在真机和模拟器输出都是YES</span></div><div class="line"><span class="meta">#if TARGET_OS_IPHONE  </span></div><div class="line"><span class="meta">#endif  </span></div><div class="line"></div><div class="line"><span class="meta">#if (TARGET_IPHONE_SIMULATOR)    </span></div><div class="line">          <span class="comment">// 在模拟器的情况下</span></div><div class="line"><span class="meta">#else</span></div><div class="line">         <span class="comment">// 在真机情况下</span></div><div class="line"><span class="meta">#endif</span></div><div class="line"></div><div class="line"><span class="comment">//获取temp</span></div><div class="line"><span class="meta">#define kPathTemp NSTemporaryDirectory()</span></div><div class="line"></div><div class="line"><span class="comment">//获取沙盒 Document</span></div><div class="line"><span class="meta">#define kPathDocument [NSSearchPathForDirectoriesInDomains(NSDocumentDirectory, NSUserDomainMask, YES) firstObject]</span></div><div class="line"></div><div class="line"><span class="comment">//获取沙盒 Cache</span></div><div class="line"><span class="meta">#define kPathCache [NSSearchPathForDirectoriesInDomains(NSCachesDirectory, NSUserDomainMask, YES) firstObject]</span></div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/OC/" rel="tag"># OC</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/09/01/CocoaPods Podfile/" rel="next" title="CocoaPods Podfile">
                <i class="fa fa-chevron-left"></i> CocoaPods Podfile
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2016/02/14/使用AlamofireObjectMapper/" rel="prev" title="使用AlamofireObjectMapper">
                使用AlamofireObjectMapper <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2016/02/14/使用AlamofireObjectMapper/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                使用AlamofireObjectMapper
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2016-02-14T19:14:25+08:00">
                2016-02-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2016/02/14/使用AlamofireObjectMapper/" class="leancloud_visitors" data-flag-title="使用AlamofireObjectMapper">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>通常网络请求返回的是JSON数据，使用ObjectMapper可以让JSON数据直接转化为对象，而使用Alamofire进行网络请求时，使用AlamofireObjectMapper可以直接返回对象，更加简洁。</p>
<p>###CocoaPods 导入AlamofireObjectMapper<br><figure class="highlight plain"><figcaption><span>'AlamofireObjectMapper', '~> 3.0'```</span></figcaption><table><tr><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line">这里采用的Alamofire的测试接口 https://httpbin.org/get</div><div class="line"></div><div class="line">在浏览器中打开可以看到JSON格式的数据：</div><div class="line"></div><div class="line">```JSON</div><div class="line">&#123;</div><div class="line">  &quot;args&quot;: &#123;&#125;, </div><div class="line">  &quot;headers&quot;: &#123;</div><div class="line">    &quot;Accept&quot;: &quot;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&quot;, </div><div class="line">    &quot;Accept-Encoding&quot;: &quot;gzip, deflate, br&quot;, </div><div class="line">    &quot;Accept-Language&quot;: &quot;zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3&quot;, </div><div class="line">    &quot;Cache-Control&quot;: &quot;max-age=0&quot;, </div><div class="line">    &quot;Host&quot;: &quot;httpbin.org&quot;, </div><div class="line">    &quot;User-Agent&quot;: &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10.11; rv:46.0) Gecko/20100101 Firefox/46.0&quot;</div><div class="line">  &#125;, </div><div class="line">  &quot;origin&quot;: &quot;202.115.52.218&quot;, </div><div class="line">  &quot;url&quot;: &quot;https://httpbin.org/get&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>根据该JSON的数据格式创建以下两个Mapper类分别对应整个字典和key值为“header”的字典。将JSON中的数据与对象中的数据一一建立转化关系。</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> Foundation</div><div class="line"><span class="keyword">import</span> ObjectMapper</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">ResponseHeader</span>: <span class="title">Mappable</span> </span>&#123;</div><div class="line"></div><div class="line">    <span class="keyword">var</span> accept : <span class="type">String</span>?</div><div class="line">    <span class="keyword">var</span> acceptEncoding : <span class="type">String</span>?</div><div class="line">    <span class="keyword">var</span> acceptLanguage : <span class="type">String</span>?</div><div class="line">    <span class="keyword">var</span> cacheControl : <span class="type">String</span>?</div><div class="line">    <span class="keyword">var</span> host : <span class="type">String</span>?</div><div class="line">    <span class="keyword">var</span> userAgent : <span class="type">String</span>?</div><div class="line"></div><div class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(<span class="number">_</span> <span class="built_in">map</span>: <span class="type">Map</span>) &#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//映射heades字典中的所有键值</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">mapping</span><span class="params">(<span class="built_in">map</span>: Map)</span></span> &#123;</div><div class="line">        accept &lt;- <span class="built_in">map</span>[<span class="string">"Accept"</span>]</div><div class="line">        acceptEncoding &lt;- <span class="built_in">map</span>[<span class="string">"Accept-Encoding"</span>]</div><div class="line">        acceptLanguage &lt;- <span class="built_in">map</span>[<span class="string">"Accept-Language"</span>]</div><div class="line">        cacheControl &lt;- <span class="built_in">map</span>[<span class="string">"Cache-Control"</span>]</div><div class="line">        host &lt;- <span class="built_in">map</span>[<span class="string">"Host"</span>]</div><div class="line">        userAgent &lt;- <span class="built_in">map</span>[<span class="string">"User-Agent"</span>]</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">import</span> Foundation</div><div class="line"><span class="keyword">import</span> ObjectMapper</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyResponse</span>: <span class="title">Mappable</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> args : <span class="type">NSDictionary</span>?</div><div class="line">    <span class="keyword">var</span> headers : <span class="type">ResponseHeader</span>?</div><div class="line">    <span class="keyword">var</span> origin : <span class="type">String</span>?</div><div class="line">    <span class="keyword">var</span> url : <span class="type">String</span>?</div><div class="line"></div><div class="line">    <span class="keyword">required</span> <span class="keyword">init</span>?(<span class="number">_</span> <span class="built_in">map</span>: <span class="type">Map</span>) &#123;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="comment">//映射字典中的所有键值</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">mapping</span><span class="params">(<span class="built_in">map</span>: Map)</span></span> &#123;</div><div class="line">        args &lt;- <span class="built_in">map</span>[<span class="string">"args"</span>]</div><div class="line">        headers &lt;- <span class="built_in">map</span>[<span class="string">"headers"</span>]</div><div class="line">        origin &lt;- <span class="built_in">map</span>[<span class="string">"origin"</span>]</div><div class="line">        url &lt;- <span class="built_in">map</span>[<span class="string">"url"</span>]</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>用Alamofire获取对象</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">webRequst</span><span class="params">()</span></span>  &#123;</div><div class="line">    <span class="keyword">let</span> url = <span class="string">"https://httpbin.org/get"</span></div><div class="line">    <span class="comment">//注意返回的类型为&lt;Mappable对象,NSError&gt;</span></div><div class="line">    <span class="type">Alamofire</span>.request(.<span class="type">GET</span>, url).responseObject &#123; (response: <span class="type">Response</span>&lt;<span class="type">MyResponse</span>, <span class="type">NSError</span>&gt;) <span class="keyword">in</span></div><div class="line">        <span class="keyword">let</span> myResponse = response.result.value</div><div class="line">        <span class="built_in">print</span>(myResponse?.url)</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> header = myResponse?.headers&#123;</div><div class="line">            <span class="built_in">print</span>(header.userAgent)</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/第三方库/" rel="tag"># 第三方库</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/07/14/iOS常用宏定义（OC篇）/" rel="next" title="iOS常用宏定义（OC篇）">
                <i class="fa fa-chevron-left"></i> iOS常用宏定义（OC篇）
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/10/15/Swift-中泛型的使用/" rel="prev" title="Swift 中泛型的使用">
                Swift 中泛型的使用 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
        
        <div class="collection-title">
          <h2 class="archive-year motion-element" id="archive-year-2015">2015</h2>
        </div>
      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/10/15/Swift-中泛型的使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Swift 中泛型的使用
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-10-15T15:09:58+08:00">
                2015-10-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/10/15/Swift-中泛型的使用/" class="leancloud_visitors" data-flag-title="Swift 中泛型的使用">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>对于类型安全(type-safe)语言，一个常见的问题就是如何编写适用于多种类型输入的程序。想象一下，两个整型数相加和两个浮点数相加的程序看起来应该非常类似，甚至一模一样才对。唯一的区别就是变量的类型不同。</p>
<p>在强类型语言中，你需要去定义诸如addInts, addFloats, addDoubles 等方法来正确地处理参数及返回值。</p>
<p>许多编程语言已经解决了这个问题。例如，在C++中，使用Template来解决。而Swift，Java和C#则采用了泛型来解决这个问题。</p>
<p>下面用有序字典（Ordered Dictionaries）来简单说明一下泛型的用法：</p>
<p>和数组不同的是，包括Swift在内地很多编程语言和框架都不保证集合(sets)和字典(dictionaries)的数据存储顺序。有序字典和普通的字典类似，不同之处在于它的key是有序的。</p>
<h4 id="创建有序字典"><a href="#创建有序字典" class="headerlink" title="创建有序字典"></a>创建有序字典</h4><p>点击“文件\新建\文件…”新建一个文件，并选择“IOS\Source\Swift File”。点击“下一步”并把这个文件命名为“OrderedDictionary”。最后，点击“创建”。</p>
<p>你会得到一个空的Swift文件，加这样一段代码进去：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">OrderedDictionary</span> </span>&#123;  </div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>到现在为止应该都没有什么问题。通过语义可以看出这个对象是一个结构体。</p>
<p>现在你需要将其一般化，以便它能够装载你需要的任何类型的数据。通过下列改变你对Swift中“结构”的定义：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">struct OrderedDictionary&lt;KeyType, ValueType&gt;</div></pre></td></tr></table></figure>
<p>在尖括弧中的元素是通用类型的参数。KeyType和ValueType不是他们自身的类型，而是你可以使用在结构里定义取代的类型。现在就简洁清新许多了！</p>
<p>最简单的实现一个有顺序的字典是保持一个数组和一个字典。字典中将会装载衍射，而数组将装载keys的顺序。</p>
<p>在结构体内部的定义中，加入以下的代码：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">typealias</span> <span class="type">ArrayType</span> = [<span class="type">KeyType</span>]</div><div class="line"><span class="keyword">typealias</span> <span class="type">DictionaryType</span> = [<span class="type">KeyType</span>: <span class="type">ValueType</span>]</div><div class="line"><span class="keyword">var</span> array = <span class="type">ArrayType</span>()</div><div class="line"><span class="keyword">var</span> dictionary = <span class="type">DictionaryType</span>()</div></pre></td></tr></table></figure>
<p>这样声明有两个目的，就像上例描述的，有两种类型的用于给已经存在的类型的取新的名称的别名。在这，你将分别地为后面的数组和字典赋值了别名。声明别名是将复杂类型定义为更短名称的类型的一种非常有效的方式。</p>
<p>你将注意怎么样从结构体中定义用“KeyType”和“ValueType”的参数类型中替换类型。上例的”KeyTypes”是数组类型的。当然这是没有这样的类型的“KeyType”；当在一般的实例化时，将替代Swift像对OrderedDictionary的类型的一切类型通过。</p>
<p>就因为这样，你将会注意到编译错误：</p>
<pre><code>Type &apos;Keytype&apos; does not conform to protocol &apos;Hashable&apos;
</code></pre><p>这是因为你的字典Key没有遵循Hashable协议； 我们可以手动修改代码让Key遵循Hashable协议：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">struct</span> <span class="title">OrderedDictionary</span>&lt;<span class="title">KeyType</span>: <span class="title">Hashable</span>, <span class="title">ValueType</span></span></div></pre></td></tr></table></figure>
<p>接下来我们就需要正式建立有序字典了；</p>
<ul>
<li>添加count属性</li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> <span class="built_in">count</span>: <span class="type">Int</span> &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">self</span>.array.<span class="built_in">count</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>添加插入和移除方法</li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">removeAtIndex</span><span class="params">(index: Int)</span></span> -&gt; (<span class="type">KeyType</span>, <span class="type">ValueType</span>) &#123;</div><div class="line">    <span class="built_in">precondition</span>(index &lt; <span class="keyword">self</span>.array.<span class="built_in">count</span>, <span class="string">"Index 超出范围"</span>)</div><div class="line">    <span class="built_in">assert</span>(index &lt; <span class="keyword">self</span>.array.<span class="built_in">count</span>)</div><div class="line"></div><div class="line">    <span class="keyword">let</span> key = <span class="keyword">self</span>.array.removeAtIndex(index)</div><div class="line"></div><div class="line">    <span class="keyword">let</span> value = <span class="keyword">self</span>.dictionary.removeValueForKey(key)!</div><div class="line"></div><div class="line">    <span class="keyword">return</span> (key, value)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">mutating</span> <span class="function"><span class="keyword">func</span> <span class="title">insert</span><span class="params">(value: ValueType, forKey key: KeyType, atIndex index:Int)</span></span> -&gt; <span class="type">ValueType</span>? &#123;</div><div class="line">    <span class="keyword">var</span> adjustedIndex = index</div><div class="line"></div><div class="line">    <span class="keyword">let</span> existingValue = <span class="keyword">self</span>.dictionary[key]</div><div class="line"></div><div class="line">    <span class="keyword">if</span> existingValue != <span class="literal">nil</span> &#123;</div><div class="line">        <span class="keyword">let</span> existingIndex = <span class="keyword">self</span>.array.indexOf(key)</div><div class="line"></div><div class="line">        <span class="keyword">if</span> existingIndex &lt; index &#123;</div><div class="line">            adjustedIndex--</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">self</span>.array.removeAtIndex(existingIndex!)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">self</span>.array.insert(key, atIndex: adjustedIndex)</div><div class="line">    <span class="keyword">self</span>.dictionary[key] = value</div><div class="line"></div><div class="line">    <span class="keyword">return</span> existingValue</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>注意在结构体内如果方法需要修改结构体内的属性的话，要在方法前加mutating关键字；</p>
<ul>
<li>添加下标访问方法：</li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">subscript</span>(key: <span class="type">KeyType</span>) -&gt; <span class="type">ValueType</span>? &#123;</div><div class="line">    <span class="keyword">get</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">self</span>.dictionary[key]</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">set</span> &#123;</div><div class="line">        <span class="keyword">if</span> <span class="keyword">let</span> <span class="number">_</span> = <span class="keyword">self</span>.array.indexOf(key) &#123;&#125;<span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">self</span>.array.append(key)</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">self</span>.dictionary[key] = newValue</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">subscript</span>(index: <span class="type">Int</span>) -&gt;(<span class="type">KeyType</span>, <span class="type">ValueType</span>) &#123;</div><div class="line">    <span class="keyword">get</span> &#123;</div><div class="line">        <span class="built_in">precondition</span>(index &lt; <span class="keyword">self</span>.array.<span class="built_in">count</span>, <span class="string">"Index 超出范围"</span>)</div><div class="line"></div><div class="line">        <span class="keyword">let</span> key = <span class="keyword">self</span>.array[index]</div><div class="line"></div><div class="line">        <span class="keyword">let</span> value = <span class="keyword">self</span>.dictionary[key]!</div><div class="line"></div><div class="line">        <span class="keyword">return</span> (key, value)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这样我们就利用泛型创建了一个有序字典。</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/Swift/" rel="tag"># Swift</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2016/02/14/使用AlamofireObjectMapper/" rel="next" title="使用AlamofireObjectMapper">
                <i class="fa fa-chevron-left"></i> 使用AlamofireObjectMapper
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/10/15/Swift单例/" rel="prev" title="Swift单例">
                Swift单例 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/10/15/Swift单例/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Swift单例
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-10-15T14:58:10+08:00">
                2015-10-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/10/15/Swift单例/" class="leancloud_visitors" data-flag-title="Swift单例">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>单例是一个在 Cocoa 中很常用的模式了。对于一些希望能在全局方便访问的实例，或者在 app 的生命周期中只应该存在一个的对象，我们一般使用单例来存储和访问。在 Objective-C 中单例的公认的写法类似下面这样：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line">@implementation <span class="type">MyManager</span></div><div class="line">+ (id)sharedManager &#123;</div><div class="line">    <span class="keyword">static</span> <span class="type">MyManager</span> *staticInstance = <span class="literal">nil</span>;</div><div class="line">    <span class="keyword">static</span> dispatch_once_t onceToken;</div><div class="line"></div><div class="line">    dispatch_once(&amp;onceToken, ^&#123;</div><div class="line">        staticInstance = [[<span class="keyword">self</span> alloc] <span class="keyword">init</span>];</div><div class="line">    &#125;);</div><div class="line">    <span class="keyword">return</span> staticInstance;</div><div class="line">&#125;</div><div class="line">@end</div></pre></td></tr></table></figure>
<p>使用 GCD 中的 dispatch_once_t 可以保证里面的代码只被调用一次，以此保证单例在线程上的安全。</p>
<p>因为在 Swift 中可以无缝直接使用 GCD，所以我们可以很方便地把类似方式的单例用 Swift 进行改写：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyManager</span> </span>&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">var</span> <span class="title">sharedManager</span> : <span class="title">MyManager</span> </span>&#123;</div><div class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">Static</span> </span>&#123;</div><div class="line">            <span class="keyword">static</span> <span class="keyword">var</span> onceToken : dispatch_once_t = <span class="number">0</span></div><div class="line">            <span class="keyword">static</span> <span class="keyword">var</span> staticInstance : <span class="type">MyManager</span>? = <span class="literal">nil</span></div><div class="line">        &#125;</div><div class="line"></div><div class="line">        dispatch_once(&amp;<span class="type">Static</span>.onceToken) &#123;</div><div class="line">            <span class="type">Static</span>.staticInstance = <span class="type">MyManager</span>()</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="type">Static</span>.staticInstance!</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>因为 Swift 现在还暂时不支持存储的 class var，所以我们需要使用一个 struct 来存储类型变量。</p>
<p>这样的写法当然没什么问题，但是在 Swift 里我们其实有一个更简单的保证线程安全的方式，那就是 let。把上面的写法简化一下，可以变成：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyManager</span> </span>&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">var</span> <span class="title">sharedManager</span> : <span class="title">MyManager</span> </span>&#123;</div><div class="line">        <span class="class"><span class="keyword">struct</span> <span class="title">Static</span> </span>&#123;</div><div class="line">            <span class="keyword">static</span> <span class="keyword">let</span> sharedInstance : <span class="type">MyManager</span> = <span class="type">MyManager</span>()</div><div class="line">        &#125;</div><div class="line"></div><div class="line">        <span class="keyword">return</span> <span class="type">Static</span>.sharedInstance</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>还有另一种更受大家欢迎，并被认为是当前的最佳实践的做法。由于现在 class 不支持存储式的 property，我们想要使用一个只存在一份的属性时，就只能将其定义在全局的 scope 中。值得庆幸的是，在 Swift 拥有访问级别控制后，我们可以在变量定义前面加上 private 关键字，使这个变量只在当前文件中可以被访问。这样我们就可以写出一个没有嵌套的，语法上也更简单好看的单例了：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">private</span> <span class="keyword">let</span> sharedInstance = <span class="type">MyManager</span>()</div><div class="line"></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyManager</span>  </span>&#123;</div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">var</span> <span class="title">sharedManager</span> : <span class="title">MyManager</span> </span>&#123;</div><div class="line">        <span class="keyword">return</span> sharedInstance</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>最后一种是最简单也是最实用的，是swift给的语法糖</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/Swift/" rel="tag"># Swift</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/10/15/Swift-中泛型的使用/" rel="next" title="Swift 中泛型的使用">
                <i class="fa fa-chevron-left"></i> Swift 中泛型的使用
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/09/29/设计模式/" rel="prev" title="设计模式">
                设计模式 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/09/29/设计模式/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                设计模式
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-09-29T14:52:05+08:00">
                2015-09-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/09/29/设计模式/" class="leancloud_visitors" data-flag-title="设计模式">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>设计模式是为了解决特定问题而出现的；</p>
<p>设计模式的基本原则：</p>
<ul>
<li><p>开闭原则<br>模块应该对扩展开放而对修改关闭；</p>
</li>
<li><p>里氏代换原则<br>父类和子类之间的方法可以相互调换，从而方便修改；多态</p>
</li>
<li><p>依赖倒转原则<br>抽象不依赖于细节，细节依赖于抽象；</p>
</li>
<li><p>接口隔离原则<br>尽量保证接口只做必要的事情；</p>
</li>
<li><p>合成/聚合复用</p>
</li>
</ul>
<h3 id="适配器模式"><a href="#适配器模式" class="headerlink" title="适配器模式"></a>适配器模式</h3><p>比如iOS从网络请求加载数据，更新UI的时候，我们会初始化出一个model，随着后续版本的升级，这个model会持续添加参数，或者减少参数；此时如果我们直接修改这个model的话，那么就要同时修改与这个model相匹配的view，这样就会一只在两者之间修改来修改去，适配器模式就是为了解决这种问题存在的。</p>
<p>如果你运用了适配器模式，那么我们的model不会直接与view接触，它会先和适配器接触，然后再通过适配器去更新UI</p>
<h3 id="TODO"><a href="#TODO" class="headerlink" title="TODO"></a>TODO</h3>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/10/15/Swift单例/" rel="next" title="Swift单例">
                <i class="fa fa-chevron-left"></i> Swift单例
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/09/26/Mac自带Vim7-3不能使用系统剪切板解决方案/" rel="prev" title="Mac自带Vim7.3不能使用系统剪切板解决方案">
                Mac自带Vim7.3不能使用系统剪切板解决方案 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/09/26/Mac自带Vim7-3不能使用系统剪切板解决方案/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Mac自带Vim7.3不能使用系统剪切板解决方案
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-09-26T19:35:44+08:00">
                2015-09-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/09/26/Mac自带Vim7-3不能使用系统剪切板解决方案/" class="leancloud_visitors" data-flag-title="Mac自带Vim7.3不能使用系统剪切板解决方案">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>用了Mac自带的Vim之后发现yy复制的内容和剪切板不同步，谷歌之，找到2种方法：</p>
<ul>
<li>“+y </li>
<li>在 ~/.vimrc 里增加 set clipboard=unnamed</li>
</ul>
<p>但是完全不起任何作用，经过一番折腾之后才知道是Mac自带的Vim7.3版本不支持使用系统剪切板；<br>于是就安装了MacVim，结果试了之后还是不管用，执行</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">vim --version | grep clip</div></pre></td></tr></table></figure>
<p>结果还是：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">-clientserver -clipboard +cmdline_compl +cmdline_hist +cmdline_info +comments </div><div class="line">-xterm_clipboard -xterm_save</div></pre></td></tr></table></figure>
<p>原因是就算你安装了MacVim使用了Vim7.4系统自带的Terminal还是会默认使用自带的7.3版本；</p>
<p>所以只要在profile中添加如下语句就可以解决问题了；</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line"><span class="built_in">alias</span> vim=<span class="string">"/Applications/MacVim.app/Contents/MacOS/Vim"</span></div></pre></td></tr></table></figure>
<p>之后你在终端使用vim也会调用MacVim中的7.4版本了。</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Mac/" rel="tag"># Mac</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/09/29/设计模式/" rel="next" title="设计模式">
                <i class="fa fa-chevron-left"></i> 设计模式
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/09/26/Dynamics动画/" rel="prev" title="Dynamics动画">
                Dynamics动画 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/09/26/Dynamics动画/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Dynamics动画
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-09-26T01:29:21+08:00">
                2015-09-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/09/26/Dynamics动画/" class="leancloud_visitors" data-flag-title="Dynamics动画">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>UIKit Dynamics是iOS7中新推出的，可以模拟现实的二维动画效果，开发出逼真的物理动画。</p>
<h3 id="关键类"><a href="#关键类" class="headerlink" title="关键类"></a>关键类</h3><ul>
<li>UIDynamicAnimator：封装了底层的物理引擎，为动力项（UIDynamicItem）提供物理相关的功能和动画；</li>
<li>UIDynamicBehavior，动力行为，为动力项提供不同的物理行为；</li>
<li>UIDynamicItem，动力项，相当于现实世界中的一个基本物体；</li>
</ul>
<h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><ul>
<li>创建一个UIDynamicAnimator</li>
</ul>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="keyword">@property</span>(<span class="keyword">strong</span>, <span class="keyword">nonatomic</span>) <span class="built_in">UIDynamicAnimator</span> *dynamicAnimate;</div><div class="line"></div><div class="line">- (<span class="built_in">UIDynamicAnimator</span> *)dynamicAnimate&#123;</div><div class="line">    <span class="keyword">if</span> (!_dynamicAnimate) &#123;</div><div class="line">        _dynamicAnimate = [[<span class="built_in">UIDynamicAnimator</span> alloc] initWithReferenceView:<span class="keyword">self</span>.gameView];</div><div class="line">        _dynamicAnimate.delegate = <span class="keyword">self</span>;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> _dynamicAnimate;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>然后就可以把动力行为加到动画中了</li>
</ul>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">[<span class="keyword">self</span>.dynamicAnimate addBehavior:_dropItemBehavior];</div></pre></td></tr></table></figure>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/09/26/Mac自带Vim7-3不能使用系统剪切板解决方案/" rel="next" title="Mac自带Vim7.3不能使用系统剪切板解决方案">
                <i class="fa fa-chevron-left"></i> Mac自带Vim7.3不能使用系统剪切板解决方案
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/09/21/使用融云和LeanCloud-创建一个IM应用/" rel="prev" title="使用融云和LeanCloud 创建一个IM应用">
                使用融云和LeanCloud 创建一个IM应用 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/09/21/使用融云和LeanCloud-创建一个IM应用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                使用融云和LeanCloud 创建一个IM应用
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-09-21T01:39:23+08:00">
                2015-09-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/09/21/使用融云和LeanCloud-创建一个IM应用/" class="leancloud_visitors" data-flag-title="使用融云和LeanCloud 创建一个IM应用">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><a href="http://www.rongcloud.cn/" target="_blank" rel="external">融云</a> 是国内一家专门为APP开发者提供IM服务的公司，利用它提供的SDK可以快速使你的APP集成IM通讯能力。<br>详细的使用方法在它官网的开发文档中有提供，但是不得不吐槽的就是它的开发文档写的实在太乱了让人有种无从下手的感觉，下面简单记录一下使用过程。</p>
<h3 id="导入SDK"><a href="#导入SDK" class="headerlink" title="导入SDK"></a>导入SDK</h3><p>推荐使用CocoaPods导入：</p>
<ol>
<li>在Podfile中添加：</li>
</ol>
<p><code>pod &#39;RongCloudIMKit&#39;</code></p>
<ol>
<li>然后执行命令：</li>
</ol>
<p><code>pod install</code></p>
<h3 id="获取Token"><a href="#获取Token" class="headerlink" title="获取Token"></a>获取Token</h3><p>Token 也叫用户令牌，是 SDK 端用来连接融云服务器的凭证，每个用户连接服务器都需要一个 Token。每次初始化连接服务器时，都需要向服务器提交 Token。<br>获取Token需要注册一个融云的账号，然后新建一个应用，之后在API调试中填写userid（用户唯一标示符）、name（用户昵称）、portraitUri（头像url）就可以获得一个测试用的Token。</p>
<h3 id="初始化和测试连接"><a href="#初始化和测试连接" class="headerlink" title="初始化和测试连接"></a>初始化和测试连接</h3><p>获得测试用的Token之后就可以利用AppKey（创建应用时融云给你的应用标示符）和Token对应用进行初始化了：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">//用AppKey初始化     </span></div><div class="line"><span class="type">RCIM</span>.sharedRCIM().initWithAppKey(<span class="string">"82hegw5uh4r8x"</span>)      </div><div class="line"><span class="comment">//用Token测试连接</span></div><div class="line"><span class="type">RCIM</span>.sharedRCIM().connectWithToken(token, success: &#123; (str:<span class="type">String</span>!) -&gt; <span class="type">Void</span> <span class="keyword">in</span></div><div class="line"><span class="built_in">print</span>(<span class="string">"连接成功！"</span>)       </div><div class="line"><span class="comment">//连接成功后设置当前登陆用户信息</span></div><div class="line"><span class="type">RCIMClient</span>.sharedRCIMClient().currentUserInfo = <span class="type">RCUserInfo</span>(userId: id, name: name, portrait: avatorURL)</div><div class="line"></div><div class="line"><span class="comment">//在UserDefaults中保存Token</span></div><div class="line"><span class="type">NSUserDefaults</span>.standardUserDefaults().setObject(token, forKey: <span class="string">"kDeviceToken"</span>)</div><div class="line">	<span class="comment">//在主线程中调用更新UI</span></div><div class="line">dispatch_async(dispatch_get_main_queue(), &#123; () -&gt; <span class="type">Void</span> <span class="keyword">in</span></div><div class="line"></div><div class="line">&#125;)&#125;,error: &#123; (<span class="number">_</span>) -&gt; <span class="type">Void</span> <span class="keyword">in</span></div><div class="line">	<span class="built_in">print</span>(<span class="string">"连接错误！"</span>)</div><div class="line">&#125;)&#123; () -&gt; <span class="type">Void</span> <span class="keyword">in</span></div><div class="line">	<span class="built_in">print</span>(<span class="string">"Token不正确！"</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="连接成功后启动单聊会话"><a href="#连接成功后启动单聊会话" class="headerlink" title="连接成功后启动单聊会话"></a>连接成功后启动单聊会话</h3><p>融云在它的SDK中已经集成聊天用户界面，所以我们只要创建一个RCConversationViewController的实例就能使用它提供的用户界面了，同时用户界面也支持自定义，这部分在官网的开发文档中有详细的介绍，这里就不做赘述。<br>需要注意的是：要使用RCConversationViewController，必须给它的几个属性赋值：</p>
<ul>
<li>conversationType：聊天类型，有单聊、群聊等等</li>
</ul>
<p><code>self.conversationType = RCConversationType.ConversationType_PRIVATE //这里的PRIVATE是单聊</code></p>
<ul>
<li>targetId：聊天目标用户id</li>
</ul>
<p><code>self.targerId = &quot;&quot;</code></p>
<ul>
<li>userName:聊天目标用户的昵称</li>
</ul>
<p><code>self.userName = &quot;&quot;</code></p>
<ul>
<li>title:聊天界面显示的标题</li>
</ul>
<p><code>self.title = self.userName</code><br>RCConversationViewController中还有其他很多的属性可以自定义，比如用户头像形状之类的，这些可以在它的头文件中找到。</p>
<h3 id="测试单聊"><a href="#测试单聊" class="headerlink" title="测试单聊"></a>测试单聊</h3><p>设置好以上内容之后，单聊的工作就已经做好了，现在我们可以测试单聊的效果，这里由于还没有其他的用户，我们就先和自己聊天来测试一下单聊的效果；<br>把targerId设置成已经登录的id，然后就可以自己和自己聊天了，内部集成的界面还是挺简洁易用的，虽然是自己和自己聊天，但是他也不是在本地操作的，也要经过融云的服务器，所以你把网络断开的情况下是不能发出信息的。<br>到这里单聊已经实现了，但是你会发现聊天界面他是不会显示用户头像的，虽然你在初始化的时候给了一个头像的url，但是他是不会加载出来的，不得不说这一点确实很脑残，主要原因是融云为了安全起见，他的服务器是不会储存用户信息的，在融云那边只有一个Token和userid的对应关系，和你发送给他的好友关系，也就是说你的用户信息需要自己在用一个服务器存起来，然后向融云提供一个用户信息提供者；</p>
<h3 id="设置用户信息提供者"><a href="#设置用户信息提供者" class="headerlink" title="设置用户信息提供者"></a>设置用户信息提供者</h3><p>要设置用户信息提供者首先要实现RCIMUserInfoDataSource协议，所以我们要在APP启动的时候让Appdelegate实现协议，然后：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">getUserInfoWithUserId</span><span class="params">(userId: String!, completion: <span class="params">(<span class="params">(RCUserInfo!)</span></span></span></span> -&gt; <span class="type">Void</span>)!) &#123;</div><div class="line">    <span class="keyword">let</span> userInfo = <span class="type">RCUserInfo</span>()</div><div class="line">    userInfo.userId = userId</div><div class="line">    <span class="keyword">switch</span> userId&#123;</div><div class="line">    <span class="keyword">case</span> <span class="string">"xxx"</span>:</div><div class="line">        userInfo.name = <span class="string">"xxx"</span></div><div class="line">        userInfo.portraitUri = <span class="string">"http://7xl9qm.com1.z0.glb.clouddn.com/avatar.png"</span></div><div class="line">    <span class="keyword">case</span> <span class="string">"x"</span>:</div><div class="line">        userInfo.name = <span class="string">"A"</span></div><div class="line">        userInfo.portraitUri = <span class="string">"http://www4.qqjay.com/u/files/2011/1216/d3302821f418fc5539398cb3ba72cd8c.jpg"</span></div><div class="line">    <span class="keyword">case</span> <span class="string">"xxxxx"</span>:</div><div class="line">        userInfo.name = <span class="string">"B"</span></div><div class="line">        userInfo.portraitUri = <span class="string">"http://image.photophoto.cn/nm-6/018/030/0180300244.jpg"</span></div><div class="line">    <span class="keyword">case</span> <span class="string">"xxxx"</span>:</div><div class="line">        userInfo.name = <span class="string">"C"</span></div><div class="line">        userInfo.portraitUri = <span class="string">"http://cdn.duitang.com/uploads/item/201407/26/20140726221707_i4ZnL.thumb.224_0.jpeg"</span></div><div class="line">    <span class="keyword">default</span>:</div><div class="line">        <span class="built_in">print</span>(<span class="string">"no user"</span>)</div><div class="line">    &#125;</div><div class="line">    completion(userInfo)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/Swift/" rel="tag"># Swift</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/09/26/Dynamics动画/" rel="next" title="Dynamics动画">
                <i class="fa fa-chevron-left"></i> Dynamics动画
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/09/21/使用AVPlayer-播放在线音频/" rel="prev" title="使用AVPlayer 播放在线音频,并实现后台锁屏播放，自动连播">
                使用AVPlayer 播放在线音频,并实现后台锁屏播放，自动连播 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/09/21/使用AVPlayer-播放在线音频/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                使用AVPlayer 播放在线音频,并实现后台锁屏播放，自动连播
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-09-21T00:17:37+08:00">
                2015-09-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/09/21/使用AVPlayer-播放在线音频/" class="leancloud_visitors" data-flag-title="使用AVPlayer 播放在线音频,并实现后台锁屏播放，自动连播">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>在iOS开发中，AVAudioPlayer不是不能播放在线音频的，要播放在线音频只能用以下几个方法：</p>
<ul>
<li>AVPlayer</li>
<li>MPMoviePlayerController 能实现音乐流播（但是此方法苹果在iOS9中已经不推荐使用了）</li>
<li>Audioqueue，Audiostream （太复杂）</li>
<li>第三方库AudioStreamer（只能播放在线音频）</li>
</ul>
<p>所以用AVPlayer来实现在线音频播放是最好的选择；一下就是利用AVPlayer实现音乐流播并实现后台锁屏播放和设置自动连播的大概步骤：</p>
<p>项目源代码：<a href="https://github.com/xinnyu/DouBanFM" target="_blank" rel="external">Swift 2.0 版豆瓣电台</a></p>
<h3 id="初始化"><a href="#初始化" class="headerlink" title="初始化"></a>初始化</h3><p>先声明AVplayer和AVPlayerItem的实例：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> musicPlayer:<span class="type">AVPlayer</span>!</div><div class="line"><span class="keyword">var</span> playerItem:<span class="type">AVPlayerItem</span>?</div></pre></td></tr></table></figure>
<p>然后在需要的播放音频的地方给它赋值：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">self</span>.musicPlayer = <span class="type">AVPlayer</span>()</div><div class="line"><span class="keyword">let</span> playerLayer = <span class="type">AVPlayerLayer</span>(player: <span class="keyword">self</span>.musicPlayer)</div><div class="line"><span class="keyword">self</span>.view.layer.addSublayer(playerLayer)</div><div class="line"><span class="keyword">let</span> url = <span class="type">NSURL</span>(string: <span class="string">"   "</span>)</div><div class="line"><span class="comment">//替换当前的playerItem</span></div><div class="line"><span class="keyword">self</span>.musicPlayer.replaceCurrentItemWithPlayerItem(playerItem)</div><div class="line"><span class="comment">//开始播放</span></div><div class="line"><span class="keyword">self</span>.musicPlayer.play()</div></pre></td></tr></table></figure>
<p>以上就是实现播放在线音频的代码，但是如果要实现后台播放和自动连播的话，还要做以下工作：</p>
<h3 id="自动连播"><a href="#自动连播" class="headerlink" title="自动连播"></a>自动连播</h3><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">//当播放完成了之后发送通知，继续播放</span></div><div class="line"><span class="type">NSNotificationCenter</span>.defaultCenter().addObserver(<span class="keyword">self</span>, selector: <span class="string">"playerItemDidReachEnd:"</span>, name: <span class="type">AVPlayerItemDidPlayToEndTimeNotification</span>, object: playerItem)</div><div class="line"></div><div class="line"><span class="comment">//没有播放完成的通知       </span></div><div class="line"><span class="type">NSNotificationCenter</span>.defaultCenter().addObserver(<span class="keyword">self</span>, selector: <span class="string">"playerItemDidNotReachEnd"</span>, name: <span class="type">AVPlayerItemFailedToPlayToEndTimeNotification</span>, object: playerItem)</div><div class="line"></div><div class="line"><span class="comment">//接受到通知后响应的方法</span></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">playerItemDidReachEnd</span><span class="params">(aNotification:NSNotification)</span></span>&#123;</div><div class="line">	<span class="comment">//自动播放相关</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">playerItemDidNotReachEnd</span><span class="params">(aNotification:NSNotification)</span></span>&#123;</div><div class="line">	<span class="comment">//歌曲没有正常播放到结束</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><em>后台播放</em></p>
<p>如果是播放本地音频的话，后台播放只要在APP启动时加上：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">let</span> session = <span class="type">AVAudioSession</span>.sharedInstance()</div><div class="line"><span class="keyword">try</span>! session.setCategory(<span class="type">AVAudioSessionCategoryPlayback</span>)</div><div class="line"><span class="keyword">try</span>! session.setActive(<span class="literal">true</span>)</div></pre></td></tr></table></figure>
<p>然后在info.plist文件中添加：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">&lt;key&gt;UIBackgroundModes&lt;/key&gt;</div><div class="line">&lt;array&gt;</div><div class="line">&lt;string&gt;audio&lt;/string&gt;</div><div class="line">&lt;/array&gt;</div></pre></td></tr></table></figure>
<p>即可。</p>
<p>但是如果每一首歌都要请求网络的话，只做上述工作时行不通的，还要在实例化AVPlayer的地方加上：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">//后台播放</span></div><div class="line"><span class="keyword">var</span> bgTask:<span class="type">UIBackgroundTaskIdentifier</span> = <span class="number">0</span></div><div class="line"><span class="keyword">if</span> <span class="type">UIApplication</span>.sharedApplication().applicationState == <span class="type">UIApplicationState</span>.<span class="type">Background</span> &#123;</div><div class="line">	<span class="keyword">self</span>.musicPlayer.play()</div><div class="line">	netMusicIsPlaying = <span class="literal">true</span></div><div class="line"></div><div class="line">	<span class="keyword">let</span> app:<span class="type">UIApplication</span> = <span class="type">UIApplication</span>.sharedApplication()</div><div class="line">	<span class="keyword">let</span> newTask:<span class="type">UIBackgroundTaskIdentifier</span> = app.beginBackgroundTaskWithExpirationHandler(<span class="literal">nil</span>)</div><div class="line"><span class="keyword">if</span> newTask != <span class="type">UIBackgroundTaskInvalid</span> &#123;</div><div class="line">	app.endBackgroundTask(bgTask)</div><div class="line">	&#125;</div><div class="line">	bgTask = newTask</div><div class="line">&#125;<span class="keyword">else</span>&#123;</div><div class="line">	<span class="keyword">self</span>.musicPlayer.play()</div><div class="line">	netMusicIsPlaying = <span class="literal">true</span></div><div class="line">	isPlayOffline = <span class="literal">false</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这样才能实现真正的后台播放。</p>
<h3 id="锁屏界面和控制中心添加详情"><a href="#锁屏界面和控制中心添加详情" class="headerlink" title="锁屏界面和控制中心添加详情"></a>锁屏界面和控制中心添加详情</h3><p>首先要作以下准备工作</p>
<ul>
<li>在applicationDidEnterBackground中添加：<pre><code>application.beginReceivingRemoteControlEvents()
</code></pre></li>
<li>在ViewDidAppear中添加：</li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="type">UIApplication</span>.sharedApplication().beginReceivingRemoteControlEvents()</div><div class="line"><span class="keyword">self</span>.becomeFirstResponder()</div></pre></td></tr></table></figure>
<ul>
<li>在viewDidDisappear中添加：</li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="type">UIApplication</span>.sharedApplication().endReceivingRemoteControlEvents()</div><div class="line"><span class="keyword">self</span>.resignFirstResponder()</div></pre></td></tr></table></figure>
<ul>
<li>重写canBecomeFirstResponder方法</li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">canBecomeFirstResponder</span><span class="params">()</span></span> -&gt; <span class="type">Bool</span> &#123;</div><div class="line">	<span class="keyword">return</span> <span class="literal">true</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后把歌曲详情设置到锁屏界面：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">configNowPlayingInfoCenter</span><span class="params">()</span></span>&#123;</div><div class="line">	<span class="keyword">if</span> (<span class="type">NSClassFromString</span>(<span class="string">"MPNowPlayingInfoCenter"</span>) != <span class="literal">nil</span>) &#123;</div><div class="line">	    <span class="comment">//锁屏界面图片的存储方式          </span></div><div class="line">		<span class="keyword">let</span> mArt:<span class="type">MPMediaItemArtwork</span> = <span class="type">MPMediaItemArtwork</span>(image: currentSongPic)</div><div class="line">		<span class="comment">//锁屏界面信息字典</span></div><div class="line">		<span class="keyword">var</span> dic:[<span class="type">String</span> : <span class="type">AnyObject</span>] = [</div><div class="line">			<span class="type">MPMediaItemPropertyTitle</span> : currentSongTitle,</div><div class="line">			<span class="type">MPMediaItemPropertyArtist</span> : currentSongArtist,</div><div class="line">			<span class="type">MPMediaItemPropertyArtwork</span> : mArt</div><div class="line">		]</div><div class="line">		<span class="comment">//获取当前播放的时间和歌曲总时长    </span></div><div class="line">		<span class="keyword">let</span> time = <span class="keyword">self</span>.musicPlayer.currentTime()</div><div class="line">		<span class="keyword">let</span> duration = <span class="keyword">self</span>.musicPlayer.currentItem!.asset.duration</div><div class="line">		<span class="comment">//把信息传递给锁屏界面</span></div><div class="line">		dic.updateValue(<span class="type">NSNumber</span>(double: <span class="type">CMTimeGetSeconds</span>(time)), forKey: <span class="type">MPNowPlayingInfoPropertyElapsedPlaybackTime</span> )</div><div class="line">		dic.updateValue(<span class="type">NSNumber</span>(double: <span class="type">CMTimeGetSeconds</span>(duration)), forKey: <span class="type">MPMediaItemPropertyPlaybackDuration</span>)</div><div class="line">		dic.updateValue(<span class="type">NSNumber</span>(float: <span class="number">1.0</span>), forKey: <span class="type">MPNowPlayingInfoPropertyPlaybackRate</span>)</div><div class="line">		<span class="type">MPNowPlayingInfoCenter</span>.defaultCenter().nowPlayingInfo = dic</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>再处理锁屏和控制中心点击事件：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">remoteControlReceivedWithEvent</span><span class="params">(event: UIEvent?)</span></span> &#123;</div><div class="line">	<span class="keyword">if</span> event!.type == <span class="type">UIEventType</span>.<span class="type">RemoteControl</span> &#123;</div><div class="line">		<span class="keyword">if</span> event!.subtype == <span class="type">UIEventSubtype</span>.<span class="type">RemoteControlNextTrack</span> &#123;</div><div class="line">			<span class="comment">//下一曲</span></div><div class="line"></div><div class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span> event!.subtype == <span class="type">UIEventSubtype</span>.<span class="type">RemoteControlPause</span>&#123;</div><div class="line">			<span class="comment">//暂停按钮</span></div><div class="line"></div><div class="line">		&#125;<span class="keyword">else</span> <span class="keyword">if</span> event!.subtype == <span class="type">UIEventSubtype</span>.<span class="type">RemoteControlPlay</span>&#123;</div><div class="line">			<span class="comment">//播放按钮</span></div><div class="line"></div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="利用KVO监视播放器的缓存状态和播放状态"><a href="#利用KVO监视播放器的缓存状态和播放状态" class="headerlink" title="利用KVO监视播放器的缓存状态和播放状态"></a>利用KVO监视播放器的缓存状态和播放状态</h3><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">//先移除观察者      </span></div><div class="line"><span class="keyword">if</span> <span class="keyword">self</span>.musicPlayer.currentItem != <span class="literal">nil</span> &#123;</div><div class="line">	<span class="keyword">self</span>.musicPlayer.currentItem?.removeObserver(<span class="keyword">self</span>, forKeyPath: <span class="string">"status"</span>)</div><div class="line">	<span class="keyword">self</span>.musicPlayer.currentItem?.removeObserver(<span class="keyword">self</span>, forKeyPath: <span class="string">"loadedTimeRanges"</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">//添加观察者</span></div><div class="line">playerItem.addObserver(<span class="keyword">self</span>, forKeyPath: <span class="string">"status"</span>, options: .<span class="type">New</span>, context: <span class="literal">nil</span>)</div><div class="line">playerItem.addObserver(<span class="keyword">self</span>, forKeyPath: <span class="string">"loadedTimeRanges"</span>, options: .<span class="type">New</span>, context: <span class="literal">nil</span>)</div><div class="line"></div><div class="line"><span class="comment">//播放状态</span></div><div class="line">playerItem.addObserver(<span class="keyword">self</span>, forKeyPath: <span class="string">"status"</span>, options: .<span class="type">New</span>, context: <span class="literal">nil</span>)</div><div class="line"><span class="comment">//缓存进度</span></div><div class="line">playerItem.addObserver(<span class="keyword">self</span>, forKeyPath: <span class="string">"loadedTimeRanges"</span>, options: .<span class="type">New</span>, context: <span class="literal">nil</span>)</div><div class="line"></div><div class="line"><span class="comment">//属性改变了要实现的方法</span></div><div class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">observeValueForKeyPath</span><span class="params">(keyPath: String?, ofObject object: AnyObject?, change: [String : AnyObject]?, context: UnsafeMutablePointer&lt;Void&gt;)</span></span> &#123;</div><div class="line">	<span class="comment">//获取缓存进度</span></div><div class="line">	<span class="keyword">if</span> keyPath == <span class="string">"loadedTimeRanges"</span> &#123;</div><div class="line">	<span class="keyword">let</span> array = (object <span class="keyword">as</span>! <span class="type">AVPlayerItem</span>).loadedTimeRanges</div><div class="line">    <span class="keyword">if</span> <span class="keyword">let</span> range = array.first &#123;</div><div class="line">			<span class="comment">//当前缓存的总时间</span></div><div class="line">       <span class="keyword">let</span> rangeValue = range.<span class="type">CMTimeRangeValue</span></div><div class="line">       <span class="keyword">let</span> duration = rangeValue.duration</div><div class="line">			<span class="comment">//总时间换算成秒数</span></div><div class="line">       <span class="keyword">let</span> loadTime = <span class="type">CMTimeGetSeconds</span>(duration)</div><div class="line"></div><div class="line">	&#125;<span class="keyword">else</span>&#123;</div><div class="line">	<span class="comment">//获取当前播放状态</span></div><div class="line"></div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><em>获取到了缓存时间可以判断当前的缓存时间和当前播放时间的值，来判断网络状况，同时也可以在做视频播放器时用来作缓存条</em>。</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/Swift/" rel="tag"># Swift</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/09/21/使用融云和LeanCloud-创建一个IM应用/" rel="next" title="使用融云和LeanCloud 创建一个IM应用">
                <i class="fa fa-chevron-left"></i> 使用融云和LeanCloud 创建一个IM应用
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/09/20/SDWebImage使用/" rel="prev" title="SDWebImage使用">
                SDWebImage使用 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/09/20/SDWebImage使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                SDWebImage使用
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-09-20T23:45:43+08:00">
                2015-09-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/09/20/SDWebImage使用/" class="leancloud_visitors" data-flag-title="SDWebImage使用">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><a href="https://github.com/rs/SDWebImage" target="_blank" rel="external">SDWebImage</a>是一个著名的第三方库，它的作用是：</p>
<blockquote>
<p>Asynchronous image downloader with cache support with an UIImageView category.<br>就是一个异步加载图片并且支持缓存的UIImage分类；</p>
</blockquote>
<h3 id="使用方法："><a href="#使用方法：" class="headerlink" title="使用方法："></a>使用方法：</h3><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line">imageView.sd_setImageWithURL(<span class="type">NSURL</span>(string: <span class="string">""</span>), placeholderImage: <span class="type">UIImage</span>(named: <span class="string">"placeholder"</span>))</div></pre></td></tr></table></figure>
<p>清除缓存：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="type">SDImageCache</span>.sharedImageCache().cleanDisk()</div><div class="line"><span class="type">SDImageCache</span>.sharedImageCache().clearMemory()</div></pre></td></tr></table></figure>
<p>这个框架使用简单，然而而其中复杂的实现细节全部隐藏在这行代码之后；这边有一篇它的源代码分析：<a href="">http://draveness.me/ios-yuan-dai-ma-jie-xi-sdwebimage/</a></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/第三方库/" rel="tag"># 第三方库</a>
          
            <a href="/tags/OC/" rel="tag"># OC</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/09/21/使用AVPlayer-播放在线音频/" rel="next" title="使用AVPlayer 播放在线音频,并实现后台锁屏播放，自动连播">
                <i class="fa fa-chevron-left"></i> 使用AVPlayer 播放在线音频,并实现后台锁屏播放，自动连播
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/09/20/Facebook 动画库POP使用/" rel="prev" title="Facebook 动画库POP使用">
                Facebook 动画库POP使用 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/09/20/Facebook 动画库POP使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Facebook 动画库POP使用
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-09-20T22:53:46+08:00">
                2015-09-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/09/20/Facebook 动画库POP使用/" class="leancloud_visitors" data-flag-title="Facebook 动画库POP使用">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><a href="https://github.com/facebook/pop" target="_blank" rel="external">POP</a>是Facebook公司的一个开源项目，它是一个完全不同于Core Animation的动画引擎；它在基本的静态动画的基础上增加的弹簧动画与衰减动画 使之能创造出更真实更具物理性的交互动画 POP的API可以快速的与现有的ObjC代码集成并可以作用于任意对象的任意属性，POP是个相当成熟且久经考验的框架，Facebook出品的令人惊叹的Paper应用中的所有动画和效果即出自POP。</p>
<h3 id="使用方式："><a href="#使用方式：" class="headerlink" title="使用方式："></a>使用方式：</h3><p>POP默认支持三种动画 但同时也支持自定义动画</p>
<ul>
<li>POPBasicAnimation</li>
<li>POPSpringAnimation</li>
<li>POPDecayAnimation</li>
<li>POPCustomAnimation //自定义动画</li>
</ul>
<p>这里我们只讨论前三种，因为自定义动画还没用过；</p>
<h4 id="代码示例："><a href="#代码示例：" class="headerlink" title="代码示例："></a>代码示例：</h4><p><strong>BasicAnimation</strong></p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">let</span> rotation = <span class="type">POPBasicAnimation</span>(propertyNamed: kPOPLayerRotation[^<span class="type">POP</span>动画的参数])</div><div class="line">rotation.toValue = <span class="type">M_PI</span> * <span class="number">2</span></div><div class="line">rotation.duration = <span class="number">10</span></div><div class="line">rotation.repeatForever = <span class="literal">true</span></div><div class="line">rotation.timingFunction = <span class="type">CAMediaTimingFunction</span>(name: kCAMediaTimingFunctionLinear)</div><div class="line">        </div><div class="line"><span class="keyword">self</span>.layer.pop_addAnimation(rotation, forKey: <span class="string">"旋转"</span>)</div></pre></td></tr></table></figure>
<p>POPBasicAnimation提供四种时间曲线,这个和Core Animation中的是一样的：</p>
<ul>
<li>kCAMediaTimingFunctionLinear</li>
<li>kCAMediaTimingFunctionEaseIn</li>
<li>kCAMediaTimingFunctionEaseOut</li>
<li>kCAMediaTimingFunctionEaseInEaseOut</li>
</ul>
<p><strong>POPSpringAnimation</strong><br>弹性动画</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">//实例化POP</span></div><div class="line"><span class="keyword">let</span> scale = <span class="type">POPSpringAnimation</span>(propertyNamed:kPOPViewScaleXY)</div><div class="line"><span class="comment">//设置结束值</span></div><div class="line">scale.toValue = <span class="type">NSValue</span>(<span class="type">CGPointMake</span>(<span class="number">2</span>,<span class="number">2</span>))</div><div class="line"><span class="comment">//振幅，范围0-20</span></div><div class="line">scale.springBounciness = <span class="number">20</span></div><div class="line"><span class="comment">//振动速度,范围0-20</span></div><div class="line">scale.springSpeed = <span class="number">1</span></div><div class="line">view.layer.pop_addAnimatiom(scale,foKey:<span class="string">"scale"</span>)</div></pre></td></tr></table></figure>
<blockquote>
<p>弹性动画可配置的属性有：</p>
<ul>
<li>springBounciness:4.0    //[0-20] 弹力 越大则震动幅度越大</li>
<li>springSpeed     :12.0   //[0-20] 速度 越大则动画结束越快</li>
<li>dynamicsTension :0      //拉力  下面这三个都跟物理力学模拟相关 数值调整起来很费时，建议就用默认值</li>
<li>dynamicsFriction:0      //摩擦 同上</li>
<li>dynamicsMass    :0      //质量 同上</li>
</ul>
</blockquote>
<p><strong>POPDecayAnimation</strong><br>阻尼动画</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="type">POPDecayAnimation</span> *anDecay = [<span class="type">POPDecayAnimation</span> animationWithPropertyNamed:kPOPLayerPositionX];</div><div class="line">anDecay.velocity = @(<span class="number">600</span>);</div><div class="line">anDecay.beginTime = <span class="type">CACurrentMediaTime</span>() + <span class="number">1</span>.0f;</div><div class="line">[<span class="keyword">self</span>.square pop_addAnimation:anDecay forKey:@<span class="string">"position"</span>];</div></pre></td></tr></table></figure>
<p><em>注意:这里对POPDecayAnimation设置toValue是没有意义的 会被忽略(因为目的状态是动态计算得到的</em>)</p>
<blockquote>
<p>POPDecayAnimation可配置的属性与默认值有:<br>deceleration:0.998  //衰减系数(越小则衰减得越快)</p>
</blockquote>
<p><em>注意:POPDecayAnimation也是没有duration字段的 其动画持续时间由velocity与deceleration决定</em></p>
<p>POP默认支持的动画属性：</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">/**</span></div><div class="line"> Common CALayer property names.</div><div class="line"> */</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerBackgroundColor;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerBounds;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerCornerRadius;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerBorderWidth;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerBorderColor;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerOpacity;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerPosition;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerPositionX;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerPositionY;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerRotation;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerRotationX;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerRotationY;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerScaleX;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerScaleXY;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerScaleY;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerSize;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerSubscaleXY;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerSubtranslationX;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerSubtranslationXY;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerSubtranslationY;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerSubtranslationZ;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerTranslationX;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerTranslationXY;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerTranslationY;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerTranslationZ;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerZPosition;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerShadowColor;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerShadowOffset;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerShadowOpacity;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayerShadowRadius;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> Common CAShapeLayer property names.</div><div class="line"> */</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPShapeLayerStrokeStart;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPShapeLayerStrokeEnd;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPShapeLayerStrokeColor;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPShapeLayerFillColor;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> Common NSLayoutConstraint property names.</div><div class="line"> */</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLayoutConstraintConstant;</div><div class="line"></div><div class="line"></div><div class="line"><span class="meta">#if TARGET_OS_IPHONE</span></div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> Common UIView property names.</div><div class="line"> */</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPViewAlpha;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPViewBackgroundColor;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPViewBounds;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPViewCenter;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPViewFrame;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPViewScaleX;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPViewScaleXY;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPViewScaleY;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPViewSize;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPViewTintColor;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> Common UIScrollView property names.</div><div class="line"> */</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPScrollViewContentOffset;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPScrollViewContentSize;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPScrollViewZoomScale;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPScrollViewContentInset;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> Common UITableView property names.</div><div class="line"> */</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPTableViewContentOffset;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPTableViewContentSize;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> Common UICollectionView property names.</div><div class="line"> */</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPCollectionViewContentOffset;</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPCollectionViewContentSize;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> Common UINavigationBar property names.</div><div class="line"> */</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPNavigationBarBarTintColor;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> Common UIToolbar property names.</div><div class="line"> */</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPToolbarBarTintColor;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> Common UITabBar property names.</div><div class="line"> */</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPTabBarBarTintColor;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> Common UILabel property names.</div><div class="line"> */</div><div class="line"><span class="keyword">extern</span> <span class="built_in">NSString</span> * <span class="keyword">const</span> kPOPLabelTextColor;</div></pre></td></tr></table></figure>
<h4 id="自定义属性："><a href="#自定义属性：" class="headerlink" title="自定义属性："></a>自定义属性：</h4><p>POP默认支持的三种动画都继承自POPPropertyAnimation POPPropertyAnimation中定义了一个叫property的属性( 之前没有用到它是因为POP根据不同的默认动画属性帮你生成了默认的property) 而这个property则是用来驱动POP的动画效果中的重要一环。</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">POPAnimatableProperty *prop = [POPAnimatableProperty propertyWithName:<span class="string">@"prop"</span> initializer:^(POPMutableAnimatableProperty *prop) &#123;</div><div class="line">    <span class="comment">// read value</span></div><div class="line">    prop.readBlock = ^(<span class="keyword">id</span> obj, <span class="built_in">CGFloat</span> values[]) &#123;</div><div class="line">        </div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// write value</span></div><div class="line">    prop.writeBlock = ^(<span class="keyword">id</span> obj, <span class="keyword">const</span> <span class="built_in">CGFloat</span> values[]) &#123;</div><div class="line"></div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// dynamics threshold</span></div><div class="line">    prop.threshold = <span class="number">0.01</span>;</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
<p>其组成就是一个readBlock一个writeBlock和一个threashold</p>
<ul>
<li>readBlock告诉POP当前的属性值</li>
<li>writeBlock中修改变化后的属性值</li>
<li>threashold决定了动画变化间隔的阈值 值越大writeBlock的调用次数越少</li>
<li>POPAnimatableProperty其实是POP中一个比较重要的东西,像上面提到的POP自带的动画属性 查看源代码可以看到也只是POP自动帮你设置好了POPAnimatableProperty而已,其作用就是当动画的某个时间片被触发时,告诉系统如何根据当前时间片做出变化.</li>
</ul>
<p>下面是一个秒表动画，是利用自定义属性的POP做出来的：</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">POPAnimatableProperty *prop = [POPAnimatableProperty propertyWithName:<span class="string">@"countdown"</span> initializer:^(POPMutableAnimatableProperty *prop) &#123;</div><div class="line">        </div><div class="line">        prop.writeBlock = ^(<span class="keyword">id</span> obj, <span class="keyword">const</span> <span class="built_in">CGFloat</span> values[]) &#123;</div><div class="line">            <span class="built_in">UILabel</span> *lable = (<span class="built_in">UILabel</span>*)obj;</div><div class="line">            label.text = [<span class="built_in">NSString</span> stringWithFormat:<span class="string">@"%02d:%02d:%02d"</span>,(<span class="keyword">int</span>)values[<span class="number">0</span>]/<span class="number">60</span>,(<span class="keyword">int</span>)values[<span class="number">0</span>]%<span class="number">60</span>,(<span class="keyword">int</span>)(values[<span class="number">0</span>]*<span class="number">100</span>)%<span class="number">100</span>];</div><div class="line">        &#125;;</div><div class="line">        </div><div class="line"><span class="comment">//        prop.threshold = 0.01f;</span></div><div class="line">    &#125;];</div><div class="line">    </div><div class="line">    POPBasicAnimation *anBasic = [POPBasicAnimation linearAnimation];   <span class="comment">//秒表当然必须是线性的时间函数</span></div><div class="line">    anBasic.property = prop;    <span class="comment">//自定义属性</span></div><div class="line">    anBasic.fromValue = @(<span class="number">0</span>);   <span class="comment">//从0开始</span></div><div class="line">    anBasic.toValue = @(<span class="number">3</span>*<span class="number">60</span>);  <span class="comment">//180秒</span></div><div class="line">    anBasic.duration = <span class="number">3</span>*<span class="number">60</span>;    <span class="comment">//持续3分钟</span></div><div class="line">    anBasic.beginTime = <span class="built_in">CACurrentMediaTime</span>() + <span class="number">1.0</span>f;    <span class="comment">//延迟1秒开始</span></div><div class="line">    [label pop_addAnimation:anBasic forKey:<span class="string">@"countdown"</span>];</div></pre></td></tr></table></figure>
<p>出处：<a href="http://adad184.com/2015/03/11/intro-to-pop/" target="_blank" rel="external">http://adad184.com/2015/03/11/intro-to-pop/</a></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/第三方库/" rel="tag"># 第三方库</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/09/20/SDWebImage使用/" rel="next" title="SDWebImage使用">
                <i class="fa fa-chevron-left"></i> SDWebImage使用
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/09/20/SwiftyJSON使用/" rel="prev" title="SwiftyJSON使用">
                SwiftyJSON使用 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/09/20/SwiftyJSON使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                SwiftyJSON使用
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-09-20T22:14:38+08:00">
                2015-09-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/09/20/SwiftyJSON使用/" class="leancloud_visitors" data-flag-title="SwiftyJSON使用">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><a href="https://github.com/SwiftyJSON/SwiftyJSON" target="_blank" rel="external">SwiftJSON</a>是用Swift写的一个快速处理JSON数据的第三方库。</p>
<h3 id="使用方法："><a href="#使用方法：" class="headerlink" title="使用方法："></a>使用方法：</h3><figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">let json = JSON(data: dataFromNetworking)</div><div class="line">if let userName = json[&quot;name&quot;].string&#123;</div><div class="line">  //就这么简单取到了。</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<blockquote>
<p><a href="http://tangplin.github.io/swiftyjson/" target="_blank" rel="external">中文说明</a></p>
</blockquote>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/第三方库/" rel="tag"># 第三方库</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/09/20/Facebook 动画库POP使用/" rel="next" title="Facebook 动画库POP使用">
                <i class="fa fa-chevron-left"></i> Facebook 动画库POP使用
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/09/20/MJRefresh使用/" rel="prev" title="MJRefresh使用">
                MJRefresh使用 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/09/20/MJRefresh使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                MJRefresh使用
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-09-20T19:52:32+08:00">
                2015-09-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/iOS/" itemprop="url" rel="index">
                    <span itemprop="name">iOS</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          
             <span id="/2015/09/20/MJRefresh使用/" class="leancloud_visitors" data-flag-title="MJRefresh使用">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><a href="https://github.com/CoderMJLee/MJRefresh" target="_blank" rel="external">MJRefresh</a>是用法最简单的下拉刷新框架：一行代码搞定</p>
<p>支持 UIScrollView、UITableView、UICollectionView、UIWebView 的刷新</p>
<h3 id="基础用法"><a href="#基础用法" class="headerlink" title="基础用法"></a>基础用法</h3><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">//设置下拉刷新</span></div><div class="line"><span class="keyword">var</span> <span class="type">MJHeader</span> = <span class="type">MJRefreshNormalHeader</span>(refreshingTarget: <span class="keyword">self</span>, refreshingAction: <span class="string">"refresh"</span>)</div><div class="line"><span class="keyword">self</span>.myTabView.header = <span class="type">MJHeader</span></div><div class="line"><span class="comment">//设置上拉加载</span></div><div class="line"><span class="keyword">var</span> <span class="type">MJFooter</span> = <span class="type">MJRefreshAutoNormalFooter</span>(refreshingTarget: <span class="keyword">self</span>, refreshingAction: <span class="string">"load"</span>)</div><div class="line"><span class="keyword">self</span>.myTabView.footer = <span class="type">MJFooter</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">load</span><span class="params">()</span></span>&#123;  </div><div class="line">	<span class="comment">//执行加载动作</span></div><div class="line">	<span class="keyword">self</span>.myTabView.header.endRefreshing()</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">refresh</span><span class="params">()</span></span>&#123;  </div><div class="line">	<span class="comment">//执行刷新动作</span></div><div class="line">	<span class="keyword">self</span>.myTabView.footer.endRefreshing()</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="高级用法"><a href="#高级用法" class="headerlink" title="高级用法"></a>高级用法</h3><ol>
<li><p>下拉刷新控件的种类</p>
<ul>
<li>默认（Normal）：MJRefreshNormalHeader</li>
<li>动图（Gif）：MJRefreshGifHeader</li>
</ul>
</li>
<li><p>上拉刷新控件的种类</p>
<p> <em>自动刷新（Auto）</em></p>
<ul>
<li>默认（Normal）：MJRefreshAutoNormalFooter</li>
<li><p>动图（Gif）：MJRefreshAutoGifFooter</p>
<p><em>自动回弹（Back）</em></p>
</li>
<li>默认（Normal）：MJRefreshBackNormalFooter</li>
<li>动图（Gif）：MJRefreshBackGifFooter</li>
</ul>
</li>
</ol>
<p>####</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">// 设置文字</span></div><div class="line">[header setTitle:<span class="string">@"Pull down to refresh"</span> forState:MJRefreshStateIdle];</div><div class="line">[header setTitle:<span class="string">@"Release to refresh"</span> forState:MJRefreshStatePulling];</div><div class="line">[header setTitle:<span class="string">@"Loading ..."</span> forState:MJRefreshStateRefreshing];</div><div class="line"><span class="comment">// 设置字体</span></div><div class="line">header.stateLabel.font = [<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">15</span>];</div><div class="line">header.lastUpdatedTimeLabel.font = [<span class="built_in">UIFont</span> systemFontOfSize:<span class="number">14</span>];</div><div class="line"><span class="comment">// 设置颜色</span></div><div class="line">header.stateLabel.textColor = [<span class="built_in">UIColor</span> redColor];</div><div class="line">header.lastUpdatedTimeLabel.textColor = [<span class="built_in">UIColor</span> blueColor];</div><div class="line"></div><div class="line"><span class="comment">// 隐藏时间</span></div><div class="line">header.lastUpdatedTimeLabel.hidden = <span class="literal">YES</span>;</div><div class="line"><span class="comment">// 隐藏状态</span></div><div class="line">header.stateLabel.hidden = <span class="literal">YES</span>;</div></pre></td></tr></table></figure>
<h4 id="下拉加载"><a href="#下拉加载" class="headerlink" title="下拉加载"></a>下拉加载</h4><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="comment">// 设置回调（一旦进入刷新状态，就调用target的action，也就是调用self的loadMoreData方法）</span></div><div class="line">MJRefreshAutoGifFooter *footer = [MJRefreshAutoGifFooter footerWithRefreshingTarget:<span class="keyword">self</span> refreshingAction:<span class="keyword">@selector</span>(loadMoreData)];</div><div class="line"><span class="comment">// 设置刷新图片</span></div><div class="line">[footer setImages:refreshingImages forState:MJRefreshStateRefreshing];</div><div class="line"></div><div class="line"><span class="comment">// 隐藏刷新状态的文字</span></div><div class="line">footer.refreshingTitleHidden = <span class="literal">YES</span>;</div><div class="line"><span class="comment">// 如果没有上面的方法，就用footer.stateLabel.hidden = YES;</span></div><div class="line"></div><div class="line"><span class="comment">// 隐藏当前的上拉刷新控件</span></div><div class="line"><span class="keyword">self</span>.tableView.footer.hidden = <span class="literal">YES</span>;</div><div class="line"></div><div class="line"><span class="comment">// 变为没有更多数据的状态</span></div><div class="line">[footer noticeNoMoreData];</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/Swift/" rel="tag"># Swift</a>
          
            <a href="/tags/第三方库/" rel="tag"># 第三方库</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/09/20/SwiftyJSON使用/" rel="next" title="SwiftyJSON使用">
                <i class="fa fa-chevron-left"></i> SwiftyJSON使用
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/09/20/Alamofile使用/" rel="prev" title="Alamofile使用">
                Alamofile使用 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/09/20/Alamofile使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Alamofile使用
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-09-20T19:18:20+08:00">
                2015-09-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/09/20/Alamofile使用/" class="leancloud_visitors" data-flag-title="Alamofile使用">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><a href="https://github.com/Alamofire/Alamofire" target="_blank" rel="external">Alamofire</a> 是Swift版的 AFNetworking，是非常方便实用的第三方网络操作框架；</p>
<h3 id="使用方法："><a href="#使用方法：" class="headerlink" title="使用方法："></a>使用方法：</h3><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="type">Alamofire</span>.request(method: <span class="type">Method</span>, <span class="type">URLString</span>: <span class="type">URLStringConvertible</span>, parameters: [<span class="type">String</span> : <span class="type">AnyObject</span>]?, encoding: <span class="type">ParameterEncoding</span>, headers: [<span class="type">String</span> : <span class="type">String</span>]?).response (options: <span class="type">NSJSONReadingOptions</span>, completionHandler: &#123; (<span class="type">NSURLRequest</span>, <span class="type">NSHTTPURLResponse</span>?, <span class="type">NSData</span>?, <span class="type">NSError</span>?) -&gt; <span class="type">Void</span> <span class="keyword">in</span></div><div class="line">    <span class="comment">//操作数据</span></div><div class="line"></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<p>但是上面方法中有些参数可以省略，基本用法如下：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="type">Alamofire</span>.request(.<span class="type">GET</span>, <span class="string">"URL"</span>).responseJSON(options: <span class="type">NSJSONReadingOptions</span>.<span class="type">AllowFragments</span>) &#123; (<span class="number">_</span>, <span class="number">_</span>, json, <span class="number">_</span>) -&gt; <span class="type">Void</span> <span class="keyword">in</span></div><div class="line">    <span class="comment">//操作数据</span></div><div class="line">    </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="获取数据的方法"><a href="#获取数据的方法" class="headerlink" title="获取数据的方法"></a>获取数据的方法</h4><ul>
<li>response()</li>
<li>responseString(encoding: NSStringEncoding)</li>
<li>responseJSON(options: NSJSONReadingOptions)</li>
<li>responsePropertyList(options: NSPropertyListReadOptions)</li>
</ul>
<h4 id="HTTP-Methods"><a href="#HTTP-Methods" class="headerlink" title="HTTP Methods"></a>HTTP Methods</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">Method</span>: <span class="title">String</span> </span>&#123;</div><div class="line">    <span class="keyword">case</span> <span class="type">OPTIONS</span> = <span class="string">"OPTIONS"</span></div><div class="line">    <span class="keyword">case</span> <span class="type">GET</span> = <span class="string">"GET"</span></div><div class="line">    <span class="keyword">case</span> <span class="type">HEAD</span> = <span class="string">"HEAD"</span></div><div class="line">    <span class="keyword">case</span> <span class="type">POST</span> = <span class="string">"POST"</span></div><div class="line">    <span class="keyword">case</span> <span class="type">PUT</span> = <span class="string">"PUT"</span></div><div class="line">    <span class="keyword">case</span> <span class="type">PATCH</span> = <span class="string">"PATCH"</span></div><div class="line">    <span class="keyword">case</span> <span class="type">DELETE</span> = <span class="string">"DELETE"</span></div><div class="line">    <span class="keyword">case</span> <span class="type">TRACE</span> = <span class="string">"TRACE"</span></div><div class="line">    <span class="keyword">case</span> <span class="type">CONNECT</span> = <span class="string">"CONNECT"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="请求需要的参数parameters"><a href="#请求需要的参数parameters" class="headerlink" title="请求需要的参数parameters"></a>请求需要的参数parameters</h4><p>类型是一个字典 [String : AnyObject]</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">let</span> parameters = [</div><div class="line">    <span class="string">"foo"</span>: <span class="string">"bar"</span>,</div><div class="line">    <span class="string">"baz"</span>: [<span class="string">"a"</span>, <span class="number">1</span>],</div><div class="line">    <span class="string">"qux"</span>: [<span class="string">"x"</span>: <span class="number">1</span> , <span class="string">"y"</span>: <span class="number">2</span> , <span class="string">"z"</span>: <span class="number">3</span>]</div><div class="line">]</div><div class="line"><span class="type">Alamofire</span>.request(.<span class="type">POST</span>, <span class="string">"http://httpbin.org/post"</span>, parameters: parameters)</div></pre></td></tr></table></figure>
<h4 id="下载文件"><a href="#下载文件" class="headerlink" title="下载文件"></a>下载文件</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="type">Alamofire</span>.download(.<span class="type">GET</span>, <span class="string">"http://httpbin.org/stream/100"</span>) &#123; temporaryURL, response <span class="keyword">in</span></div><div class="line">    <span class="keyword">let</span> fileManager = <span class="type">NSFileManager</span>.defaultManager()</div><div class="line">    <span class="keyword">if</span> <span class="keyword">let</span> directoryURL = fileManager.<span class="type">URLsForDirectory</span>(.<span class="type">DocumentDirectory</span>, inDomains: .<span class="type">UserDomainMask</span>)[<span class="number">0</span>] <span class="keyword">as</span>? <span class="type">NSURL</span> &#123;</div><div class="line">        <span class="keyword">let</span> pathComponent = response.suggestedFilename</div><div class="line">        <span class="keyword">return</span> directoryURL.<span class="type">URLByAppendingPathComponent</span>(pathComponent!)</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    <span class="keyword">return</span> temporaryURL</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>这些都只是Alamofire的常规使用，更加详细的使用方法其官方网站上有详细描述。</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/Swift/" rel="tag"># Swift</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/09/20/MJRefresh使用/" rel="next" title="MJRefresh使用">
                <i class="fa fa-chevron-left"></i> MJRefresh使用
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/09/20/iOS9-网络https-错误/" rel="prev" title="iOS9 网络https 错误">
                iOS9 网络https 错误 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/09/20/iOS9-网络https-错误/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                iOS9 网络https 错误
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-09-20T19:05:25+08:00">
                2015-09-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/09/20/iOS9-网络https-错误/" class="leancloud_visitors" data-flag-title="iOS9 网络https 错误">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>在iOS9 中，苹果将原http协议改成了https协议，使用 TLS1.2 SSL加密请求数据。</p>
<p><strong>解决办法</strong>：</p>
<p>在<em>info.plist</em>中添加</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">&lt;key&gt;NSAppTransportSecurity&lt;/key&gt;</div><div class="line">&lt;dict&gt;</div><div class="line">&lt;key&gt;NSAllowsArbitraryLoads</div><div class="line">&lt;/key&gt;</div><div class="line">&lt;true/&gt;</div><div class="line">&lt;/dict&gt;</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/09/20/Alamofile使用/" rel="next" title="Alamofile使用">
                <i class="fa fa-chevron-left"></i> Alamofile使用
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/09/20/CocoaPods安装使用方法/" rel="prev" title="CocoaPods安装使用方法">
                CocoaPods安装使用方法 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/09/20/CocoaPods安装使用方法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                CocoaPods安装使用方法
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-09-20T18:06:32+08:00">
                2015-09-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/09/20/CocoaPods安装使用方法/" class="leancloud_visitors" data-flag-title="CocoaPods安装使用方法">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>首先安装好Ruby环境，在终端中输入以下命令：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">sudo gem install cocoapods</div></pre></td></tr></table></figure>
<p>可是在天朝，在终端中敲入这个命令之后，会发现半天没有任何反应。原因无他，因为那堵墙阻挡了cocoapods.org。</p>
<p>我们可以用淘宝的Ruby镜像来访问cocoapods。按照下面的顺序在终端中敲入依次敲入命令：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">gem sources --remove https://rubygems.org/</div></pre></td></tr></table></figure>
<p>等有反应之后再敲入以下命令:</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">gem sources <span class="_">-a</span> http://ruby.taobao.org/</div></pre></td></tr></table></figure>
<p>为了验证你的Ruby镜像是并且仅是taobao，可以用以下命令查看：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">gem sources <span class="_">-l</span></div></pre></td></tr></table></figure>
<p>只有在终端中出现下面文字才表明你上面的命令是成功的：</p>
<blockquote>
<p>CURRENT SOURCES ***<br><a href="http://ruby.taobao.org/" target="_blank" rel="external">http://ruby.taobao.org/</a></p>
</blockquote>
<p>这时候，再次在终端中运行：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">sudo gem install cocoapods</div></pre></td></tr></table></figure>
<p>等上十几秒钟，CocoaPods就可以在你本地下载并且安装好了，不再需要其他设置。</p>
<h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>e.g.<br><strong>利用CocaPods安装Alamofire</strong></p>
<p>在终端中进入（cd命令）你项目所在目录，然后在当前目录下，利用vim创建Podfile，运行：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">vim Podfile</div></pre></td></tr></table></figure>
<p>然后在Podfile文件中输入以下文字：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line"><span class="built_in">source</span> <span class="string">'https://github.com/CocoaPods/Specs.git'</span></div><div class="line">platform :ios, <span class="string">'8.0'</span></div><div class="line">use_frameworks!</div><div class="line">pod <span class="string">'Alamofire'</span>, <span class="string">'~&gt; 2.0'</span></div></pre></td></tr></table></figure>
<p>这段文字可以在Alamofire的<a href="https://github.com/Alamofire/Alamofire" target="_blank" rel="external">GitHub</a>中找到；<br>然后保存退出。vim环境下，保存退出命令是：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">:wq</div></pre></td></tr></table></figure>
<p>然后在终端中的当前项目目录下，运行以下命令：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line">pod install</div></pre></td></tr></table></figure>
<p>然后CocoaPods就会帮你做好一切了，使用Alamofire只需要在项目中 import Alamofire；</p>
<p>对了，使用过CocoaPods的项目就不用之前的<del>.xcodeproj</del>文件打开了，而是使用<strong>.xcworkspace</strong>打开。</p>
<p>在这之后如果你还要添加新的第三方库的话，就只要在已经存在的Podfile中添加相应的代码然后到项目文件夹执行：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">pod update</div></pre></td></tr></table></figure>
<p><em>快速更新第三方库的方法</em>：<br>在更新时使用如下代码替换之前的 <del>pod update</del></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">pod update --verbose --no-repo-update</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/Swift/" rel="tag"># Swift</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/09/20/iOS9-网络https-错误/" rel="next" title="iOS9 网络https 错误">
                <i class="fa fa-chevron-left"></i> iOS9 网络https 错误
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/09/19/iOS-MVC-详解/" rel="prev" title="iOS MVC 详解">
                iOS MVC 详解 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/09/19/iOS-MVC-详解/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                iOS MVC 详解
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-09-19T19:08:03+08:00">
                2015-09-19
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/09/19/iOS-MVC-详解/" class="leancloud_visitors" data-flag-title="iOS MVC 详解">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h2 id="模型-视图-控制器"><a href="#模型-视图-控制器" class="headerlink" title="模型-视图-控制器"></a>模型-视图-控制器</h2><p>这个模式其实应该叫做MCV，用控制器把model与view隔开才对，也就是model与view互相不知道对方的存在，没有任何瓜葛，他们就像一个团队里吵了架的同事，如果有项目需要他俩来参与，那么最好有第三者来管理他俩之间的沟通与协调。这个第三者就是控制器。<br>既然管理，那么姑且就把这个控制器提做项目经理吧，这样的话让他俩干啥就得干啥。就像斯坦福老头说的视图就是控制器的狗腿子。</p>
<blockquote>
<p>让我们来欣赏一下这张图（摘自斯坦福公开课的课件）：<br><img src="http://7xl9qm.com1.z0.glb.clouddn.com/MVC.png" alt=""></p>
</blockquote>
<p>先撇开那些乱七八糟的箭头单看他们之间的分界线，view与controller、model与controller之间的线是虚的，而model与view之间的是双黄线，考过驾照的知道越过这个线意味着什么吧。</p>
<p>控制器与视图之间的大部分连线都可以在Xcode中通过按住ctrl来连接。例如outlet，例如delegate。有了这些连线，他们之间的沟通算是畅通无阻了。</p>
<ol>
<li>用户在view上的操作可以直接告诉控制器让控制器去响应</li>
<li>view需要的代理也可以指派给控制器让控制器去完成</li>
<li>view需要的数据源也需要控制器来提供</li>
</ol>
<p><em>总之，控制器很忙，因为它非常被动。</em></p>
<p>控制器还需要一个角色的参与：<strong>model</strong></p>
<p>顾名思义，模型。我觉得使用asp.net里mvc的domain来描述比较好理解，领域。例如你要开发一个图书管理系统，模型里描绘的就是图书的书名、售价、作者，谁借走了，几号借走的，一切关于这个应用领域的数据。<br>我们可以给模型一个简单的定义：它描述了一个应用所有需要抽象出来的数据结构和这些数据之间的关系，还有他们获取数据需要通过的途径（本地的、远程的）等。<br>有了模型，控制器想啥时候去拿数，想怎么拿都行。</p>
<p>仔细观察上面的图，有控制器到model的箭头，没有model到控制器的箭头。因为模型不需要知道控制器的存在，这样可以减少耦合，提高代码复用可能性。把你定义好的model挪到别的项目中，还可以使用。</p>
<p>但是问题来了，当model数据已经更新了，被修改了，怎么通知相关的控制器？注意model上方有个天线，高端！之所以使用无线的，是因为model不知道更改要发给谁，但是model可以广播，model的观点：谁关心我的更改让谁收听去，我对谁收听了我不感兴趣。</p>
<p>广播的方式有两种：Notification 和 KVO（都是设计模式，本系列接下来会详述）</p>
<p>好了，他们几个之间的关系基本有个概念了。mvc模式就是这样，把原本杂乱无章的类，分为三堆，严格监管，按规则行事。</p>
<p>还是那句话：<em>说到底一切都是为了使类之间的耦合性更松散。好的代码应该对扩展开放，对修改关闭。</em></p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/09/20/CocoaPods安装使用方法/" rel="next" title="CocoaPods安装使用方法">
                <i class="fa fa-chevron-left"></i> CocoaPods安装使用方法
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/08/11/Reachability 使用/" rel="prev" title="iOS 常用第三方库7(Reachability)">
                iOS 常用第三方库7(Reachability) <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/08/11/Reachability 使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                iOS 常用第三方库7(Reachability)
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-08-11T00:06:47+08:00">
                2015-08-11
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/08/11/Reachability 使用/" class="leancloud_visitors" data-flag-title="iOS 常用第三方库7(Reachability)">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><a href="https://github.com/tonymillion/Reachability" target="_blank" rel="external">Reachability</a> 是一个检测网络状态的框架。<br>开发Web等网络应用程序的时候，需要确认网络环境，连接情况等信息。如果没有处理这些信息的话，是不会通过Apple的审查的。</p>
<h3 id="使用方法："><a href="#使用方法：" class="headerlink" title="使用方法："></a>使用方法：</h3><p>将Reachability.h 和 Reachability.m 拷贝到你的工程中。</p>
<p>然后：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">var</span> reach:<span class="type">Reachability</span>?</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">checkNetStatus</span><span class="params">()</span></span>&#123;</div><div class="line">       <span class="keyword">self</span>.reach = <span class="type">Reachability</span>.reachabilityForInternetConnection()</div><div class="line">       <span class="comment">// Tell the reachability that we DON'T want to be reachable on 3G/EDGE/CDMA</span></div><div class="line">       <span class="keyword">self</span>.reach!.reachableOnWWAN = <span class="literal">false</span></div><div class="line">       </div><div class="line">       <span class="keyword">if</span> reach?.currentReachabilityStatus() == <span class="type">NetworkStatus</span>.<span class="type">ReachableViaWWAN</span> &#123;</div><div class="line">           <span class="keyword">self</span>.net = <span class="type">NetState</span>.<span class="type">Mobile</span></div><div class="line">       &#125;</div><div class="line">       </div><div class="line">       <span class="comment">// Here we set up a NSNotification observer. The Reachability that caused the notification</span></div><div class="line">       <span class="comment">// is passed in the object parameter</span></div><div class="line">       <span class="type">NSNotificationCenter</span>.defaultCenter().addObserver(<span class="keyword">self</span>,</div><div class="line">           selector: <span class="string">"reachabilityChanged:"</span>,</div><div class="line">           name: kReachabilityChangedNotification,</div><div class="line">           object: <span class="literal">nil</span>)</div><div class="line">       </div><div class="line">       <span class="keyword">self</span>.reach!.startNotifier()</div><div class="line">   &#125;</div><div class="line">   </div><div class="line">   <span class="function"><span class="keyword">func</span> <span class="title">reachabilityChanged</span><span class="params">(notification: NSNotification)</span></span>&#123;</div><div class="line">       </div><div class="line">       <span class="keyword">if</span> <span class="keyword">self</span>.reach!.isReachableViaWiFi()  &#123;</div><div class="line">           <span class="built_in">print</span>(<span class="string">"能访问网络"</span>)</div><div class="line">           </div><div class="line">           </div><div class="line">       &#125;<span class="keyword">else</span> <span class="keyword">if</span>  <span class="keyword">self</span>.reach!.isReachableViaWWAN()&#123;</div><div class="line">           appDelegate.isCanUseNetWork = <span class="literal">true</span></div><div class="line">           <span class="built_in">print</span>(<span class="string">"正在使用移动网络"</span>)</div><div class="line">           </div><div class="line">       &#125;<span class="keyword">else</span> &#123;</div><div class="line">           </div><div class="line">           <span class="built_in">print</span>(<span class="string">"没有网络!!!"</span>) </div><div class="line">           <span class="keyword">self</span>.net = <span class="type">NetState</span>.<span class="type">None</span></div><div class="line">       &#125;</div><div class="line">   &#125;</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/09/19/iOS-MVC-详解/" rel="next" title="iOS MVC 详解">
                <i class="fa fa-chevron-left"></i> iOS MVC 详解
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/07/26/Mac终端提示-command-not-found解决办法/" rel="prev" title="Mac终端command not found 解决办法">
                Mac终端command not found 解决办法 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/07/26/Mac终端提示-command-not-found解决办法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Mac终端command not found 解决办法
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-07-26T22:37:57+08:00">
                2015-07-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/07/26/Mac终端提示-command-not-found解决办法/" class="leancloud_visitors" data-flag-title="Mac终端command not found 解决办法">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>在bash_profile中添加：</p>
<figure class="highlight sh"><table><tr><td class="code"><pre><div class="line"><span class="built_in">export</span> PATH=<span class="string">"<span class="variable">$PATH</span>:<span class="variable">$HOME</span>/.rvm/bin"</span> <span class="comment"># Add RVM to PATH for scripting</span></div><div class="line"></div><div class="line">[[ <span class="_">-s</span> <span class="string">"<span class="variable">$HOME</span>/.rvm/scripts/rvm"</span> ]] &amp;&amp; <span class="built_in">source</span> <span class="string">"<span class="variable">$HOME</span>/.rvm/scripts/rvm"</span> <span class="comment"># Load RVM into a shell session *as a function*</span></div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Mac/" rel="tag"># Mac</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/08/11/Reachability 使用/" rel="next" title="iOS 常用第三方库7(Reachability)">
                <i class="fa fa-chevron-left"></i> iOS 常用第三方库7(Reachability)
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/07/21/PNChart 使用/" rel="prev" title="PNChart 使用">
                PNChart 使用 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/07/21/PNChart 使用/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                PNChart 使用
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-07-21T22:24:43+08:00">
                2015-07-21
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/07/21/PNChart 使用/" class="leancloud_visitors" data-flag-title="PNChart 使用">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><a href="https://github.com/kevinzhow/PNChart" target="_blank" rel="external">PNChart</a> 是一个简约，易用的第三方图表库，它支持折线图，柱形图，饼状图和圆形图的绘制；</p>
<h3 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h3><ul>
<li>画折线图</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">func  setLineChart()&#123;</div><div class="line">        </div><div class="line">  /// 定义一个lineChart    </div><div class="line">	var lineChart = PNLineChart(frame: CGRectMake(0, self.view.frame.height/4, self.view.frame.width, self.view.frame.height/2))</div><div class="line">	//不要使用下面的方法，Width 不好计算，只设置数据的话宽度会自动设定</div><div class="line">	//lineChart.setXLabels([&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,&quot;E&quot;,&quot;F&quot;], withWidth: 50)</div><div class="line">	lineChart.xLabels = [&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,&quot;E&quot;,&quot;F&quot;]</div><div class="line">	lineChart.axisColor = UIColor.blackColor()</div><div class="line">	lineChart.showCoordinateAxis = true</div><div class="line">        </div><div class="line">	/// 设置第一根折线</div><div class="line">	var dataArray = [1,4,9,20,8,9]</div><div class="line">	var lineChartData = PNLineChartData()</div><div class="line">	//lineChartData.lineWidth = 20</div><div class="line">	lineChartData.itemCount = UInt(dataArray.count)</div><div class="line">	lineChartData.color = UIColor.greenColor()</div><div class="line">	lineChartData.getData = (&#123;(index:UInt) -&gt; PNLineChartDataItem in</div><div class="line">	var y = dataArray[Int(index)]</div><div class="line">	return PNLineChartDataItem(y: CGFloat(y))</div><div class="line">	&#125;)</div><div class="line"></div><div class="line">	//为数据源设置Title</div><div class="line">	lineChartData.dataTitle = &quot;Swift&quot;</div><div class="line">        </div><div class="line">	/// 设置第二根折线</div><div class="line">	var dataArray2 = [5,19,9,3,5]</div><div class="line">	var lineChartData2 = PNLineChartData()</div><div class="line">	//lineChartData.lineWidth = 20</div><div class="line">	lineChartData2.itemCount = UInt(dataArray2.count)</div><div class="line">	lineChartData2.color = UIColor.redColor()</div><div class="line">	lineChartData2.getData = (&#123;(index:UInt) -&gt; PNLineChartDataItem in</div><div class="line">		var y = dataArray2[Int(index)]</div><div class="line">		return PNLineChartDataItem(y: CGFloat(y))</div><div class="line">	&#125;)</div><div class="line">        </div><div class="line">	//把折线加入到lineChart中，开始画图</div><div class="line">	lineChart.chartData = [lineChartData,lineChartData2]</div><div class="line">	lineChart.strokeChart()</div><div class="line">        </div><div class="line">	self.view.addSubview(lineChart)</div><div class="line">        </div><div class="line">	/// 为图表设置标签，****要在画图之后添加****</div><div class="line">	//为数据源2设置Title</div><div class="line">	lineChartData2.dataTitle = &quot;OC&quot;</div><div class="line">	//选择标签风格</div><div class="line">	lineChart.legendStyle = PNLegendItemStyle.Serial</div><div class="line">	//获取标签</div><div class="line">	var legend = lineChart.getLegendWithMaxWidth(self.view.frame.width)</div><div class="line">	//设置标签位置</div><div class="line">	legend.frame = CGRectMake(50, lineChart.frame.origin.y + lineChart.frame.height + 10 , legend.frame.width, legend.frame.height)</div><div class="line">        </div><div class="line">	self.view.addSubview(legend)</div><div class="line">        </div><div class="line">	lineChart.delegate = self</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<ul>
<li>画柱形图：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">func setBarChart()&#123;</div><div class="line">	//直接初始化一个PNBarChart，不要数据源</div><div class="line">	var barChart = PNBarChart(frame: CGRectMake(0, 200, self.view.frame.width, 350))</div><div class="line">	barChart.xLabels = [&quot;A&quot;,&quot;B&quot;,&quot;C&quot;,&quot;D&quot;,&quot;E&quot;]</div><div class="line">	//barChart.xLabelWidth = 55</div><div class="line">	barChart.yValues = [1,3,6,-7,15]</div><div class="line">	//显示图表边界</div><div class="line">	barChart.showChartBorder = true</div><div class="line">	//允许负数</div><div class="line">	barChart.showLevelLine = false</div><div class="line">        </div><div class="line">	//barChart.strokeColor = UIColor.redColor()</div><div class="line">	barChart.barRadius = 2</div><div class="line">	//设置文字颜色，**********设置不了************</div><div class="line">	barChart.labelTextColor = UIColor.redColor()</div><div class="line">        </div><div class="line">	//开始画图</div><div class="line">	barChart.strokeChart()</div><div class="line">	self.view.add</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>画圆形图：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">func setCircleChart()&#123;</div><div class="line">	//直接初始化一个PNCircleChart ，不要数据源之类的</div><div class="line">	var circelChart = PNCircleChart(frame: CGRectMake(self.view.frame.width/2 - self.view.frame.width/4, 200, self.view.frame.width/2, 200), total: 100, current: 60, clockwise: false, shadow: true, shadowColor: UIColor.grayColor())</div><div class="line">	circelChart.current = 60</div><div class="line">	circelChart.total = 100</div><div class="line">	//circelChart.strokeColor = UIColor.greenColor()</div><div class="line">        </div><div class="line">	circelChart.strokeChart()</div><div class="line">	self.view.addSubview(circelChart)</div><div class="line">	&#125;</div></pre></td></tr></table></figure>
<ul>
<li>画饼状图：</li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">func setPieChart()&#123;</div><div class="line">	//先定义一个PNPieChartDataItem数组，116 202 33      72 114 224</div><div class="line">	var items = [PNPieChartDataItem(value: 50, color: UIColor(red: 116/255, green: 202/255, blue: 33/255, alpha: 1) , description: &quot;Swift&quot;),PNPieChartDataItem(value: 20, color: UIColor(red: 72/255, green: 114/255, blue: 224/255, alpha: 1) , description: &quot;OC&quot;)]</div><div class="line">        </div><div class="line">	var pieChart = PNPieChart(frame: CGRectMake(self.view.frame.width/2 - self.view.frame.width/3, 200, self.view.frame.width/1.5, 200), items: items)</div><div class="line">        </div><div class="line">	pieChart.descriptionTextFont = UIFont.systemFontOfSize(15)</div><div class="line">        </div><div class="line">	pieChart.strokeChart()</div><div class="line">	self.view.addSubview(pieChart)</div><div class="line">        </div><div class="line">	//选择标签风格</div><div class="line">	pieChart.legendStyle = PNLegendItemStyle.Serial</div><div class="line">	//获取标签</div><div class="line">	var legend = pieChart.getLegendWithMaxWidth(self.view.frame.width)</div><div class="line">	//设置标签位置</div><div class="line">	legend.frame = CGRectMake(50, pieChart.frame.origin.y + pieChart.frame.height + 10, legend.frame.width, legend.frame.height)</div><div class="line">        </div><div class="line">	self.view.addSubview(legend)     </div><div class="line">	&#125;</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/第三方库/" rel="tag"># 第三方库</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/07/26/Mac终端提示-command-not-found解决办法/" rel="next" title="Mac终端command not found 解决办法">
                <i class="fa fa-chevron-left"></i> Mac终端command not found 解决办法
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/07/20/iOS Date相关/" rel="prev" title="iOSDate相关">
                iOSDate相关 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/07/20/iOS Date相关/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                iOSDate相关
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-07-20T12:59:52+08:00">
                2015-07-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/07/20/iOS Date相关/" class="leancloud_visitors" data-flag-title="iOSDate相关">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h4 id="时间和字符串的转换"><a href="#时间和字符串的转换" class="headerlink" title="时间和字符串的转换"></a>时间和字符串的转换</h4><ul>
<li>Data智能转换成字符串，即可以显示<em>“刚刚”</em>，<em>“昨天”</em>，<em>“几小时之前等等”</em></li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">extension</span> <span class="title">Date</span> </span>&#123;</div><div class="line">    <span class="comment">//MARK: 根据规则返回对应的字符串</span></div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">getTimeString</span><span class="params">()</span></span> -&gt; <span class="type">String</span> &#123;</div><div class="line">        <span class="keyword">if</span> isToday &#123;</div><div class="line">            <span class="keyword">if</span> minute &lt; <span class="number">5</span> &#123;</div><div class="line">                <span class="keyword">return</span> <span class="string">"刚刚"</span></div><div class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> hour &lt; <span class="number">1</span> &#123;</div><div class="line">                <span class="keyword">return</span> <span class="string">"<span class="subst">\(minute)</span>分钟之前"</span></div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                <span class="keyword">return</span> <span class="string">"<span class="subst">\(hour)</span>小时之前"</span></div><div class="line">            &#125;</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> isYesterday &#123;</div><div class="line">            <span class="keyword">return</span> <span class="string">"昨天 <span class="subst">\(<span class="keyword">self</span>.yesterdayTimeStr()</span>)"</span></div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> isYear &#123;</div><div class="line">            <span class="keyword">return</span> noYesterdayTimeStr()</div><div class="line">        &#125; <span class="keyword">else</span> &#123;</div><div class="line">            <span class="keyword">return</span> yearTimeStr()</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    fileprivate <span class="keyword">var</span> selfDate : <span class="type">Date</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">self</span></div><div class="line">    &#125;</div><div class="line">    <span class="comment">/// 距当前有几分钟</span></div><div class="line">    <span class="keyword">var</span> minute : <span class="type">Int</span> &#123;</div><div class="line">        <span class="keyword">let</span> dateComponent = <span class="type">Calendar</span>.current.dateComponents([.minute], from: selfDate, to: <span class="type">Date</span>())</div><div class="line">        <span class="keyword">return</span> dateComponent.minute!</div><div class="line">    &#125;</div><div class="line">    <span class="comment">/// 距当前有几小时</span></div><div class="line">    <span class="keyword">var</span> hour : <span class="type">Int</span> &#123;</div><div class="line">        <span class="keyword">let</span> dateComponent = <span class="type">Calendar</span>.current.dateComponents([.hour], from: selfDate, to: <span class="type">Date</span>())</div><div class="line">        <span class="keyword">return</span> dateComponent.hour!</div><div class="line">    &#125;</div><div class="line">    <span class="comment">/// 是否是今天</span></div><div class="line">    <span class="keyword">var</span> isToday : <span class="type">Bool</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="type">Calendar</span>.current.isDateInToday(selfDate)</div><div class="line">    &#125;</div><div class="line">    <span class="comment">/// 是否是昨天</span></div><div class="line">    <span class="keyword">var</span> isYesterday : <span class="type">Bool</span> &#123;</div><div class="line">        <span class="keyword">return</span> <span class="type">Calendar</span>.current.isDateInYesterday(selfDate)</div><div class="line">    &#125;</div><div class="line">    <span class="comment">/// 是否是今年</span></div><div class="line">    <span class="keyword">var</span> isYear: <span class="type">Bool</span> &#123;</div><div class="line">        <span class="keyword">let</span> nowComponent = <span class="type">Calendar</span>.current.dateComponents([.year], from: <span class="type">Date</span>())</div><div class="line">        <span class="keyword">let</span> component = <span class="type">Calendar</span>.current.dateComponents([.year], from: selfDate)</div><div class="line">        <span class="keyword">return</span> (nowComponent.year == component.year)</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">yesterdayTimeStr</span><span class="params">()</span></span> -&gt; <span class="type">String</span> &#123;</div><div class="line">        <span class="keyword">let</span> format = <span class="type">DateFormatter</span>()</div><div class="line">        format.dateFormat = <span class="string">"HH:mm"</span></div><div class="line">        <span class="keyword">return</span> format.string(from: selfDate)</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">noYesterdayTimeStr</span><span class="params">()</span></span> -&gt; <span class="type">String</span> &#123;</div><div class="line">        <span class="keyword">let</span> format = <span class="type">DateFormatter</span>()</div><div class="line">        format.dateFormat = <span class="string">"MM-dd HH:mm"</span></div><div class="line">        <span class="keyword">return</span> format.string(from: selfDate)</div><div class="line">    &#125;</div><div class="line">    <span class="function"><span class="keyword">func</span> <span class="title">yearTimeStr</span><span class="params">()</span></span> -&gt; <span class="type">String</span> &#123;</div><div class="line">        <span class="keyword">let</span> format = <span class="type">DateFormatter</span>()</div><div class="line">        format.dateFormat = <span class="string">"yyyy-MM-dd HH:mm"</span></div><div class="line">        <span class="keyword">return</span> format.string(from: selfDate)</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>自带的转换方法，显示今天 xx:xx</li>
</ul>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="function"><span class="keyword">func</span> <span class="title">dateToString</span><span class="params">(date:Date)</span></span> -&gt; <span class="type">String</span>&#123;</div><div class="line">    <span class="comment">//定义一个日期格式</span></div><div class="line">    <span class="keyword">let</span> dateFormat = <span class="type">DateFormatter</span>()</div><div class="line">    <span class="comment">//日期风格</span></div><div class="line">    dateFormat.dateStyle = <span class="type">DateFormatter</span>.<span class="type">Style</span>.short</div><div class="line">    <span class="comment">//时间风格</span></div><div class="line">    dateFormat.timeStyle = <span class="type">DateFormatter</span>.<span class="type">Style</span>.short</div><div class="line">    <span class="comment">//设置相对日期</span></div><div class="line">    dateFormat.doesRelativeDateFormatting = <span class="literal">true</span></div><div class="line">    dateFormat.timeStyle = <span class="type">DateFormatter</span>.<span class="type">Style</span>.short</div><div class="line">    <span class="comment">//日期的地区为中国</span></div><div class="line">    dateFormat.locale = <span class="type">Locale</span>(identifier: <span class="string">"zh_cn"</span>)</div><div class="line">    <span class="keyword">let</span> dateStr = dateFormat.string(from: date)</div><div class="line">    <span class="keyword">return</span> dateStr</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="日期之间比较"><a href="#日期之间比较" class="headerlink" title="日期之间比较"></a>日期之间比较</h4><figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="comment">//与otherDate比较，相同返回YES</span></div><div class="line">now.isEqualToDate(tomorrow)</div><div class="line"></div><div class="line"><span class="comment">//与anotherDate比较，返回较早的那个日期</span></div><div class="line">now.earlierDate(tomorrow)</div><div class="line"></div><div class="line"><span class="comment">//与anotherDate比较，返回较晚的那个日期</span></div><div class="line">now.laterDate(tomorrow)</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/07/21/PNChart 使用/" rel="next" title="PNChart 使用">
                <i class="fa fa-chevron-left"></i> PNChart 使用
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/07/14/Next手机代码显示不全解决办法/" rel="prev" title="Next手机代码显示不全解决办法">
                Next手机代码显示不全解决办法 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/07/14/Next手机代码显示不全解决办法/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Next手机代码显示不全解决办法
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-07-14T09:14:52+08:00">
                2015-07-14
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/07/14/Next手机代码显示不全解决办法/" class="leancloud_visitors" data-flag-title="Next手机代码显示不全解决办法">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>修改<code>custom.styl</code><br>(路径：source/css/_custom)</p>
<p>增加如下代码：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><div class="line"><span class="selector-class">.code</span> &#123;</div><div class="line"><span class="attribute">padding-left</span>: <span class="number">20px</span> <span class="meta">!important</span>;</div><div class="line"><span class="attribute">background-color</span>: black;</div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Hexo/" rel="tag"># Hexo</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/07/20/iOS Date相关/" rel="next" title="iOSDate相关">
                <i class="fa fa-chevron-left"></i> iOSDate相关
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/04/20/iOS-传值总结/" rel="prev" title="iOS 传值总结">
                iOS 传值总结 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/04/20/iOS-传值总结/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                iOS 传值总结
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-04-20T16:12:12+08:00">
                2015-04-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/04/20/iOS-传值总结/" class="leancloud_visitors" data-flag-title="iOS 传值总结">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>iOS中传值的方式主要有以下几种：</p>
<ul>
<li>segue传值</li>
<li>通知传值</li>
<li>代理传值</li>
<li>单例传值</li>
<li>ShareApplication</li>
<li>NSUserdefault</li>
</ul>
<p>如果是A页面传值到B页面，之间有segue连接的话，用属性传值就可以搞定，如果从B页面传值到A页面或者之间没有直接的segue的话，就可以使用代理传值或者单例传值了。</p>
<ul>
<li><strong>segue传值</strong></li>
</ul>
<p>segue传值就是利用segue跳转时利用属性进行传值，这边就不做记录了。</p>
<ul>
<li><strong>通知传值</strong></li>
</ul>
<p>通知是一个单例类，只存在一个通知实例，一个通知会有一个对应的名字，而这个名字就是对应的观察者的接受通知的索引，每个对象都可以接收到这个广播，但是只有这个通知的名字和观察者的名字相同时，对应的观察者才可以接收到这个广播并处理对应逻辑。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">//seletor: 接收到通知后应该做的操作；name：该通知对应的名字</div><div class="line">//A发送通知</div><div class="line">NSNotificationCenter.defaultCenter().postNotificationName(&quot;通知名字&quot;, object: self, userInfo: [&quot;key&quot;: value])</div><div class="line">//B接收通知</div><div class="line">NSNotificationCenter.defaultCenter().addObserver(self, selector: &quot;接收到通知后要执行的方法:&quot;, name: &quot;通知名字&quot;, object: nil)</div><div class="line">//同时实现接受通知后要执行的方法</div><div class="line">func 接收到通知后要执行的方法(aNotification:NSNotification)&#123;</div><div class="line">	//value = aNotification.userInfo[&quot;key&quot;]</div><div class="line">&#125;</div><div class="line">B方 移除监听removeObserver (一定要记得)</div><div class="line">deinit &#123;</div><div class="line">		NSNotificationCenter.defaultCenter().removeObserver(self)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><strong>代理传值</strong></li>
</ul>
<figure class="highlight plain"><table><tr><td class="code"><pre><div class="line">//声明委托</div><div class="line">protocol passValueDele&#123;</div><div class="line">    func passValue(value:String)</div><div class="line">&#125;</div><div class="line"></div><div class="line">//接受委托，并定义一个委托类的对象：</div><div class="line">let vc1 = self.storyboard?.instantiateViewControllerWithIdentifier(&quot;detail&quot;) as! ViewController</div><div class="line"></div><div class="line">vc1.delegate1 = self</div><div class="line">func passValue(value:String)&#123;  </div><div class="line">		//得到value之后执行操作</div><div class="line">&#125;</div><div class="line"></div><div class="line">//在委托类中声明一个委托变量，并调用方法传值；</div><div class="line">weak var delegate1:passValueDele?  //注意用weak，防止循环引用</div><div class="line">delegate1?.passValue(&quot;value&quot;)</div></pre></td></tr></table></figure>
<ul>
<li><strong>单例传值</strong></li>
</ul>
<p>简单来说单例传值就是创建一个类的单例，各个ViewController共享数据。</p>
<p>先创建一个单例：</p>
<figure class="highlight swift"><table><tr><td class="code"><pre><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">SingleTonClass</span>: <span class="title">NSObject</span> </span>&#123;</div><div class="line">    <span class="keyword">var</span> value:<span class="type">String</span>?</div><div class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">singleTon</span> </span>&#123;</div><div class="line">        <span class="keyword">static</span> <span class="keyword">var</span> once_t:dispatch_once_t = <span class="number">0</span></div><div class="line">        <span class="keyword">static</span> <span class="keyword">var</span> currentDataSong:<span class="type">CurrentDataSong</span>?</div><div class="line">    &#125;</div><div class="line">    </div><div class="line">    <span class="class"><span class="keyword">class</span> <span class="title">func</span> <span class="title">shareCurrentDataSong</span>()-&gt;<span class="title">CurrentDataSong</span></span>&#123;</div><div class="line">        dispatch_once(&amp;singleTon.once_t) &#123; () -&gt; <span class="type">Void</span> <span class="keyword">in</span></div><div class="line">            singleTon.<span class="type">SingleTonClass</span> = <span class="type">SingleTonClass</span>()</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> singleTon.<span class="type">SingleTonClass</span>!</div><div class="line">    &#125; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>然后在需要传值的ViewController中给单例的属性赋值；<br>这样就可以在需要值的ViewController中得到要传的值了；</p>
<ul>
<li><strong>ShareAppDelegate传值</strong></li>
</ul>
<p>和单例的原理一样，不过这个单例利用的是AppDelegate；</p>
<ul>
<li><strong>NSUserdefault传值</strong></li>
</ul>
<p>此方法试用于轻量级的数据转移，就是把需要传的值先存入到NSUserdefault中，然后在需要值的地方从NSUserdefault中取值。</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/07/14/Next手机代码显示不全解决办法/" rel="next" title="Next手机代码显示不全解决办法">
                <i class="fa fa-chevron-left"></i> Next手机代码显示不全解决办法
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2015/03/20/iOS HUD/" rel="prev" title="iOS HUD">
                iOS HUD <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

      
      
      

      
      

      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="https://xinnyu.github.io/2015/03/20/iOS HUD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="xinnyu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="XINNYU">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                iOS HUD
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2015-03-20T20:21:18+08:00">
                2015-03-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          
             <span id="/2015/03/20/iOS HUD/" class="leancloud_visitors" data-flag-title="iOS HUD">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               
                 <span class="post-meta-item-text">阅读次数 </span>
               
                 <span class="leancloud-visitors-count"></span>
             </span>
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>GitHub上iOS关于HUD的第三方库实在太多了， 这三个比较常用：</p>
<ul>
<li><a href="https://github.com/relatedcode/ProgressHUD" target="_blank" rel="external">ProgressHUD</a></li>
<li><a href="https://github.com/johnlui/SwiftNotice" target="_blank" rel="external">SwiftNotice</a></li>
<li><a href="https://github.com/jdg/MBProgressHUD/tree/iOS7Style" target="_blank" rel="external">MBProgressHUD</a></li>
</ul>
<h3 id="ProgressHUD"><a href="#ProgressHUD" class="headerlink" title="ProgressHUD"></a>ProgressHUD</h3><p>用法简单，一行代码搞定：</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line"><span class="meta">#import <span class="meta-string">"ProgressHUD.h"</span></span></div><div class="line"></div><div class="line">ProgressHUD.show(<span class="string">"正在刷新！"</span>)</div><div class="line">ProgressHUD.showError(<span class="string">"错误"</span>)</div><div class="line">ProgressHUD.showSuccess(<span class="string">"刷新成功！"</span>)</div><div class="line"></div><div class="line">ProgressHUD.dismiss()</div></pre></td></tr></table></figure>
<p>但是可自定义的属性不多；</p>
<h3 id="SwiftNotice"><a href="#SwiftNotice" class="headerlink" title="SwiftNotice"></a>SwiftNotice</h3><p>用法同样简单，还支持顶部通知：</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">noticeTop(<span class="string">""</span>) <span class="comment">//顶部通知</span></div><div class="line">notice(<span class="string">""</span>, type: NoticeType, autoClear: <span class="literal">true</span>)</div><div class="line">noticeOnlyText(<span class="string">""</span>)</div><div class="line">successNotice(<span class="string">""</span>)</div><div class="line">errorNotice(<span class="string">""</span>)</div></pre></td></tr></table></figure>
<h3 id="MBProgressHUD"><a href="#MBProgressHUD" class="headerlink" title="MBProgressHUD"></a>MBProgressHUD</h3><figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">[MBProgressHUD showHUDAddedTo:<span class="keyword">self</span>.view animated:<span class="literal">YES</span>];</div><div class="line"><span class="built_in">dispatch_async</span>(dispatch_get_global_queue( DISPATCH_QUEUE_PRIORITY_LOW, <span class="number">0</span>), ^&#123;</div><div class="line">    <span class="comment">// Do something...</span></div><div class="line">    <span class="built_in">dispatch_async</span>(dispatch_get_main_queue(), ^&#123;</div><div class="line">        [MBProgressHUD hideHUDForView:<span class="keyword">self</span>.view animated:<span class="literal">YES</span>];</div><div class="line">    &#125;);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
<p>自定义：</p>
<figure class="highlight objc"><table><tr><td class="code"><pre><div class="line">MBProgressHUD *hud = [MBProgressHUD showHUDAddedTo:<span class="keyword">self</span>.view animated:<span class="literal">YES</span>];</div><div class="line">hud.mode = MBProgressHUDModeAnnularDeterminate;</div><div class="line">hud.labelText = <span class="string">@"Loading"</span>;</div><div class="line">[<span class="keyword">self</span> doSomethingInBackgroundWithProgressCallback:^(<span class="keyword">float</span> progress) &#123;</div><div class="line">    hud.progress = progress;</div><div class="line">&#125; completionCallback:^&#123;</div><div class="line">    [hud hide:<span class="literal">YES</span>];</div><div class="line">&#125;];</div></pre></td></tr></table></figure>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/iOS/" rel="tag"># iOS</a>
          
            <a href="/tags/第三方库/" rel="tag"># 第三方库</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2015/04/20/iOS-传值总结/" rel="next" title="iOS 传值总结">
                <i class="fa fa-chevron-left"></i> iOS 传值总结
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    

  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="xinnyu" />
          <p class="site-author-name" itemprop="name">xinnyu</p>
           
              <p class="site-description motion-element" itemprop="description">成就感和尊严,给你快乐.</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">45</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">分类</span>
              
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">11</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/xinnyu" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2015 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">xinnyu</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  








  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  
    <script type="text/javascript" id="motion.page.archive">
      $('.archive-year').velocity('transition.slideLeftIn');
    </script>
  


  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  

    

    

  




	





  





  





  






  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>





  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("89bSIbjh54oGv1MH2W387qHC-gzGzoHsz", "AtsNxJJTU0iLTX4hi42nIBOW");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  

  

  

</body>
</html>
